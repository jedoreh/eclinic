<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Pricing Setup</title>
    <link rel="icon" href="img/favicon.png">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- animate CSS -->
    <link rel="stylesheet" href="css/animate.css">
    <!-- owl carousel CSS -->
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <!-- themify CSS -->
    <link rel="stylesheet" href="css/themify-icons.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <!-- flaticon CSS -->
    <link rel="stylesheet" href="css/flaticon.css">
    <!-- magnific popup CSS -->
    <link rel="stylesheet" href="css/magnific-popup.css">
    <!-- nice select CSS -->
    <!-- <link rel="stylesheet" href="css/nice-select.css"> -->
    <!-- swiper CSS -->
    <link rel="stylesheet" href="css/select2.min.css">
    <link rel="stylesheet" href="css/slick.css">
    <!-- style CSS -->
    <link rel="stylesheet" href="css/style.css">
    <style>
        a:hover{
            color:indigo;
        }
    </style>
</head>

<body>
    <!--::header part start::-->
    <header class="main_menu">
            
        </header>
        <!-- Header part end-->
       
    <!-- breadcrumb start-->
    <section class="breadcrumb breadcrumb_bg">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="breadcrumb_iner">
                        <div class="form-row">
                            <div class="form-group col-md-2">
                                <span id="username" style="color:#F1F1F1;font-size: 17px;"></span>
                            </div>
                            <div class="form-group col-md-6">
                                <span id="pagetitle" style="color:#F1F1F1;font-size: 20px;font-weight: bolder;">Item/Services Pricing Setup</span>
                            </div>
                            <div class="form-group col-md-2">
                                <span id="sysdate" style="color:#F1F1F1"></span>
                            </div>
                            <div class="form-group col-md-2">
                                <span id="systime" style="color:#F1F1F1"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- breadcrumb start-->

    

    <!--::regervation_part start::-->
    <section class="regervation_part padding_bottom" style="margin-top:30px;">
        <div class="container">
            <div class="row align-items-center regervation_content">
                <div class="col-md-12">
                    <div class="regervation_part_iner">
                        <br>
                        <form action="controllers/add-staff.php" class="frmaddperson">
                            <!-- <h2>Pricing</h2> -->
                            <div class="label label-success" id="errorlogin"></div>
                            <div class="form-row">
                                
                            </div>
                            
                        </form>
                    </div>

                    <div class="card-box">
                       
                        <ul class="nav nav-tabs nav-tabs-solid nav-tabs-rounded nav-justified">
                            <!-- <li class="nav-item"><a class="nav-link btn-primary active" href="#solid-rounded-justified-tab1" data-toggle="tab">Item Pricing</a></li> -->
                            <!-- <li class="nav-item"><a class="nav-link btn-primary" href="#solid-rounded-justified-tab7" data-toggle="tab">Supplier</a></li> -->
                            <!-- <li class="nav-item"><a class="nav-link btn-primary" href="#solid-rounded-justified-tab3" data-toggle="tab">Category of Importance</a></li> -->
                            <!-- <li class="nav-item"><a class="nav-link btn-primary" href="#solid-rounded-justified-tab4" data-toggle="tab">Location</a></li> -->
                            <!-- <li class="nav-item"><a class="nav-link btn-primary" href="#solid-rounded-justified-tab8" data-toggle="tab">Packaging</a></li> -->
                            <!-- <li class="nav-item dropdown">
                                <a href="#" class="dropdown-toggle nav-link" data-toggle="dropdown">Stocking Setup</a>
                                <div class="dropdown-menu dropdown-menu-right">
                                    <a class="dropdown-item" href="#solid-rounded-justified-tab2" data-toggle="tab">Route of Administration</a>
                                    <a class="dropdown-item" href="#solid-rounded-justified-tab3" data-toggle="tab">Category of Importance</a>
                                    <a class="dropdown-item" href="#solid-rounded-justified-tab4" data-toggle="tab">Stock Location</a>
                                    <a class="dropdown-item" href="#solid-rounded-justified-tab5" data-toggle="tab">Physical Position</a> 
                                </div>
                            </li> -->
                            <!-- <li class="nav-item"><a class="nav-link" href="#solid-rounded-justified-tab3" data-toggle="tab">Department Item Group</a></li>
                            <li class="nav-item"><a class="nav-link" href="#solid-rounded-justified-tab4" data-toggle="tab">Generic Name</a></li> -->
                            <!-- <li class="nav-item"><a class="nav-link" href="#solid-rounded-justified-tab5" data-toggle="tab">State</a></li>
                            <li class="nav-item"><a class="nav-link" href="#solid-rounded-justified-tab6" data-toggle="tab">Default Strength</a></li> -->
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane show active" id="solid-rounded-justified-tab1">
                                <br>
                                <!-- <h3>Item/Service Pricing</h3> -->
                                <div class="container">
                                    <div class="row">
                                        <div class="col-12">
                                            <form action="controllers/index.php" class="form-signin">
                                                <h2>Search Item</h2>
                                                <div class="label label-success" id="stockitem-status"></div>
                                                <div class="form-row">
                                                    <div class="form-group col-md-3">
                                                        SEARCH (Generic Name):<br>
                                                        
                                                        <input type="text" name="searchitem" class="form-control" id="searchitem" placeholder="Search Stock Item" required>
                                                    </div>
                                                    <div class="form-group col-md-9">
                                                        Trade Name (Generic Name):<br>
                                                        

                                                        <select id="selectitem" name="selectitem" class="form-control">
                                                        </select>
                                                    </div>
                                                    <div class="form-group col-md-6">
                                                        Stock Code:<br>

                                                        <input type="text" name="stocknumber" class="form-control" id="stocknumber"
                                                            placeholder="Stock Number">
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        Stock Number:<br>

                                                        <input type="text" name="stockitemnumber" class="form-control" id="stockitemnumber"
                                                            placeholder="Stock Item Number">
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        Previous Quantity:<br>

                                                        <input type="text" name="previousquantity" class="form-control" id="previousquantity"
                                                            placeholder="Previous Quantity" value="0">
                                                    </div>
                                                    <div class="form-group col-md-12">
                                                        <h3>NEW ITEM PURCHASE:</h3>
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        Supplier Name:<br>

                                                        <select id="selectsupplier" name="selectsupplier" class="form-control">
                                                        </select>
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        Invoice Number:<br>

                                                        <input type="text" name="invoicenumber" class="form-control" id="invoicenumber"
                                                            placeholder="Invoice Number">
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        Enter Invoice Date:<br>
                                                        <input type="date" name="invoicedate" class="form-control" id="invoicedate" placeholder="Invoice Date" required>
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        Invoice Amount:<br>

                                                        <input type="text" name="invoiceamount" class="form-control" id="invoiceamount"
                                                            placeholder="Invoice Amount">
                                                    </div>
                                                    <div class="form-group col-md-4">
                                                        Item Amount in Invoice:<br>

                                                        <input type="text" name="itemamount" class="form-control" id="itemamount"
                                                            placeholder="Item Amount in Invoice">
                                                    </div>
                                                    <div class="form-group col-md-4">
                                                        Stock Type:<br>

                                                        <select id="stocktype" name="stocktype" class="form-control">
                                                        </select>
                                                    </div>
                                                    <div class="form-group col-md-4">
                                                        Item State:<br>

                                                        <input type="text" id="itemstate" name="itemstate" class="form-control">
                                                        <input type="hidden" id="stockitemid" name="stockitemid">
                                                        <input type="hidden" id="stockitemlistid" name="stockitemlistid">
                                                        <input type="hidden" id="itemid" name="itemid">
                                                        <input type="hidden" id="actualpieces" name="actualpieces">
                                                        <input type="hidden" id="actualweight" name="actualweight">
                                                        <input type="hidden" id="actualvolume" name="actualvolume">
                                                        <input type="hidden" id="actuallength" name="actuallength">
                                                        <input type="hidden" id="actualservice" name="actualservice">
                                                        <input type="hidden" id="actualmicrogram" name="actualmicrogram">
                                                        <input type="hidden" id="actualinternationalunit" name="actualinternationalunit">
                                                        <input type="hidden" id="weightunit" name="weightunit" value="">
                                                        <input type="hidden" id="volumeunit" name="volumeunit" value="">
                                                        <input type="hidden" id="lengthunit" name="lengthunit" value="">
                                                        <input type="hidden" id="serviceunit" name="serviceunit" value="">

                                                    </div>
                                                    
                                                    <div class="form-edit-location"></div>
                                                    
                                                </div>
                                                <div class="regerv_btn">
                                                    <!-- <button type="submit" class="genric-btn primary" id="add-pricing-button" style="font-size: 24px;border-radius: 8px;">Add Location</button>
                                                    <button type="submit" class="genric-btn primary" id="cancel-pricing-button" style="font-size: 24px;border-radius: 8px;">Cancel</button>
                                                    <button type="submit" class="genric-btn success" id="edit-pricing-button" style="font-size: 24px;border-radius: 8px;">Edit Location</button>
                                                    <button type="submit" class="genric-btn danger" id="delete-pricing-button" style="font-size: 24px;border-radius: 8px;">Confirm Deletion</button> -->
                                                </div>
                                            </form>
                                        </div>
                                        <div class="col-12">
                                            <div class="card">
                                                <div class="card-header">
                                                    <h3 class="card-title d-inline-block">PACKAGE CALCULATOR</h3> <br>
                                                    <p id="itemdetails"></p>
                                                    <!--<p class="btn btn-primary float-right" id="view-stockitem-count"></p>-->
                                                    <!-- <p class="float-right"><input type="text" id="searchitemservice" name="searchitemservice" placeholder="Search Item/Service" style="font-size: 18px;"></p> -->
                                                </div>
                                                <div class="card-body p-0">
                                                    <div class="table-responsive scrollable" style="padding-left: 10px;">
                                                        <form action="controllers/index.php" class="form-signin">
                                                            
                                                            <div class="label label-success" id="item-packaging-status"></div>
                                                            
                                                            <div class="form-row">
                                                                <div class="packaging-list"></div>
                                                                <div class="form-group col-md-6">
                                                                    Department Item Group:<br>
                                                                    <div class="form-control" id="itemdepartmentitemgroup">
                                                                        
                                                                    </div>
                                                                   
                                                                </div>
                                                                <div class="form-group col-md-6">
                                                                    Strength:<br>
                                                                    <div class="form-control" id="itemstrengthvalue">
                                                                   
                                                                    </div>
                                                                </div>
                                                                <div class="form-group col-md-3">
                                                                    <h3>Package Calculator:</h3>
                                                                    
                                                                </div>
                                                                <div class="form-group col-md-2">
                                                                    <br>
                                                                    <!-- Package Calculator
                                                                    <input type="hidden" value="1" min="1" max="100" class="form-control" id="numberpackage" name="numberpackage"> -->
                                                                    <select class="form-control" id="package" name="package">
                                                                        <option value="bag">Bag</option>
                                                                        <option value="carton">Carton</option>
                                                                        <option value="roll">Roll</option>
                                                                        <option value="pack">Pack</option>
                                                                        <option value="sachet">Sachet</option>
                                                                        <option value="pieces">Pieces</option>
                                                                        <option value="services">Services</option>
                                                                        
                                                                    </select>

                                                                </div>
                                                                <div class="form-group col-md-1">
                                                                    <br>
                                                                    <button type="submit" class="genric-btn primary" id="add-package-button" style="font-size: 18px;border-radius: 8px;">Add</button>
                                                                    <button type="submit" class="genric-btn danger" id="clear-package-button" style="font-size: 18px;border-radius: 8px;">CLEAR</button>
                                                                </div>
                                                                <div class="form-group col-md-5">
                                                                    <br>
                                                                    
                                                                </div>
                                                                <div class="form-group col-md-2"></div>
                                                                <div class="form-group col-md-3">
                                                                    <div class="form-row" id="packaging">
                                                                        <div class="form-group col-md-6">
                                                                            Bag:<br>
                                                                            <input type="text" class="form-control" id="bag" name="bag">
                                                                           
                                                                        </div>
                                                                        <div class="form-group col-md-6">
                                                                            Carton:<br>
                                                                            <input type="text" class="form-control" id="carton" name="carton">
                                                                           
                                                                        </div>
                                                                        <div class="form-group col-md-6">
                                                                            Roll:<br>
                                                                            <input type="text" class="form-control" id="roll" name="roll">
                                                                           
                                                                        </div>
                                                                        <div class="form-group col-md-6">
                                                                            Pack/Box:<br>
                                                                            <input type="text" class="form-control" id="pack" name="pack">
                                                                           
                                                                        </div>
                                                                        <div class="form-group col-md-6">
                                                                            Sachet:<br>
                                                                            <input type="text" class="form-control" id="sachet" name="sachet">
                                                                           
                                                                        </div>
                                                                        <div class="form-group col-md-6">
                                                                            <span id="piecesheading">Pieces:</span><br>
                                                                            <input type="text" class="form-control" id="pieces" name="pieces">
                                                                           
                                                                        </div>
                                                                        <div class="form-group col-md-6">
                                                                            <button type="submit" class="genric-btn success" id="save-package-button" style="font-size: 18px;border-radius: 8px;">SAVE</button>
                                                                            
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group col-md-6">
                                                                    <div class="form-row" id="packagingvalue"></div>
                                                                </div>
                                                                
                                                                    <div class="form-group col-md-4">
                                                                        
                                                                        <br>
                                                                        Total Pieces:<br>
                                                                        <div class="form-control" id="totalpieces">
                                                                    
                                                                        </div>
                                                                        
                                                                        Total Weight(KG, G):<br>
                                                                        <div class="row">
                                                                            <div class="form-group col-md-6">
                                                                                Kilogram:<br>
                                                                                <div class="form-control" id="totalstrengthkg">
                                                                    
                                                                                </div>
                                                                            </div>
                                                                            
                                                                            <div class="form-group col-md-6">
                                                                                Gram:<br>
                                                                                <div class="form-control" id="totalstrength">
                                                                    
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                       
                                                                        Total Volume(L):<br>
                                                                        <div class="form-control" id="totalliquidstrength">
                                                                    
                                                                        </div>
                                                                        Total Length(M):<br>
                                                                        <div class="form-control" id="totallength">
                                                                    
                                                                        </div>
                                                                        Total MicroGram(ug):<br>
                                                                        <div class="form-control" id="totalmicrogram">
                                                                    
                                                                        </div>
                                                                        Total Duration:<br>
                                                                        <div class="form-control" id="totalduration">
                                                                    
                                                                        </div>
                                                                    
                                                                    </div>
                                                                    <div class="form-group col-md-4">
                                                                        
                                                                        <br>
                                                                        <br>
                                                                        <div class="form-control" id="totalpieces2">
                                                                    
                                                                        </div>
                                                                        
                                                                        Total Weight(mg):<br>
                                                                        <div class="row">
                                                                            <div class="form-group col-md-12">
                                                                                Milligram:<br>
                                                                            <div class="form-control" id="totalstrengthmg">
                                                                    
                                                                            </div>
                                                                            </div>
                                                                            
                                                                        </div>
                                                                        
                                                                        Total Volume(ml):<br>
                                                                        <div class="form-control" id="totalliquidstrengthml">
                                                                    
                                                                        </div>
                                                                        Total Length(cm):<br>
                                                                        <div class="form-control" id="totallengthcm">
                                                                    
                                                                        </div>
                                                                        Total International Unit(IU):<br>
                                                                        <div class="form-control" id="totalinternationalunit">
                                                                    
                                                                        </div>
                                                                        Total Service Duration(days):<br>
                                                                        <div class="form-control" id="totaldurationdays">
                                                                    
                                                                        </div>
                                                                    
                                                                    </div>
                                                                    
                                                                    <div class="form-group col-md-4">
                                                                        
                                                                            <br>
                                                                        Cost Price Per Piece:<br>
                                                                        <div class="form-control" id="unitpricepieces">
                                                                    
                                                                        </div>
                                                                        
                                                                            <br>
                                                                            <div class="row">
                                                                                <div class="form-group col-md-12">
                                                                                    Cost Price Per Weight:<br>
                                                                                    <div class="form-control" id="unitpricestrength">
                                                                                    
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                       
                                                                            Cost Price Per Volume:<br>
                                                                            <div class="form-control" id="unitpriceliquidstrength">
                                                                            
                                                                            </div>
                                                                            Cost Price Per Length:<br>
                                                                            <div class="form-control" id="unitpricelength">
                                                                            
                                                                            </div>
                                                                            Cost Price Per ug or IU:<br>
                                                                            <div class="form-control" id="unitpriceugiu">
                                                                            
                                                                            </div>
                                                                            Service Cost (per day):<br>
                                                                            <div class="form-control" id="servicecostperday">
                                                                            
                                                                            </div>
                                                                        </div>
                                                                        <input type="hidden" id="unitpriceperpiece" name="unitpricepiece"><br>
                                                                        <input type="hidden" id="itemserviceunitname" name="itemserviceunitname"><br>
                                                                        <input type="hidden" id="unitpriceperstrength" name="unitpriceperstrength"><br>
                                                                        <input type="hidden" id="unitpriceperliquidstrength" name="unitpriceperliquidstrength" value="0"><br>
                                                                        <input type="hidden" id="unitpriceperlength" name="unitpriceperlength" value="0"><br>
                                                                        <input type="hidden" id="unitpriceperservice" name="unitpriceperservice" value="0"><br>
                                                                        <input type="hidden" id="unitpriceperiu" name="unitpriceperiu" value="0"><br>
                                                                        <input type="hidden" id="unitpriceperug" name="unitpriceperug" value="0"><br>
                                                                        <div class="form-group col-md-12">
                                                                            <button type="submit" class="genric-btn success" id="convert-units-button" style="font-size: 18px;border-radius: 8px;">CONVERT UNITS</button>
                                                                        </div>
                                                                        <div class="form-group col-md-6">
                                                                        % Mark-Up:<br>
                                                                        <input type="number" value="1" min="1" max="100" class="form-control" id="markupprice" name="markupprice">
                                                                        <br>
                                                                        
                                                                        
                                                                        <!-- <button type="submit" class="genric-btn success" id="save-packpricing-button" style="font-size: 18px;border-radius: 8px;">SAVE</button> -->
                                                                        </div>
                                                                        <div class="form-group col-md-6"><br>
                                                                        <button type="submit" class="genric-btn success" id="compute-pricing-button" style="font-size: 18px;border-radius: 8px;">COMPUTE PRICING</button>
                                                                        <button type="submit" class="genric-btn success" id="save-packageprice-button" style="font-size: 18px;border-radius: 8px;">SAVE</button>
                                                                        <button type="submit" class="genric-btn success" id="delete-packageprice-button" style="font-size: 18px;border-radius: 8px;">DELETE</button>
                                                                        </div>
                                                                        <div class="form-group col-md-12">
                                                                            Enter Mark Up Price:
                                                                            <div class="row">
                                                                                <div class="form-group col-md-2">
                                                                                    <input type="text" class="form-control" id="markuppricetext" name="markuppricetext" placeholder="Per Piece">
                                                                                </div>
                                                                                <div class="form-group col-md-2">
                                                                                    <input type="text" class="form-control" id="markupstrengthpricetext" name="markupstrengthpricetext" placeholder="Per Weight">
                                                                                </div>
                                                                                <div class="form-group col-md-2">
                                                                                    <input type="text" class="form-control" id="markupliquidstrengthpricetext" name="markupliquidstrengthpricetext" placeholder="Per Volume">
                                                                                </div>
                                                                                <div class="form-group col-md-2">
                                                                                    <input type="text" class="form-control" id="markuplengthstrengthpricetext" name="markuplengthstrengthpricetext" placeholder="Per Length">
                                                                                </div>
                                                                                <div class="form-group col-md-2">
                                                                                    <input type="text" class="form-control" id="markupservicestrengthpricetext" name="markupservicestrengthpricetext" placeholder="Per Service">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="form-group col-md-12">
                                                                            <div id="sellingprice" style="font-size: 24px;">
                                                                    
                                                                            </div>
                                                                        </div>
                                                                        
                                                                    </div>
                                                                
                                                                
                                                                
                                                                
                                                            </div>
                                                            <div class="form-row">
                                                                
                                                            </div>
                                                            
                                                            <div class="regerv_btn">
                                                                <div class="form-row form-edit-stockitemprice table-responsive scrollable"></div>
                                                               <!-- - <button type="submit" class="genric-btn primary" id="cancel-packpricing-button" style="font-size: 18px;border-radius: 8px;">Cancel</button>
                                                                <button type="submit" class="genric-btn success" id="edit-packpricing-button" style="font-size: 18px;border-radius: 8px;">Edit</button>
                                                                <button type="submit" class="genric-btn danger" id="delete-packpricing-button" style="font-size: 18px;border-radius: 8px;">Confirm Deletion</button> -->
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="card">
                                                <div class="card-header">
                                                    <h3 class="card-title d-inline-block">Organization Selling Price</h3> <br>
                                                    <!-- <p id="itemdetails"></p> -->
                                                    <!--<p class="btn btn-primary float-right" id="view-stockitem-count"></p>-->
                                                    <!-- <p class="float-right"><input type="text" id="searchitemservice" name="searchitemservice" placeholder="Search Item/Service" style="font-size: 18px;"></p> -->
                                                </div>
                                                <div class="card-body p-0">
                                                    <div class="table-responsive scrollable" style="padding-left: 10px;">
                                                        <form action="controllers/index.php" class="form-signin">
                                                            
                                                            <div class="label label-success" id="item-organization-status"></div>
                                                            
                                                            
                                                            <div class="form-row">
                                                                <div class="packaging-list"></div>
                                                                
                                                                <div class="form-group col-md-6">
                                                                    Organization:<br>
                                                                    <select class="form-control" id="organization" name="organization">
                                                                   
                                                                    </select>
                                                                </div>
                                                                <div class="form-group col-md-4">
                                                                    Percentage Discount:<br>
                                                                    <input type="number" value="1" min="1" max="100" class="form-control" id="organizationdiscount" name="organizationdiscount">
                                                                   <input type="hidden" id="organizationid" name="organizationid">
                                                                   <input type="hidden" id="stocklistid" name="stocklistid">
                                                                   <input type="hidden" id="stockitemlistid" name="stockitemlistid">
                                                                </div>
                                                                <div class="form-group col-md-2">
                                                                    <br>
                                                                    <button type="submit" class="genric-btn primary" id="add-organizationdiscount-button" style="font-size: 18px;border-radius: 8px;">Add</button>
                                                                   
                                                                </div>
                                                                <div class="form-group col-md-5">
                                                                    <br>
                                                                    
                                                                </div>
                                                               
                                                                <div class="form-row form-edit-organization"></div>
                                                                
                                                            </div>
                                                            
                                                            <div class="regerv_btn">
                                                                
                                                                <!-- <button type="submit" class="genric-btn primary" id="cancel-packpricing-button" style="font-size: 18px;border-radius: 8px;">Cancel</button>
                                                                <button type="submit" class="genric-btn success" id="edit-packpricing-button" style="font-size: 18px;border-radius: 8px;">Edit</button>
                                                                <button type="submit" class="genric-btn danger" id="delete-packpricing-button" style="font-size: 18px;border-radius: 8px;">Confirm Deletion</button> -->
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="card">
                                                <div class="card-header">
                                                    <h3 class="card-title d-inline-block">Adding Other Items (Combined Prices)</h3> <br>
                                                    <!-- <p id="itemdetails"></p> -->
                                                    <!--<p class="btn btn-primary float-right" id="view-stockitem-count"></p>-->
                                                    <!-- <p class="float-right"><input type="text" id="searchitemservice" name="searchitemservice" placeholder="Search Item/Service" style="font-size: 18px;"></p> -->
                                                </div>
                                                <div class="card-body p-0">
                                                    <div class="table-responsive scrollable" style="padding-left: 10px;">
                                                        <form action="controllers/index.php" class="form-signin">
                                                            
                                                            <div class="label label-success" id="item-combinineditems-status"></div>
                                                            
                                                            
                                                            <div class="form-row">

                                                                <div class="combinedpricing-list"></div>
                                                                <div class="form-group col-md-3">
                                                                    SEARCH:<br>
                                                                    
                                                                    <input type="text" name="combinedsearchitem" class="form-control" id="combinedsearchitem" placeholder="Search Primary Item" required>
                                                                </div>
                                                                <div class="form-group col-md-9">
                                                                    Select Generic Name:<br>
                                                                    
            
                                                                    <select id="combinedselectitem" name="combinedselectitem" class="form-control">
                                                                    </select>
                                                                </div>
                                                                <div class="form-group col-md-12">Add Items to Primary Item</div>
                                                                <div class="form-group col-md-12">
                                                                    <div class="form-row">
                                                                
                                                                        <div class="form-group col-md-2">
                
                                                                            Advance Search By:<br>
                                                                            <select name="advancesearch" class="form-control" id="advancesearch">
                                                                                <option value="itemgrouping">Item Search</option>
                                                                                <option value="deptitemgroup">Dept Item Group</option>
                                                                                <option value="group">Group</option>
                                                                                <option value="class">Class</option>
                                                                                <option value="subclass">Sub-Class</option>
                                                                                <option value="form">Form</option>
                                                                                <!-- <option value="prescriptionnumber">Prescription Number</option>
                                                                                <option value="routinename">Routine Name</option> -->
                                                                            </select>
                                                                        </div>
                                                                        <div class="form-group col-md-10">
                                                                            <div id="itemgrouping">
                                                                                <div class="form-group col-md-12">
                                                                                    Search All Items:<br>
                                                                                    <input type="text" id="searchitems" name="searchitems" class="form-control">
                                                                                    
                                                                                </div>
                                                                                
                                                                            </div>
                                                                            <div id="deptitemgroup">
                                                                                <div class="row">
                                                                                    <div class="form-group col-md-3">
                                                                                        Department Item Group:<br>
                                                                                        <select id="selectdepartmentitemgrouping" name="selectdepartmentitemgrouping" class="form-control"></select>
                                                                        
                                                                                        <!-- <input type="text" id="searchgroups" name="searchgroups" class="form-control"> -->
                                                                                        
                                                                                    </div>
                                                                                    <div class="form-group col-md-3">
                                                                                        Select Group:<br>
                                                                                        <select name="selectusagegroup" id="selectusagegroup" class="form-control" required>
                                
                                                                                        </select>
                                                                                    </div>
                                                                                    <div class="form-group col-md-3">
                                                                                        Select Class:<br>
                                                                                        <select name="selectusageclass" id="selectusageclass" class="form-control" required>
                                
                                                                                        </select>
                                                                                    </div>
                                                                                    <div class="form-group col-md-3">
                                                                                        Select SubClass:<br>
                                                                                        <select name="selectusagesubclass" id="selectusagesubclass" class="form-control" required>
                                
                                                                                        </select>
                                                                                    </div>
                                                                                </div>
                                                                                
                                                                            </div>
                                                                            <div id="group">
                                                                                <div class="row">
                                                                                    <div class="form-group col-md-3">
                                                                                        Search Groups:<br>
                                                                                        <!-- <select id="selectdepartmentitemgrouping" name="selectdepartmentitemgrouping" class="form-control"></select> -->
                                                                        
                                                                                        <input type="text" id="searchgroups" name="searchgroups" class="form-control">
                                                                                        
                                                                                    </div>
                                                                                    <div class="form-group col-md-3">
                                                                                        Select Group:<br>
                                                                                        <select name="selectusagegroupgroup" id="selectusagegroupgroup" class="form-control" required>
                                
                                                                                        </select>
                                                                                    </div>
                                                                                    <div class="form-group col-md-3">
                                                                                        Select Class:<br>
                                                                                        <select name="selectusageclassgroup" id="selectusageclassgroup" class="form-control" required>
                                
                                                                                        </select>
                                                                                    </div>
                                                                                    <div class="form-group col-md-3">
                                                                                        Select SubClass:<br>
                                                                                        <select name="selectusagesubclassgroup" id="selectusagesubclassgroup" class="form-control" required>
                                
                                                                                        </select>
                                                                                    </div>
                                                                                </div>
                                                                                
                                                                            </div>
                                                                            <div id="class">
                                                                                <div class="row">
                                                                                    <div class="form-group col-md-4">
                                                                                        Search Class:<br>
                                                                                        <input type="text" id="searchclass" name="searchclass" class="form-control">
                                                                                        
                                                                                    </div>
                                                                                    
                                                                                    <div class="form-group col-md-4">
                                                                                        Select Class:<br>
                                                                                        <select name="selectusageclassclass" id="selectusageclassclass" class="form-control" required>
                                
                                                                                        </select>
                                                                                    </div>
                                                                                    <div class="form-group col-md-4">
                                                                                        Select SubClass:<br>
                                                                                        <select name="selectusagesubclassclass" id="selectusagesubclassclass" class="form-control" required>
                                
                                                                                        </select>
                                                                                    </div>
                                                                                </div>
                                                                                
                                                                            </div>
                                                                            <div id="subclass">
                                                                                <div class="row">
                                                                                    <div class="form-group col-md-6">
                                                                                        Search Sub-Class:<br>
                                                                                        <input type="text" id="searchsubclass" name="searchsubclass" class="form-control">
                                                                                        
                                                                                    </div>
                                        
                                                                                    <div class="form-group col-md-6">
                                                                                        Select SubClass:<br>
                                                                                        <select name="selectusagesubclasssubclass" id="selectusagesubclasssubclass" class="form-control" required>
                                
                                                                                        </select>
                                                                                    </div>
                                                                                </div>
                                                                                
                                                                            </div>
                                                                            <div id="form">
                                                                                <div class="row">
                                                                                    <div class="form-group col-md-6">
                                                                                        Search Item Form:<br>
                                                                                        <input type="text" id="searchform" name="searchform" class="form-control">
                                                                                        
                                                                                    </div>
                                        
                                                                                    <div class="form-group col-md-6">
                                                                                        Select SubClass:<br>
                                                                                        <select name="selectform" id="selectform" class="form-control" required>
                                
                                                                                        </select>
                                                                                    </div>
                                                                                </div>
                                                                                
                                                                            </div>
                                                                            <div id="prescriptionnumber">
                                                                                <div class="row">
                                                                                    <div class="form-group col-md-6">
                                                                                        Prescription Number:<br>
                                                                                        <input type="text" id="searchprescription" name="searchprescription" class="form-control">
                                                                                        <!-- <select name="selectitemorder" class="form-control" id="selectitemorder"></select> -->
                                                                                    </div>
                                                                                    <div class="form-group col-md-6">
                                                                                        Recall Prescription:<br>
                                                                                        <select name="selectitemlist" class="form-control" id="selectitemlist"></select>
                                                                                    </div>
                                                                                    <!-- <div class="form-group col-md-1">
                                                                                        <br>
                                                                                        <button type="submit" style="padding-left: 2px;font-size: x-large;" class="genric-btn success" id="recall-itemorder-button" style="font-size: 24px;border-radius: 8px;">Refill</button>
                                                                                    </div> -->
                                                                                </div>
                                                                                
                                                                            </div>
                                                                            <div id="routinename">
                                                                                <div class="row">
                                                                                    <div class="form-group col-md-6">
                                                                                        Search Routine Name:<br>
                                                                                        <input type="text" id="searchregiment" name="searchregiment" class="form-control">
                                                                                        
                                                                                    </div>
                                                                                    <div class="form-group col-md-6">
                                                                                        Select Routine:<br>
                                                                                        <select name="selectregiment" id="selectregiment" class="form-control" required>
                                    
                                                                                        </select>
                                                                                    </div>
                                                                                </div>
                                                            
                                                                            </div>
                                                                        </div>
                                                                            
                                                                         
                                                                        
                                                                    </div>
                                                                </div>
                                                                <div id="hide_details">
                                                                    <div class="form-group col-md-3">
                                                                        SEARCH:<br>
                                                                        
                                                                        <input type="text" name="searchcombineditem" class="form-control" id="searchcombineditem" placeholder="Search Secondary Item">
                                                                    </div>
                                                                    <div class="form-group col-md-4">
                                                                        Select Department Item Grouping:<br>
                                                                        <select class="form-control" id="combinedselectdepartmentitemgroup" name="combinedselectdepartmentitemgroup">
                                                                       
                                                                        </select>
                                                                    </div>
                                                                    <div class="form-group col-md-5">
                                                                        Select Group:<br>
                                                                        <select class="form-control" id="combinedselectgroup" name="combinedselectgroup">
                                                                       
                                                                        </select>
                                                                    </div>
                                                                    <div class="form-group col-md-6">
                                                                        Select Class:<br>
                                                                        <select class="form-control" id="combinedselectclass" name="combinedselectclass">
                                                                       
                                                                        </select>
                                                                    </div>
                                                                    <div class="form-group col-md-6">
                                                                        Select Sub-Class:<br>
                                                                        <select class="form-control" id="combinedselectsubclass" name="combinedselectsubclass">
                                                                       
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                
                                                                <div class="form-group col-md-5">
                                                                    <br>
                                                                    Select Item From Stock:<br>
                                                                    <select class="form-control" id="combineditems" name="combineditems">
                                                                   
                                                                    </select>
                                                                </div>
                                                                <div class="form-group col-md-1">
                                                                    Price Per Piece:<br>
                                                                    
                                                                    <input type="text" name="combinedprice" class="form-control" id="combinedprice" placeholder="Unit Price" required>
                                                                </div>
                                                                <div class="form-group col-md-1">
                                                                    Price Per Weight:<br>
                                                                    
                                                                    <input type="number" min="0" max="100" name="combinedunitstrength" class="form-control" id="combinedunitstrength" placeholder="Unit Strength" required>
                                                                </div>
                                                                <div class="form-group col-md-1">
                                                                    Price Per Vol:<br>
                                                                    
                                                                    <input type="number" min="0" max="100" name="combinedliquidunitstrength" class="form-control" id="combinedliquidunitstrength" placeholder="Liquid Strength" required>
                                                                </div>
                                                                <div class="form-group col-md-1">
                                                                    Price Per Len:<br>
                                                                    
                                                                    <input type="number" min="0" max="100" name="combinedlengthunitstrength" class="form-control" id="combinedlengthunitstrength" placeholder="Length Strength" required>
                                                                </div>
                                                                <div class="form-group col-md-1">
                                                                    Price Per Srv:<br>
                                                                    
                                                                    <input type="number" min="0" max="100" name="combinedserviceunitstrength" class="form-control" id="combinedserviceunitstrength" placeholder="Service Strength" required>
                                                                </div>
                                                                <div class="form-group col-md-2">
                                                                    <br>
                                                                    Strength:<br>
                                                                    <select class="form-control" id="combineditemsstrength" name="combineditemsstrength">
                                                                       
                                                                    </select>
                                                                </div>
                                                                <div class="form-group col-md-2">
                                                                    Select Type of Unit:<br>
                                                                    <select class="form-control" id="combineditemsunittype" name="combineditemsunittype">
                                                                        <option value="weight">Per Weight</option>
                                                                        <option value="volume">Per Volume</option>
                                                                        <option value="service">Per Piece</option>
                                                                        <option value="length">Per Length</option>
                                                                        <option value="service">Per Service</option>
                                                                    </select>
                                                                </div>
                                                                <div class="form-group col-md-2">
                                                                    Select Unit:<br>
                                                                    <select class="form-control" id="combineditemsunit" name="combineditemsunit">
                                                                   
                                                                    </select>
                                                                </div>
                                                                <div class="form-group col-md-4">
                                                                    <div class="row">
                                                                        <div class="form-group col-md-4">
                                                                            Total Unit Quantity:<br>
                                                                            
                                                                            <input type="number" style="height:50px;font-size:24px;border-left:none;border-top:none;border-right:none;text-align: center;" min="0" max="100" name="combinedquantity" id="combinedquantity" placeholder="Whole" required>
                                                                            <!-- <span style="font-size:24px;">/</span> -->
                                                                        </div>
                                                                        <div class="form-group col-md-4">
                                                                            Quantity Needed:<br>
                                                                            <input type="number" style="height:50px;font-size:24px;border-left:none;border-top:none;border-right:none;text-align: center;" min="0" max="100" name="quantitycombinedquantity" id="quantitycombinedquantity" placeholder="Qty" required title="Unit Qty to be used">
                                                                            <!-- <span style="font-size:24px;">|</span> -->
                                                                        </div>
                                                                        <div class="form-group col-md-4">
                                                                            Parts of the Whole:<br>
                                                                            <input type="number" style="height:50px;font-size:24px;border-left:none;border-top:none;border-right:none;text-align: center;" min="0" max="100" name="partcombinedquantity" id="partcombinedquantity" placeholder="Parts" required title="Number of Parts of the Whole">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                
                                                                <div class="form-group col-md-2">
                                                                    Quantity Price:<br>
                                                                    
                                                                    <input type="text" name="combinedquantityprice" class="form-control" id="combinedquantityprice" placeholder="Quantity Price" required>
                                                                </div>
                                                                <div class="form-group col-md-2">
                                                                    <br>
                                                                    <button type="submit" class="genric-btn primary" id="add-combineditem-button" style="font-size: 18px;border-radius: 8px;">Add</button>
                                                                    <button type="submit" class="genric-btn primary" id="edit-combineditem-button" style="font-size: 18px;border-radius: 8px;">Edit</button>
                                                                   <input type="hidden" name="combinedstockitemid" id="combinedstockitemid">
                                                                   <input type="hidden" name="combineditemid" id="combineditemid">
                                                                   <input type="hidden" name="combineditemstate" id="combineditemstate">
                                                                   <input type="hidden" name="combineditemform" id="combineditemform">
                                                                   <input type="hidden" name="combineddepartmentitemgroup" id="combineddepartmentitemgroup">
                                                                   <input type="hidden" name="combinedsellingprice" id="combinedsellingprice">
                                                                   <input type="hidden" name="combinedsellingpriceperstrength" id="combinedsellingpriceperstrength">
                                                                   <input type="hidden" name="combinedsellingpriceperliquidstrength" id="combinedsellingpriceperliquidstrength">
                                                                   <input type="hidden" name="combinedsellingpriceperlength" id="combinedsellingpriceperlength">
                                                                   <input type="hidden" name="combinedtotalpiece" id="combinedtotalpiece">
                                                                   <input type="hidden" name="combinedtotalstrength" id="combinedtotalstrength">
                                                                   <input type="hidden" name="combinedtotalliquidstrength" id="combinedtotalliquidstrength">
                                                                   <input type="hidden" name="combinedtotallength" id="combinedtotallength">
                                                                   <input type="hidden" name="editcombinedpricingitemid" id="editcombinedpricingitemid">
                                                                </div>
                                                                <div class="form-group col-md-3">
                                                                    Select Routine Name:<br>
                                                                    <select name="itemregiments" style="font-size: 13px;" id="itemregiments" class="form-control"></select><br>
                                                                    <button type="submit" class="genric-btn danger" id="removeitem-itemregiment-button" style="font-size: 14px;border-radius: 8px;">REM ITEM</button>
                                                                    <button type="submit" class="genric-btn primary" id="delete-itemregiment-button" style="font-size: 14px;border-radius: 8px;">DEL</button>
                                                                    <button type="submit" class="genric-btn success" id="addfromtable-itemregiment-button" style="font-size: 14px;border-radius: 8px;">ADD ITEM(S)</button>
                                                            
                                                                    <br>
                                                                    View Routine List:<br>
                                                                    <select name="itemregimentslist" style="font-size:14px;font-weight: bolder;" id="itemregimentslist" size="10" class="form-control"></select>
                                                                    
                                                                    <!-- <button type="submit" class="genric-btn primary" id="add-selectitemregiment-button" style="font-size: 18px;border-radius: 8px;">ADD SELECTED ITEM</button> -->
                                                                    <button type="submit" class="genric-btn primary" id="add-itemregiment-button" style="font-size: 14px;border-radius: 8px;">ADD ALL</button>
                                                                    <button type="submit" class="genric-btn success" id="clear-itemregiment-button" style="font-size: 14px;border-radius: 8px;">CLR TABLE</button>
                                                                    <button type="submit" class="genric-btn success" id="clearlist-itemregiment-button" style="font-size: 14px;border-radius: 8px;">CLR LIST</button><br>
                                                            
                                                                    Create Routine Name:<br>
                                                                    <input type="text" name="regimentname" class="form-control" id="regimentname" style="font-size: 14px;" placeholder="Add Routine Name" required>
                                                                    <button type="submit" class="genric-btn success" id="regiment-combinedprice-button" style="font-size: 14px;border-radius: 8px;">ADD ROUTINE NAME</button>
                                                                    
                                                                    <br>
                                                                    
                                                                    <!-- <button type="submit" class="genric-btn danger" id="delete-itemregiment-button" style="font-size: 18px;border-radius: 8px;">DELETE</button> -->
                                                                    
                                                                    <div id="itemregimentinfo"></div>
                                                                    <br>
                                                                    
                                                                </div>
                                                              
                                                                
                                                                <div class="form-group col-md-9">
                                                                    <br>
                                                                    <div class="form-row" id="combinedpricevalue"></div>
                                                                    <div class="form-row" id="combinedpricetotalvalue"></div>
                                                                </div>
                                                                
                                                                <div class="form-group col-md-6">
                                                                 
                                                                    % Mark-Up:<br>
                                                                    Percentage <input type="number" value="1" min="1" max="100" class="form-control" id="markuppricecombined" name="markupprice">
                                                                    Price <input type="number" value="1" min="1" max="100" class="form-control" id="markuppricecombinedprice" name="markupprice">
                                                                    <!-- <button type="submit" class="genric-btn success" id="save-packpricing-button" style="font-size: 18px;border-radius: 8px;">SAVE</button> -->
                                                                    <button type="submit" class="genric-btn success" id="compute-combinedpricing-button" style="font-size: 18px;border-radius: 8px;">COMPUTE PRICING</button>
                                                                    <button type="submit" class="genric-btn success" id="save-combinedprice-button" style="font-size: 18px;border-radius: 8px;">SAVE PRICING</button>
                                                                    <button type="submit" class="genric-btn success" id="update-combinedprice-button" style="font-size: 18px;border-radius: 8px;">UPDATE</button>
                                                                    <button type="submit" class="genric-btn success" id="refresh-combinedprice-button" style="font-size: 18px;border-radius: 8px;">REFRESH</button>
                                                                    
                                                                    <br>
                                                                    <div id="computecombinedpricing" style="font-size: 24px;">
                                                                   
                                                                    </div>
                                                                </div>
                                                                
                                                               
                                                                <div class="form-row form-edit-combinedpricing"></div>
                                                                
                                                            </div>
                                                            
                                                            <div class="regerv_btn">
                                                                
                                                                <!-- <button type="submit" class="genric-btn primary" id="cancel-packpricing-button" style="font-size: 18px;border-radius: 8px;">Cancel</button>
                                                                <button type="submit" class="genric-btn success" id="edit-packpricing-button" style="font-size: 18px;border-radius: 8px;">Edit</button>
                                                                <button type="submit" class="genric-btn danger" id="delete-packpricing-button" style="font-size: 18px;border-radius: 8px;">Confirm Deletion</button> -->
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    
                    </div>
                </div>
                <!-- <div class="col-lg-5 col-md-6">
                    <div class="reservation_img">
                        <img src="img/loginphoto.jpg" alt="">
                    </div>
                </div> -->
            </div>
        </div>
    </section>
    <!--::regervation_part end::-->

    
    <!-- footer part start-->
    <footer class="footer-area">

        <div class="copyright_part">
            
        </div>
    </footer>

    <!-- footer part end-->

    <!-- jquery plugins here-->

    <script src="js/jquery-1.12.1.min.js"></script>
    <!-- popper js -->
    <script src="js/popper.min.js"></script>
    <!-- bootstrap js -->
    <script src="js/bootstrap.min.js"></script>
    <!-- easing js -->
    <script src="js/jquery.magnific-popup.js"></script>
    <!-- swiper js -->
    <script src="js/swiper.min.js"></script>
    <!-- swiper js -->
    <script src="js/masonry.pkgd.js"></script>
    <!-- particles js -->
    <script src="js/owl.carousel.min.js"></script>
    <!-- <script src="js/jquery.nice-select.min.js"></script> -->
    <!-- swiper js -->
    <script src="js/slick.min.js"></script>
    <script src="js/jquery.counterup.min.js"></script>
    <script src="js/waypoints.min.js"></script>
    <!-- contact js -->
    <script src="js/jquery.ajaxchimp.min.js"></script>
    <script src="js/jquery.form.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/mail-script.js"></script>
    <script src="js/contact.js"></script>
    <!-- custom js -->
    <script src="js/custom.js"></script>
    <script src="views/masterpage.js"></script>
    <script src="views/stock-item-dispensing.js"></script>
    <!--<script src="views/corpse-list.js"></script> -->
    <script src="js/moment.min.js"></script>
	<script src="js/bootstrap-datetimepicker.min.js"></script>
    <script>
            $(function () {
                $('#expirydate1').datetimepicker({
                    format: 'LT'
                });
                // $('#datetimepicker4').datetimepicker({
                //     format: 'LT'
                // });
            });
    </script>
    <script>
        $(document).ready(function(){
            
            $("#edit-combineditem-button").hide()
            let itemstrength = ""
            let getStockType = "getStockType"
            let searchItem = ""
            let stocktypelist = ""
            $.post("controllers/combo-setup.php",{searchItem:searchItem,getStockType:getStockType}, function(data){
                if(data!="No Record Found"){
                    let stocktypeoptions = ``
                    data = JSON.parse(data)
                    $.each(data.records, function(key, val) {
                        stocktypeoptions += `<option value="` + val.stocktype + `">` + val.stocktype + `</option>`
                    });
                    stocktypelist = stocktypeoptions
                    $("#stocktype").html(stocktypeoptions)
                    $("#stocktype").val("Drug")
                }
            })
            $("#stocktype").on("change", function(evt){
                evt.preventDefault()
                let stocktype = $("#stocktype").val()
                if(stocktype.toUpperCase()=="SERVICE"){
                    $("#package").val("services")
                    $("#piecesheading").html("Service Quantity in Days")

                    $("#bag").hide()
                    $("#carton").hide()
                    $("#roll").hide()
                    $("#pack").hide()
                    $("#sachet").hide()

                } else if(stocktype.toUpperCase()=="LENGTH"){
                    $("#package").val("length")
                    $("#piecesheading").html("Length")

                    $("#bag").hide()
                    $("#carton").hide()
                    $("#roll").hide()
                    $("#pack").hide()
                    $("#sachet").hide()

                } else if(stocktype.toUpperCase()=="CAPITAL ITEM"){
                    $("#package").val("pieces")
                    $("#piecesheading").html("Service Quantity in Days")

                    $("#bag").hide()
                    $("#carton").hide()
                    $("#roll").hide()
                    $("#pack").hide()
                    $("#sachet").hide()

                } else {
                    $("#package").val("bag")
                    $("#piecesheading").html("Pieces")

                    $("#bag").show()
                    $("#carton").show()
                    $("#roll").show()
                    $("#pack").show()
                    $("#sachet").show()
                }
            })
            let supplierlist = ""
            let getSupplier = "getSupplier"
            $.post("controllers/combo-setup.php",{searchItem:searchItem,getSupplier:getSupplier}, function(data){
                if(data!="No Record Found"){
                    let supplieroptions = ``
                    data = JSON.parse(data)
                    $.each(data.records, function(key, val) {
                        supplieroptions += `<option value="` + val.supplier + `">` + val.supplier + `</option>`
                    });
                    supplierlist = supplieroptions
                    $("#selectsupplier").html(supplieroptions)
                }
            })

            let organizationlist = ""
            let getOrganization = "getOrganization"
            //let searchItem = ""
            $.post("controllers/combo-setup.php",{searchItem:searchItem,getOrganization:getOrganization}, function(data){
                if(data!="No Record Found"){
                    let organizationoptions = ``
                    data = JSON.parse(data)
                    // //console.log(data)
                    $.each(data.records, function(key, val) {
                        organizationoptions += `<option value="` + val.organization + `">` + val.organization + `</option>`
                    });
                    organizationlist = organizationoptions
                    $("#organization").html(organizationoptions)

                    $("#organizationdiscount").val(data.records[0].discount)
                    $("#organizationid").val(data.records[0].id)
                }
            })

            $("#organization").on("change", function(evt){
                evt.preventDefault()

                let organization = $("#organization").val()
                let getOrganizationByName = "getOrganizationByName"
                $.post("controllers/combo-setup.php",{organization:organization,getOrganizationByName:getOrganizationByName},function(data){
                    //console.log(data)
                    data = JSON.parse(data)
                    
                    $("#organizationdiscount").val(data.discount)
                    $("#organizationid").val(data.id)
                })

            })

            //let supplierlist = ""
            let getPackaging = "getPackaging"
            $.post("controllers/combo-setup.php",{searchItem:searchItem,getPackaging:getPackaging}, function(data){
                if(data!="No Record Found"){
                    let packages = ``
                    data = JSON.parse(data)
                    $.each(data.records, function(key, val) {
                        packages += `
                        
                        <option value="` + val.packaging + `">` + val.packaging + `</option>
                        `
                    });
                    //supplierlist = supplieroptions
                    //$("#package").html(packages)
                }
            })

            $("#package").on("change", function(evt){
                let package = $("#package").val()
                let stocktype = $("#stocktype").val()
                if(package=="carton"){
                    $("#bag").hide()
                    $("#carton").show()
                    $("#roll").show()
                    $("#pack").show()
                    $("#sachet").show()
                    $("#piecesheading").html("Pieces:")
                } else if(package=="roll"){
                    $("#bag").hide()
                    $("#carton").hide()
                    $("#roll").show()
                    $("#pack").show()
                    $("#sachet").show()
                    $("#piecesheading").html("Pieces:")
                } else if(package=="pack"){
                    $("#bag").hide()
                    $("#carton").hide()
                    $("#roll").hide()
                    $("#pack").show()
                    $("#sachet").show()
                    $("#piecesheading").html("Pieces:")
                } else if(package=="sachet"){
                    $("#bag").hide()
                    $("#carton").hide()
                    $("#roll").hide()
                    $("#pack").hide()
                    $("#sachet").show()
                    $("#piecesheading").html("Pieces:")
                } else if(package=="pieces"){
                    $("#bag").hide()
                    $("#carton").hide()
                    $("#roll").hide()
                    $("#pack").hide()
                    $("#sachet").hide()
                    $("#piecesheading").html("Pieces:")
                    console.log(stocktype)
                    if(stocktype.toUpperCase()=="CAPITAL ITEM"){
                    
                        $("#piecesheading").html("Service Quantity in Days")
                    }
                } else if(package=="bag"){
                    $("#bag").show()
                    $("#carton").show()
                    $("#roll").show()
                    $("#pack").show()
                    $("#sachet").show()
                    $("#piecesheading").html("Pieces:")
                } else if(package=="services"){
                    $("#bag").hide()
                    $("#carton").hide()
                    $("#roll").hide()
                    $("#pack").hide()
                    $("#sachet").hide()
                    $("#piecesheading").html("Service Quantity in Days")
                }

            })

            let combinedpricingvaluearray = []
            let packagingvalue = []
            let packagingvaluelist = []
            let totalsum = 0
            let finalpieces = 0
            let finalweight = 0
            let finalservice = 0
            let finalvolume = 0
            let finallength = 0
            let finalmicrogram = 0
            let finalinternationalunit = 0
            let unitpieceprice = 0
            let unitstrengthprice = 0
            let unitliquidstrengthprice = 0
            let unitlengthprice = 0
            let unitserviceprice = 0
            let unitmicrogramprice = 0
            let unitinternationalunitprice = 0

            function getItemsFunction(){
                  
                $("#edit-pricing-button").hide()
                $("#delete-pricing-button").hide()
                $("#cancel-pricing-button").hide()
                $("#add-pricing-button").show()
                $("#sellingprice").html("")
                $("#packagingvalue").html("")
                $("#clear-package-button").hide()
                packagingvalue = []
                finalpieces = 0
                finalweight = 0
                finalvolume = 0
                finalmicrogram = 0
                finalinternationalunit = 0
                combinedpricingvaluearray = []
                    //get Item Codes
                    let getStockItem = "getStockItem"
                    let searchItem = $("#searchitem").val()
                    //console.log(searchItem)
                    $.post("controllers/combo-setup.php",{searchItem:searchItem,getStockItem: getStockItem},function(formdata){
                        ////console.log(data)
                        if(formdata=="No Record Found"){
                            $("#stockitem-status").html(formdata)
                        }else{
                            ////console.log(formdata)
                            //console.log(typeof(formdata))
                            let data=JSON.parse(formdata)
                            //console.log(data)
                            let count = 0
                                
                            let genericnameoptions = ``
                            $.each(data.records, function(key, val) {
                                count++
                                genericnameoptions += `
                                <option value="` + val.id + `">` + val.genericname + " (" + val.tradename + `)</option>
                            `
                            })
                            $("#stockitem-status").html(count + " Record(s) Found")
                            $("#selectitem").html(genericnameoptions)
                            // $("#combinedselectitem").html(genericnameoptions)



                            let getStockItemDetailsById = "getStockItemDetailsById"
                            let searchItem = $("#selectitem").val()
                            $.post("controllers/combo-setup.php",{searchItem:searchItem,getStockItemDetailsById:getStockItemDetailsById},function(data){
                                console.log(data)
                                data = JSON.parse(data)
                                $("#stocknumber").val(data.itemcode)
                                $("#stockitemnumber").val(data.stockitemnumber)
                                $("#itemstrengthvalue").html(data.itemstrength)
                                let itemstrength = data.itemstrength
                               
                                $("#selectsupplier").html("<option value='" + data.suppliername + "'>" + data.suppliername + "</option>" + supplierlist)
                                $("#stockitemid").val(data.id)
                                $("#itemamount").val(data.actualservice)
                                //console.log(data.id)
                                let itemid = data.itemid
                                $("#itemid").val(itemid)
                                //console.log(itemid)
                                let GetGenericNameDetails = "GetGenericNameDetails"
                                $.post("controllers/combo-setup.php", {id:itemid,GetGenericNameDetails:GetGenericNameDetails},function(data){
                                    // console.log(data)
                                    data = JSON.parse(data)
                                    $("#usagegrouptype").html(data.usagegrouptype)
                                    $("#itemstate").val(data.itemstate)
                                    $("#itemserviceunitname").val(data.itemservice)
                                    $("#totaldurationdays").html("0")
                                    $("#totalduration").html("NONE")
                                    if($("#itemstate").val()=="Service"){
                                        console.log(itemstrength)
                                        console.log(itemstrength.indexOf("Month"))
                                        if(itemstrength.indexOf("Month")!=-1||itemstrength.indexOf("MONTH")!=-1){
                                            $("#package").val("services")
                                            $("#pieces").val("30")
                                            $("#totalduration").html("MONTH")
                                            $("#totaldurationdays").html("30")
                                        }
                                        if(itemstrength.indexOf("Year")!=-1||itemstrength.indexOf("YEAR")!=-1){
                                            $("#package").val("services")
                                            $("#pieces").val("365")
                                            $("#totalduration").html("YEAR")
                                            $("#totaldurationdays").html("365")
                                        }
                                        if(itemstrength.indexOf("Week")!=-1||itemstrength.indexOf("WEEK")!=-1){
                                            $("#package").val("services")
                                            $("#pieces").val("7")
                                            $("#totalduration").html("WEEK")
                                            $("#totaldurationdays").html("7")
                                        }
                                        $("#bag").hide()
                                            $("#carton").hide()
                                            $("#roll").hide()
                                            $("#pack").hide()
                                            $("#sachet").hide()
                                    }
                                    $("#itemdepartmentitemgroup").html(data.departmentitemgroup)
                                    $("#actualpieces").val(zeroifnull(data.actualpieces))
                                    $("#actualweight").val(zeroifnull(data.actualweight))
                                    $("#actualvolume").val(zeroifnull(data.actualvolume))
                                    $("#actuallength").val(zeroifnull(data.actuallength))
                                    $("#actualservice").val(zeroifnull(data.actualservice))
                                    $("#actualmicrogram").val(zeroifnull(data.actualmicrogram))
                                    $("#actualinternationalunit").val(zeroifnull(data.actualinternationalunit))
                                    // console.log(typeof(data.actualservice))
                                    $("#weightunit").val(data.weightunit)
                                    $("#volumeunit").val(data.volumeunit)
                                    $("#serviceunit").val(data.serviceunit)
                                })

                                getStockListItemInfo()
                                getStockItemPrice()
                
                            })
                        }

                        
                            
                            
                        })

                    }

                    function getCombinedSearchItemsFunction(){
                  
                        $("#edit-pricing-button").hide()
                        $("#delete-pricing-button").hide()
                        $("#cancel-pricing-button").hide()
                        $("#add-pricing-button").show()
                        $("#sellingprice").html("")
                        $("#packagingvalue").html("")
                        $("#clear-package-button").hide()
                        packagingvalue = []
                        finalpieces = 0
                        finalweight = 0
                        finalvolume = 0
                        combinedpricingvaluearray = []
                            //get Item Codes
                            let getStockItem = "getStockItem"
                            let searchItem = $("#combinedsearchitem").val()
                            //console.log(searchItem)
                            $.post("controllers/combo-setup.php",{searchItem:searchItem,getStockItem: getStockItem},function(formdata){
                                ////console.log(data)
                                if(formdata=="No Record Found"){
                                    $("#stockitem-status").html(formdata)
                                }else{
                                    ////console.log(formdata)
                                    //console.log(typeof(formdata))
                                    let data=JSON.parse(formdata)
                                    //console.log(data)
                                    let count = 0
                                        
                                    let genericnameoptions = ``
                                    $.each(data.records, function(key, val) {
                                        count++
                                        genericnameoptions += `
                                        <option value="` + val.id + `">` + val.genericname + ` (` + val.tradename + `)</option>
                                    `
                                    })
                                    $("#stockitem-status").html(count + " Record(s) Found")
                                    // $("#selectitem").html(genericnameoptions)
                                    $("#combinedselectitem").html(genericnameoptions)
        
        
        
                                    let getStockItemDetailsById = "getStockItemDetailsById"
                                    let searchItem = $("#combinedselectitem").val()
                                    $.post("controllers/combo-setup.php",{searchItem:searchItem,getStockItemDetailsById:getStockItemDetailsById},function(data){
                                        data = JSON.parse(data)
                                        $("#stocknumber").val(data.itemcode)
                                        $("#stockitemnumber").val(data.stockitemnumber)
                                        $("#itemstrengthvalue").html(data.itemstrength)
                                        $("#selectsupplier").html("<option value='" + data.suppliername + "'>" + data.suppliername + "</option>" + supplierlist)
                                        $("#stockitemid").val(data.id)
                                        //console.log(data.id)
                                        let itemid = data.itemid
                                        $("#itemid").val(itemid)
                                        //console.log(itemid)
                                        let GetGenericNameDetails = "GetGenericNameDetails"
                                        $.post("controllers/combo-setup.php", {id:itemid,GetGenericNameDetails:GetGenericNameDetails},function(data){
                                            //console.log(data)
                                            data = JSON.parse(data)
                                            $("#usagegrouptype").html(data.usagegrouptype)
                                            $("#itemstate").val(data.itemstate)
                                            $("#itemserviceunitname").val(data.itemservice)
                                            $("#itemdepartmentitemgroup").html(data.departmentitemgroup)
                                            $("#actualpieces").val(zeroifnull(data.actualpieces))
                                            $("#actualweight").val(zeroifnull(data.actualweight))
                                            $("#actualvolume").val(zeroifnull(data.actualvolume))
                                            $("#actuallength").val(zeroifnull(data.actuallength))
                                            $("#actualservice").val(zeroifnull(data.actualservice))
                                            $("#actualmicrogram").val(zeroifnull(data.actualmicrogram))
                                            $("#actualinternationalunit").val(zeroifnull(data.actualinternationalunit))
                                            $("#weightunit").val(data.weightunit)
                                            $("#volumeunit").val(data.volumeunit)
                                            $("#serviceunit").val(data.serviceunit)
                                        })
        
                                        getStockListItemInfo()
                                        getStockItemPrice()
                        
                                    })
                                }
        
                                
                                    
                                    
                                })
        
                    }

                    getItemsFunction()

                    $("#hide_details").hide()

                    function getCombinedItemsFunction(){

                            //get Department Item Grouping
                            let getDepartmentItemGroup = "getDepartmentItemGroup"
                            let searchItem = ""
                            $.post("controllers/combo-setup.php",{searchItem:searchItem,getDepartmentItemGroup: getDepartmentItemGroup},function(formdata){
                                if(formdata=="No Record Found"){
                                    $("#combinedselectdepartmentitemgroup").html("<option value='None'>No Dept Item Group</option>")
                                }else{
                                    // console.log(formdata)
                                    let data = JSON.parse(formdata)
                                    let departmentitemgroupoptions = ``
                                    $.each(data.records, function(key, val){
                                        departmentitemgroupoptions += `
                                            <option value="` + val.departmentitemgroup + `">` + val.departmentitemgroup + `</option>
                                        `
                                    })
                                    $("#combinedselectdepartmentitemgroup").html(departmentitemgroupoptions)
                                }

                                let deptItemgroup = $("#combinedselectdepartmentitemgroup").val()
                                let getItemGroupByDeptItemGroup = "getItemGroupByDeptItemGroup"
                                $.post("controllers/combo-setup.php",{departmentitemgroup:deptItemgroup, getItemGroupByDeptItemGroup: getItemGroupByDeptItemGroup},function(formdata){
                                    //get Item Codes
                                    //console.log(formdata)
                                    let data = JSON.parse(formdata)
                                    let itemgropoptions = ``
                                    $.each(data.records, function(key, val){
                                        itemgropoptions += `
                                            <option value="` + val.itemgroup + `">` + val.itemgroup + `</option>
                                        `
                                    })
                                    $("#combinedselectgroup").html(itemgropoptions)

                                    //Get Item Class
                                    let itemgroup = $("#combinedselectgroup").val()
                                    let getItemClassByItemGroup = "getItemClassByItemGroup"
                                    $.post("controllers/combo-setup.php",{searchItem:itemgroup, getItemClassByItemGroup: getItemClassByItemGroup},function(formdata){
                                        //get Item Codes
                                        //console.log(formdata)
                                        let data = JSON.parse(formdata)
                                        let itemclassoptions = ``
                                        $.each(data.records, function(key, val){
                                            itemclassoptions += `
                                                <option value="` + val.itemclass + `">` + val.itemclass + `</option>
                                            `
                                        })
                                        $("#combinedselectclass").html(itemclassoptions)
                                        //Get Item Subclass
                                        let itemclass = $("#combinedselectclass").val()
                                        let getItemSubClassByClass = "getItemSubClassByClass"
                                        $.post("controllers/combo-setup.php",{selectsubclassclass:itemclass, getItemSubClassByClass: getItemSubClassByClass},function(formdata){
                                            //get Item Codes
                                            //console.log(formdata)
                                            let data = JSON.parse(formdata)
                                            let itemsubclassoptions = ``
                                            $.each(data.records, function(key, val){
                                                itemsubclassoptions += `
                                                    <option value="` + val.itemsubclass + `">` + val.itemsubclass + `</option>
                                                `
                                            })
                                            $("#combinedselectsubclass").html(itemsubclassoptions)
                                            itemgroup = $("#combinedselectsubclass").val()
                                            let getStockItemListByUsageSubClass = "getStockItemListByUsageSubClass"
                                            searchItem = $("#searchcombineditem").val()
                                            
                                            //console.log(searchItem)
                                            $.post("controllers/combo-setup.php",{itemgroup:itemgroup, deptItemgroup:deptItemgroup, searchItem:searchItem,getStockItemListByUsageSubClass: getStockItemListByUsageSubClass},function(formdata){
                                                console.log(formdata)
                                                if(formdata=="No Record Found"){
                                                    $("#combineditems").html("<option value='None'>No Items</option>")
                                                }else{
                                                    //console.log(formdata)
                                                    //console.log(typeof(formdata))
                                                    let data=JSON.parse(formdata)
                                                    //console.log(data)
                                                    let count = 0
                                                        
                                                    let genericnameoptions = ``
                                                    $.each(data.records, function(key, val) {
                                                        count++
                                                        genericnameoptions += `
                                                        <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                                    `
                                                    })
                                                    // $("#stockitem-status").html(count + " Record(s) Found")
                                                    $("#combineditems").html(genericnameoptions)
                                                

                                                    
                                                
                                                    let searchItem = $("#combineditems").val()
                                                    let splitsearchItem = searchItem.split(",")
                                                    searchItem = splitsearchItem[2]
                                                    //console.log(splitsearchItem)
                                                    getCombinedItemsDetails(searchItem)

                                                }
                        
                                                
                                                    
                                                    
                                                })
                                            
                                        })
                                    })

                                   
                                })
                                
                            })

                  
        
                        }   

                        function getCombinedItemsDetails(searchItem){
                            let getStockItemListDetailsById = "getStockItemListDetailsById"
                            $.post("controllers/combo-setup.php",{searchItem:searchItem,getStockItemListDetailsById:getStockItemListDetailsById},function(data){
                                console.log(data)
                                data = JSON.parse(data)
                                $("#combinedstockitemid").val(data.id)
                                $("#combineditemid").val(data.itemid)
                                $("#combinedprice").val(data.sellingprice)
                                $("#combinedunitstrength").val(data.sellingpriceperstrength)
                                $("#combinedliquidunitstrength").val(data.sellingpriceperliquidstrength)
                                $("#combinedlengthunitstrength").val(zeroifnull(data.sellingpriceperlength))
                                $("#combinedserviceunitstrength").val(data.sellingprice)
                                $("#combinedtotalpiece").val(data.totalpieces)
                                $("#combinedtotalstrength").val(data.totalstrength)
                                $("#combinedtotalliquidstrength").val(data.totalliquidstrength)
                                $("#combinedtotallength").val(zeroifnull(data.totallengthsthrength))
                                let itemsstrength = `
                                    <option value="pieces,` + data.totalpieces + `">Pcs(` + data.totalpieces + `)</option>
                                    <option value="weight,` + data.totalstrength + `">Wgt(` + data.totalstrength + `)</option>
                                    <option value="volume,` + data.totalliquidstrength + `">Vol(` + data.totalliquidstrength + `)</option>
                                    <option value="length,` + zeroifnull(data.totallengthsthrength) + `">Len(` + zeroifnull(data.totallengthsthrength) + `)</option>
                                    <option value="service,` + data.totalpieces + `">Srv(` + data.totalpieces + `)</option>
                                `
                                $("#combineditemsstrength").html(itemsstrength)
                                let totalpieces = data.totalpieces
                                let totalstrength = data.totalstrength
                                let totalliquidstrength = zeroifnull(data.totalliquidstrength)
                                let totallengthstrength = zeroifnull(data.totallengthsthrength)
                                let unitstrength = totalstrength / totalpieces
                                let unitliquidstrength = totalliquidstrength / totalpieces
                                let unitlengthstrength = totallengthstrength / totalpieces

                                unitstrength = unitstrength.toFixed(0)
                                unitliquidstrength = unitliquidstrength.toFixed(0)
                                unitlengthstrength = unitlengthstrength.toFixed(0)

                                // $("#combinedunitstrength").val(unitstrength)
                                // $("#combinedliquidunitstrength").val(unitliquidstrength)
                                $("#combinedsellingprice").val(data.sellingprice)
                                $("#combinedsellingpriceperstrength").val(data.sellingpriceperstrength)
                                $("#combinedsellingpriceperliquidstrength").val(data.sellingpriceperliquidstrength)
                                $("#combinedsellingpriceperlength").val(data.sellingpriceperlength)

                                let itemform = data.itemform
                                if(itemform.includes(",")){
                                    splititemform = itemform.split(",")
                                    itemform = splititemform[1]
                                }
                                $("#combineditemform").val(itemform)
                                //Need the state

                                let itemid = data.itemid
                                //console.log(itemid)
                                if(itemid!=0){
                                    let GetGenericNameDetails = "GetGenericNameDetails"
                                    $.post("controllers/combo-setup.php",{id:itemid,GetGenericNameDetails:GetGenericNameDetails},function(formdata){
                                        //console.log(formdata)
                                        let data = JSON.parse(formdata)
                                        $("#combineditemstate").val(data.itemstate)
                                        $("#combineddepartmentitemgroup").val(data.departmentitemgroup)
                                        // $("#actualpieces").val(data.actualpieces)
                                        // $("#actualweight").val(data.actualweight)
                                        // $("#actualvolume").val(data.actualvolume)
                                        // $("#weightunit").val(data.weightunit)
                                        // $("#volumeunit").val(data.volumeunit)
                                        // $("#serviceunit").val(data.serviceunit)
                                        
                                        let price = 0
                                            let unittype = $("#combineditemsunittype").val()
                                            if(unittype=="weight"){
                                                
                                                
                                                price = $("#combinedunitstrength").val()
                                                // $("#combinedprice").val(price)
                                                let quantity = zeroifnull($("#combinedquantity").val())
                                                let quantityprice = quantity * price
                                                quantityprice = quantityprice.toFixed(2)
                                                $("#combinedquantityprice").val(quantityprice)
                                            } else if(unittype=="volume"){
                                                price = $("#combinedliquidunitstrength").val()
                                                // $("#combinedprice").val(price)
                                                quantity = zeroifnull($("#combinedquantity").val())
                                                quantityprice = quantity * price
                                                quantityprice = quantityprice.toFixed(2)
                                                $("#combinedquantityprice").val(quantityprice)
                                            } else if(unittype=="length"){
                                                price = $("#combinedlengthunitstrength").val()
                                                // $("#combinedprice").val(price)
                                                quantity = zeroifnull($("#combinedquantity").val())
                                                quantityprice = quantity * price
                                                quantityprice = quantityprice.toFixed(2)
                                                $("#combinedquantityprice").val(quantityprice)
                                            } else if(unittype=="service"){
                                                
                                               
                                                
                                                price = $("#combinedprice").val()
                                                // $("#combinedprice").val(price)
                                                quantity = zeroifnull($("#combinedquantity").val())
                                                quantityprice = quantity * price
                                                quantityprice = quantityprice.toFixed(2)
                                                $("#combinedquantityprice").val(quantityprice)
                                            }
                                            let itemstate = $("#combineditemstate").val()
                                            let unitoptions = ``
                                            
                                                                               
                                            //default value for units is weight
                                            //get weight units
                                            let getItemWeightByDepartmentItemGrouping = "getItemWeightByDepartmentItemGrouping"
                                            let departmentitemgroup = $("#combineddepartmentitemgroup").val()
                                            $.post("controllers/combo-setup.php",{state:itemstate, searchItem:departmentitemgroup,getItemWeightByDepartmentItemGrouping:getItemWeightByDepartmentItemGrouping},function(formdata){
                                                let data = JSON.parse(formdata)
                                                let itemform = $("#combineditemform").val()
                                                unitoptions = `
                                                    <option value='Unit'>Unit</option>
                                                    <option value='` + itemform + `'>`+ itemform + `</option>
                                                `
                                                $.each(data.records, function(key, val) {
                                                    unitoptions += `
                                                    <option value='` + val.abbreviation + `'>`+ val.unit + `</option>
                                                    `
                                                });
                                                // $("#combineditemsunit").html(unitoptions + serviceunit)
                                            })
                                                   
                                   
                                                                                                                
                                            //default value for units is weight
                                            //get weight units
                                            let getItemVolumeByDepartmentItemGrouping = "getItemVolumeByDepartmentItemGrouping"
                                            departmentitemgroup = $("#combineddepartmentitemgroup").val()
                                            $.post("controllers/combo-setup.php",{state:itemstate, searchItem:departmentitemgroup,getItemVolumeByDepartmentItemGrouping:getItemVolumeByDepartmentItemGrouping},function(formdata){
                                                let data = JSON.parse(formdata)
                                                let itemform = $("#combineditemform").val()
                                                
                                                $.each(data.records, function(key, val) {
                                                    unitoptions += `
                                                    <option value='` + val.abbreviation + `'>`+ val.unit + `</option>
                                                    `
                                                });
                                                // $("#combineditemsunit").html(unitoptions + serviceunit)
                                            })

                                            //default value for units is weight
                                            //get weight units
                                            let getItemLengthByDepartmentItemGrouping = "getItemLengthByDepartmentItemGrouping"
                                            departmentitemgroup = $("#combineddepartmentitemgroup").val()
                                            $.post("controllers/combo-setup.php",{state:itemstate, searchItem:departmentitemgroup,getItemLengthByDepartmentItemGrouping:getItemLengthByDepartmentItemGrouping},function(formdata){
                                                let data = JSON.parse(formdata)
                                                console.log(data)
                                                let itemform = $("#combineditemform").val()
                                                
                                                $.each(data.records, function(key, val) {
                                                    unitoptions += `
                                                    <option value='` + val.abbreviation + `'>`+ val.unit + `</option>
                                                    `
                                                });
                                                // $("#combineditemsunit").html(unitoptions + serviceunit)
                                            })
                                    
                                                                                                                                   
                                            //default value for units is weight
                                            //get weight units
                                            let getItemServiceByDepartmentItemGrouping = "getItemServiceByDepartmentItemGrouping"
                                            departmentitemgroup = $("#combineddepartmentitemgroup").val()
                                            $.post("controllers/combo-setup.php",{state:itemstate, searchItem:departmentitemgroup,getItemServiceByDepartmentItemGrouping:getItemServiceByDepartmentItemGrouping},function(formdata){
                                                let data = JSON.parse(formdata)
                                                let itemform = $("#combineditemform").val()
                                                
                                                $.each(data.records, function(key, val) {
                                                    unitoptions += `
                                                    <option value='` + val.abbreviation + `'>`+ val.unit + `</option>
                                                    `
                                                });
                                                $("#combineditemsunit").html(unitoptions + serviceunit)
                                            })
                  
                                        
                                    
                                    })
                                }
                                
                                

                                
                            })
                        }

                        $("#combinedselectsubclass").on("change", function(evt){
                            let deptItemgroup = $("#combinedselectdepartmentitemgroup").val()
                            let getStockItemListByUsageSubClass = "getStockItemListByUsageSubClass"
                            let searchItem = $("#searchcombineditem").val()
                            let itemgroup = $("#combinedselectsubclass").val()
                            $.post("controllers/combo-setup.php",{itemgroup:itemgroup, deptItemgroup:deptItemgroup, searchItem:searchItem,getStockItemListByUsageSubClass: getStockItemListByUsageSubClass},function(formdata){
                                console.log(formdata)
                                if(formdata=="No Record Found"){
                                    $("#combineditems").html("<option value='None'>No Items</option>")
                                }else{
                                    //console.log(formdata)
                                    //console.log(typeof(formdata))
                                    let data=JSON.parse(formdata)
                                    //console.log(data)
                                    let count = 0
                                        
                                    let genericnameoptions = ``
                                    $.each(data.records, function(key, val) {
                                        count++
                                        genericnameoptions += `
                                        <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                    `
                                    })
                                    // $("#stockitem-status").html(count + " Record(s) Found")
                                    $("#combineditems").html(genericnameoptions)
                                

                                    
                                    // let getStockItemListDetailsById = "getStockItemListDetailsById"
                                    let searchItem = $("#combineditems").val()
                                    let splitsearchItem = searchItem.split(",")
                                    searchItem = splitsearchItem[2]
                                    getCombinedItemsDetails(searchItem)
                                }
                            })
                        })
                        let deptItemgroup = $("#combinedselectdepartmentitemgroup").val()
                        // let getStockItemListByUsageSubClass = "getStockItemListByUsageSubClass"
                        // let searchItem = $("#searchcombineditem").val()
                        let itemgroup = ""
                        $("#combinedselectclass").on("change", function(evt){
                            evt.preventDefault()
                            let itemclass = $("#combinedselectclass").val()
                            let getItemSubClassByClass = "getItemSubClassByClass"
                            $.post("controllers/combo-setup.php",{selectsubclassclass:itemclass, getItemSubClassByClass: getItemSubClassByClass},function(formdata){
                                //get Item Codes
                                //console.log(formdata)
                                let data = JSON.parse(formdata)
                                let itemsubclassoptions = ``
                                $.each(data.records, function(key, val){
                                    itemsubclassoptions += `
                                        <option value="` + val.itemsubclass + `">` + val.itemsubclass + `</option>
                                    `
                                })
                                $("#combinedselectsubclass").html(itemsubclassoptions)
                                
                                deptItemgroup = $("#combinedselectdepartmentitemgroup").val()
                                getStockItemListByUsageSubClass = "getStockItemListByUsageSubClass"
                                searchItem = $("#searchcombineditem").val()
                                itemgroup = $("#combinedselectsubclass").val()
                                $.post("controllers/combo-setup.php",{itemgroup:itemgroup, deptItemgroup:deptItemgroup, searchItem:searchItem,getStockItemListByUsageSubClass: getStockItemListByUsageSubClass},function(formdata){
                                    ////console.log(data)
                                    if(formdata=="No Record Found"){
                                        $("#combineditems").html("<option value='None'>No Items</option>")
                                    }else{
                                        //console.log(formdata)
                                        //console.log(typeof(formdata))
                                        let data=JSON.parse(formdata)
                                        //console.log(data)
                                        let count = 0
                                            
                                        let genericnameoptions = ``
                                        $.each(data.records, function(key, val) {
                                            count++
                                            genericnameoptions += `
                                            <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                        `
                                        })
                                        // $("#stockitem-status").html(count + " Record(s) Found")
                                        $("#combineditems").html(genericnameoptions)
                                    

                                        
                                        // let getStockItemListDetailsById = "getStockItemListDetailsById"
                                        let searchItem = $("#combineditems").val()
                                        let splitsearchItem = searchItem.split(",")
                                        searchItem = splitsearchItem[2]
                                        getCombinedItemsDetails(searchItem)
                                    }
                                })
                            })
                            

                        })
                        
      
                        $("#combinedselectgroup").on("change", function(evt){
                            evt.preventDefault()

                            let deptItemgroup = $("#combinedselectdepartmentitemgroup").val()
                            let getStockItemListByUsageGroup = "getStockItemListByUsageGroup"
                            let searchItem = $("#searchcombineditem").val()
                            let itemgroup = $("#combinedselectgroup").val()
                            //Get Item Class
                            // let itemgroup = $("#combinedselectgroup").val()
                            let getItemClassByItemGroup = "getItemClassByItemGroup"
                            $.post("controllers/combo-setup.php",{searchItem:itemgroup, getItemClassByItemGroup: getItemClassByItemGroup},function(formdata){
                                //get Item Codes
                                //console.log(formdata)
                                let data = JSON.parse(formdata)
                                let itemclassoptions = ``
                                $.each(data.records, function(key, val){
                                    itemclassoptions += `
                                        <option value="` + val.itemclass + `">` + val.itemclass + `</option>
                                    `
                                })
                                $("#combinedselectclass").html(itemclassoptions)
                                //Get Item Subclass
                                let itemclass = $("#combinedselectclass").val()
                                let getItemSubClassByClass = "getItemSubClassByClass"
                                $.post("controllers/combo-setup.php",{selectsubclassclass:itemclass, getItemSubClassByClass: getItemSubClassByClass},function(formdata){
                                    //get Item Codes
                                    //console.log(formdata)
                                    let data = JSON.parse(formdata)
                                    let itemsubclassoptions = ``
                                    $.each(data.records, function(key, val){
                                        itemsubclassoptions += `
                                            <option value="` + val.itemsubclass + `">` + val.itemsubclass + `</option>
                                        `
                                    })
                                    $("#combinedselectsubclass").html(itemsubclassoptions)
                                    
                                    
                                })
                            })
                            //console.log(searchItem)
                            $.post("controllers/combo-setup.php",{itemgroup:itemgroup, deptItemgroup:deptItemgroup, searchItem:searchItem,getStockItemListByUsageGroup: getStockItemListByUsageGroup},function(formdata){
                                ////console.log(data)
                                if(formdata=="No Record Found"){
                                    $("#combineditems").html("<option value='None'>No Items</option>")
                                }else{
                                    //console.log(formdata)
                                    //console.log(typeof(formdata))
                                    let data=JSON.parse(formdata)
                                    //console.log(data)
                                    let count = 0
                                        
                                    let genericnameoptions = ``
                                    $.each(data.records, function(key, val) {
                                        count++
                                        genericnameoptions += `
                                        <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                    `
                                    })
                                    // $("#stockitem-status").html(count + " Record(s) Found")
                                    $("#combineditems").html(genericnameoptions)
                                

                                    let searchItem = $("#combineditems").val()
                                    let splitsearchItem = searchItem.split(",")
                                    searchItem = splitsearchItem[2]
                                    getCombinedItemsDetails(searchItem)
                                }
        
                                
                                    
                                    
                                })
                        })

                            $("#combinedselectdepartmentitemgroup").on("change", function(evt){
                                evt.preventDefault()
                               

                                    // let deptItemgroup = $("#combinedselectdepartmentitemgroup").val()
                
                                    let deptItemgroup = $("#combinedselectdepartmentitemgroup").val()
                                    let getItemGroupByDeptItemGroup = "getItemGroupByDeptItemGroup"
                                    $.post("controllers/combo-setup.php",{departmentitemgroup:deptItemgroup, getItemGroupByDeptItemGroup: getItemGroupByDeptItemGroup},function(formdata){
                                        //get Item Codes
                                        //console.log(formdata)
                                        let data = JSON.parse(formdata)
                                        let itemgropoptions = ``
                                        $.each(data.records, function(key, val){
                                            itemgropoptions += `
                                                <option value="` + val.itemgroup + `">` + val.itemgroup + `</option>
                                            `
                                        })
                                        $("#combinedselectgroup").html(itemgropoptions)

                                        let getStockItemListByUsageGroup = "getStockItemListByUsageGroup"
                                        let searchItem = $("#searchcombineditem").val()
                                        let itemgroup = $("#combinedselectgroup").val()
                                        let getItemClassByItemGroup = "getItemClassByItemGroup"
                                        $.post("controllers/combo-setup.php",{searchItem:itemgroup, getItemClassByItemGroup: getItemClassByItemGroup},function(formdata){
                                            //get Item Codes
                                            //console.log(formdata)
                                            let data = JSON.parse(formdata)
                                            let itemclassoptions = ``
                                            $.each(data.records, function(key, val){
                                                itemclassoptions += `
                                                    <option value="` + val.itemclass + `">` + val.itemclass + `</option>
                                                `
                                            })
                                            $("#combinedselectclass").html(itemclassoptions)
                                            //Get Item Subclass
                                            let itemclass = $("#combinedselectclass").val()
                                            let getItemSubClassByClass = "getItemSubClassByClass"
                                            $.post("controllers/combo-setup.php",{selectsubclassclass:itemclass, getItemSubClassByClass: getItemSubClassByClass},function(formdata){
                                                //get Item Codes
                                                //console.log(formdata)
                                                let data = JSON.parse(formdata)
                                                let itemsubclassoptions = ``
                                                $.each(data.records, function(key, val){
                                                    itemsubclassoptions += `
                                                        <option value="` + val.itemsubclass + `">` + val.itemsubclass + `</option>
                                                    `
                                                })
                                                $("#combinedselectsubclass").html(itemsubclassoptions)
                                                //console.log(searchItem)
                                                itemgroup = $("#combinedselectsubclass").val()
                                                let getStockItemListByUsageSubClass = "getStockItemListByUsageSubClass"
                                                searchItem = $("#searchcombineditem").val()
                                                $.post("controllers/combo-setup.php",{itemgroup:itemgroup, deptItemgroup:deptItemgroup, searchItem:searchItem,getStockItemListByUsageSubClass: getStockItemListByUsageSubClass},function(formdata){
                                                    //console.log(itemgroup,deptItemgroup,searchItem)
                                                    if(formdata=="No Record Found"){
                                                        $("#combineditems").html("<option value='None'>No Items</option>")
                                                    }else{
                                                        //console.log(formdata)
                                                        //console.log(typeof(formdata))
                                                        let data=JSON.parse(formdata)
                                                        //console.log(data)
                                                        let count = 0
                                                            
                                                        let genericnameoptions = ``
                                                        $.each(data.records, function(key, val) {
                                                            count++
                                                            genericnameoptions += `
                                                            <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                                        `
                                                        })
                                                        // $("#stockitem-status").html(count + " Record(s) Found")
                                                        //console.log(genericnameoptions)
                                                        $("#combineditems").html(genericnameoptions)
                                                    
                                                        let searchItem = $("#combineditems").val()
                                                        let splitsearchItem = searchItem.split(",")
                                                        searchItem = splitsearchItem[2]
                                                        getCombinedItemsDetails(searchItem)
                                                    }
                            
                                                    
                                                        
                                                        
                                                    })
                                                
                                            })
                                        })
                                        
                                    })

                    
                            })

                            $("#combineditems").on("change", function(evt){
                                evt.preventDefault()
                                let getStockItemListDetailsById = "getStockItemListDetailsById"
                                    let searchItem = $("#combineditems").val()
                                    let splitsearchItem = searchItem.split(",")
                                    searchItem = splitsearchItem[2]
                                    $.post("controllers/combo-setup.php",{searchItem:searchItem,getStockItemListDetailsById:getStockItemListDetailsById},function(data){
                                        console.log(data)
                                        data = JSON.parse(data)
                                        $("#combinedstockitemid").val(data.id)
                                        $("#combineditemid").val(data.itemid)
                                        $("#combinedprice").val(data.sellingprice)
                                        $("#combinedunitstrength").val(data.sellingpriceperstrength)
                                        $("#combinedliquidunitstrength").val(data.sellingpriceperliquidstrength)
                                        $("#combinedlengthunitstrength").val(zeroifnull(data.sellingpriceperlength))
                                        $("#combinedserviceunitstrength").val(data.sellingprice)
                                        $("#combinedtotalpiece").val(data.totalpieces)
                                        $("#combinedtotalstrength").val(data.totalstrength)
                                        $("#combinedtotalliquidstrength").val(data.totalliquidstrength)
                                        let itemsstrength = `
                                            <option value="pieces,` + data.totalpieces + `">Pcs(` + data.totalpieces + `)</option>
                                            <option value="weight,` + data.totalstrength + `">Wgt(` + data.totalstrength + `)</option>
                                            <option value="volume,` + data.totalliquidstrength + `">Vol(` + data.totalliquidstrength + `)</option>
                                            <option value="length,` + zeroifnull(data.totallengthsthrength) + `">Len(` + zeroifnull(data.totallengthsthrength) + `)</option>
                                            <option value="service,` + data.totalpieces + `">Srv(` + data.totalpieces + `)</option>
                                        `
                                        $("#combineditemsstrength").html(itemsstrength)
                                        
                                        let totalpieces = data.totalpieces
                                        let totalstrength = data.totalstrength
                                        let unitstrength = totalstrength / totalpieces
                                        unitstrength = unitstrength.toFixed(0)
                                        // $("#combinedunitstrength").val(unitstrength)
                                        
                                        let itemform = data.itemform
                                        if(itemform.includes(",")){
                                            splititemform = itemform.split(",")
                                            itemform = splititemform[1]
                                        }
                                        $("#combineditemform").val(itemform)
                                        //Need the state

                                        let itemid = data.itemid
                                        let GetGenericNameDetails = "GetGenericNameDetails"
                                        $.post("controllers/combo-setup.php",{id:itemid,GetGenericNameDetails:GetGenericNameDetails},function(formdata){
                                            //console.log(formdata)
                                            let data = JSON.parse(formdata)
                                            $("#combineditemstate").val(data.itemstate)
                                            $("#combineddepartmentitemgroup").val(data.departmentitemgroup)
                                            
                                            
                  
                                        let itemstate = $("#combineditemstate").val()
                                            
                                            let price = 0
                                            let unitoptions = ``
                                            price = $("#combinedunitstrength").val()
                                            // $("#combinedprice").val(price)
                                            let quantity = zeroifnull($("#combinedquantity").val())
                                            let quantityprice = quantity * price
                                            quantityprice = quantityprice.toFixed(2)
                                            $("#combinedquantityprice").val(quantityprice)
                                                                               
                                            //default value for units is weight
                                            //get weight units
                                            let getItemWeightByDepartmentItemGrouping = "getItemWeightByDepartmentItemGrouping"
                                            let departmentitemgroup = $("#combineddepartmentitemgroup").val()
                                            $.post("controllers/combo-setup.php",{state:itemstate, searchItem:departmentitemgroup,getItemWeightByDepartmentItemGrouping:getItemWeightByDepartmentItemGrouping},function(formdata){
                                                let data = JSON.parse(formdata)
                                                let itemform = $("#combineditemform").val()
                                                unitoptions = `
                                                    <option value='Unit'>Unit</option>
                                                    <option value='` + itemform + `'>`+ itemform + `</option>
                                                `
                                                $.each(data.records, function(key, val) {
                                                    unitoptions += `
                                                    <option value='` + val.abbreviation + `'>`+ val.unit + `</option>
                                                    `
                                                });
                                                // $("#combineditemsunit").html(unitoptions + serviceunit)
                                            })
                                

                                                itemstate = $("#combineditemstate").val()
                                                price = 0
                                                
                                                price = $("#combinedliquidunitstrength").val()
                                                // $("#combinedprice").val(price)
                                                quantity = zeroifnull($("#combinedquantity").val())
                                                quantityprice = quantity * price
                                                quantityprice = quantityprice.toFixed(2)
                                                $("#combinedquantityprice").val(quantityprice)
                                                                                                                            
                                                //default value for units is weight
                                                //get weight units
                                                let getItemVolumeByDepartmentItemGrouping = "getItemVolumeByDepartmentItemGrouping"
                                                departmentitemgroup = $("#combineddepartmentitemgroup").val()
                                                $.post("controllers/combo-setup.php",{state:itemstate, searchItem:departmentitemgroup,getItemVolumeByDepartmentItemGrouping:getItemVolumeByDepartmentItemGrouping},function(formdata){
                                                    let data = JSON.parse(formdata)
                                                    let itemform = $("#combineditemform").val()
                                                    
                                                    $.each(data.records, function(key, val) {
                                                        unitoptions += `
                                                        <option value='` + val.abbreviation + `'>`+ val.unit + `</option>
                                                        `
                                                    });
                                                    // $("#combineditemsunit").html(unitoptions + serviceunit)
                                                })
                                                
                                        
                                                itemstate = $("#combineditemstate").val()
                                                price = 0
                                                
                                                price = $("#combinedprice").val()
                                                // $("#combinedprice").val(price)
                                                quantity = zeroifnull($("#combinedquantity").val())
                                                quantityprice = quantity * price
                                                quantityprice = quantityprice.toFixed(2)
                                                $("#combinedquantityprice").val(quantityprice) 
                                                
                                                
                                                //default value for units is weight
                                                //get weight units
                                                let getItemLengthByDepartmentItemGrouping = "getItemLengthByDepartmentItemGrouping"
                                                departmentitemgroup = $("#combineddepartmentitemgroup").val()
                                                $.post("controllers/combo-setup.php",{state:itemstate, searchItem:departmentitemgroup,getItemLengthByDepartmentItemGrouping:getItemLengthByDepartmentItemGrouping},function(formdata){
                                                    let data = JSON.parse(formdata)
                                                    console.log(data)
                                                    let itemform = $("#combineditemform").val()
                                                    
                                                    $.each(data.records, function(key, val) {
                                                        unitoptions += `
                                                        <option value='` + val.abbreviation + `'>`+ val.unit + `</option>
                                                        `
                                                    });
                                                    // $("#combineditemsunit").html(unitoptions + serviceunit)
                                                })
                                                
                                        
                                                itemstate = $("#combineditemstate").val()
                                                price = 0
                                                
                                                price = $("#combinedprice").val()
                                                // $("#combinedprice").val(price)
                                                quantity = zeroifnull($("#combinedquantity").val())
                                                quantityprice = quantity * price
                                                quantityprice = quantityprice.toFixed(2)
                                                $("#combinedquantityprice").val(quantityprice) 

                                                //default value for units is weight
                                                //get weight units
                                                let getItemServiceByDepartmentItemGrouping = "getItemServiceByDepartmentItemGrouping"
                                                departmentitemgroup = $("#combineddepartmentitemgroup").val()
                                                $.post("controllers/combo-setup.php",{state:itemstate, searchItem:departmentitemgroup,getItemServiceByDepartmentItemGrouping:getItemServiceByDepartmentItemGrouping},function(formdata){
                                                    let data = JSON.parse(formdata)
                                                    let itemform = $("#combineditemform").val()
                                                    
                                                    $.each(data.records, function(key, val) {
                                                        unitoptions += `
                                                        <option value='` + val.abbreviation + `'>`+ val.unit + `</option>
                                                        `
                                                    });
                                                    $("#combineditemsunit").html(unitoptions + serviceunit)
                                                })
                                        })
                                        
    
                                        
                                    })
                            })
                            let serviceunit = ""
                            $("#combineditemsunittype").on("change", function(evt){
                                evt.preventDefault()
                                
                                            let price = 0
                                            let unittype = $("#combineditemsunittype").val()
                                            if(unittype=="weight"){
                                                
                                               
                                                price = $("#combinedunitstrength").val()
                                                // $("#combinedprice").val(price)
                                                let quantity = zeroifnull($("#combinedquantity").val())
                                                let quantityprice = quantity * price
                                                quantityprice = quantityprice.toFixed(2)
                                                $("#combinedquantityprice").val(quantityprice)
                                                $("#combinedquantity").val($("#combinedtotalstrength").val())
                                            } else if(unittype=="volume"){
                                                price = $("#combinedliquidunitstrength").val()
                                                // $("#combinedprice").val(price)
                                                quantity = zeroifnull($("#combinedquantity").val())
                                                quantityprice = quantity * price
                                                quantityprice = quantityprice.toFixed(2)
                                                $("#combinedquantityprice").val(quantityprice)
                                                $("#combinedquantity").val($("#combinedtotalliquidstrength").val())
                                            } else if(unittype=="length"){
                                                price = $("#combinedlengthunitstrength").val()
                                                // $("#combinedprice").val(price)
                                                quantity = zeroifnull($("#combinedquantity").val())
                                                quantityprice = quantity * price
                                                quantityprice = quantityprice.toFixed(2)
                                                $("#combinedquantityprice").val(quantityprice)
                                                $("#combinedquantity").val($("#combinedtotallength").val())
                                            } else if(unittype=="service"){
                                                
                                               
                                                
                                                price = $("#combinedprice").val()
                                                // $("#combinedprice").val(price)
                                                quantity = zeroifnull($("#combinedquantity").val())
                                                quantityprice = quantity * price
                                                quantityprice = quantityprice.toFixed(2)
                                                $("#combinedquantityprice").val(quantityprice)
                                                $("#combinedquantity").val($("#combinedtotalpiece").val())
                                            }
                                            // let itemstate = $("#combineditemstate").val()
                                            // let unitoptions = ``
                                            
                                                                               
                                            // //default value for units is weight
                                            // //get weight units
                                            // let getItemWeightByDepartmentItemGrouping = "getItemWeightByDepartmentItemGrouping"
                                            // let departmentitemgroup = $("#combineddepartmentitemgroup").val()
                                            // $.post("controllers/combo-setup.php",{state:itemstate, searchItem:departmentitemgroup,getItemWeightByDepartmentItemGrouping:getItemWeightByDepartmentItemGrouping},function(formdata){
                                            //     let data = JSON.parse(formdata)
                                            //     let itemform = $("#combineditemform").val()
                                            //     unitoptions = `
                                            //         <option value='Unit'>Unit</option>
                                            //         <option value='` + itemform + `'>`+ itemform + `</option>
                                            //     `
                                            //     $.each(data.records, function(key, val) {
                                            //         unitoptions += `
                                            //         <option value='` + val.abbreviation + `'>`+ val.unit + `</option>
                                            //         `
                                            //     });
                                            //     // $("#combineditemsunit").html(unitoptions + serviceunit)
                                            // })
                                                   
                                   
                                                                                                                
                                            // //default value for units is weight
                                            // //get weight units
                                            // let getItemVolumeByDepartmentItemGrouping = "getItemVolumeByDepartmentItemGrouping"
                                            // departmentitemgroup = $("#combineddepartmentitemgroup").val()
                                            // console.log(itemstate,departmentitemgroup)
                                            // $.post("controllers/combo-setup.php",{state:itemstate, searchItem:departmentitemgroup,getItemVolumeByDepartmentItemGrouping:getItemVolumeByDepartmentItemGrouping},function(formdata){
                                            //     let data = JSON.parse(formdata)
                                            //     let itemform = $("#combineditemform").val()
                                                
                                            //     $.each(data.records, function(key, val) {
                                            //         unitoptions += `
                                            //         <option value='` + val.abbreviation + `'>`+ val.unit + `</option>
                                            //         `
                                            //     });
                                            //     // $("#combineditemsunit").html(unitoptions + serviceunit)
                                            // })
                                    
                                                                                                                                   
                                            // //default value for units is weight
                                            // //get weight units
                                            // let getItemServiceByDepartmentItemGrouping = "getItemServiceByDepartmentItemGrouping"
                                            // departmentitemgroup = $("#combineddepartmentitemgroup").val()
                                            // $.post("controllers/combo-setup.php",{state:itemstate, searchItem:departmentitemgroup,getItemServiceByDepartmentItemGrouping:getItemServiceByDepartmentItemGrouping},function(formdata){
                                            //     let data = JSON.parse(formdata)
                                            //     let itemform = $("#combineditemform").val()
                                                
                                            //     $.each(data.records, function(key, val) {
                                            //         unitoptions += `
                                            //         <option value='` + val.abbreviation + `'>`+ val.unit + `</option>
                                            //         `
                                            //     });
                                            //     $("#combineditemsunit").html(unitoptions + serviceunit)
                                            // })
                                
                            })

                            getCombinedItemsFunction()


            function getStockListItemInfo() {
                let stockitemid = $("#stockitemid").val()
                let getStockListItemInfo = "getStockListItemInfo"
                $.post("controllers/combo-setup.php",{stockitemid:stockitemid, getStockListItemInfo:getStockListItemInfo}, function(formdata){
                    //console.log(formdata)
                    if(formdata!="No Record Found"){
                        let data = JSON.parse(formdata)
                        $("#previousquantity").val(data.previousquantity)
                        $("#selectsupplier").html("<option value='" + data.suppliername + "'>" + data.suppliername + "</option>" + supplierlist)
                        $("#invoicenumber").val(data.invoicenumber)
                        $("#invoiceamount").val(data.invoiceamount)
                        $("#itemamount").val(data.itemamountinvoice)
                        $("#stockitemlistid").val(data.id)
                    } else {
                        $("#previousquantity").val("")
                        $("#selectsupplier").val("")
                        $("#invoicenumber").val("")
                        $("#invoiceamount").val("")
                        // $("#itemamount").val("")
                        $("#stockitemlistid").val("")
                    }
                })
            }

            function getStockItemPrice(){
                let stockitemid = $("#stockitemid").val()
                //console.log(stockitemid)
                // let organizationid = $("#organizationid").val()
                // let stocklistid = $("#stocklistid").val()
                let getStockItemPrice = "getStockItemPrice"
                $.post("controllers/combo-setup.php",{
                    stockitemid:stockitemid,
                    getStockItemPrice:getStockItemPrice
                },function(data){
                    //console.log(data)
                    if(data!="No Record Found"){
                        data = JSON.parse(data)
                        // $("#stockitemlistid").val(data.id)
                        $("#stocklistid").val(data.records[0].id)
                        let organizations = `<div class="form-group col-md-3" style="font-size:16px;">
                            
                            Supplier
                         </div>
                         <div class="form-group col-md-3" style="font-size:16px;">
                         
                             Total Pieces
                         </div>
                         <div class="form-group col-md-2" style="font-size:16px;">
                         
                             Unit Cost
                         </div>
                         <div class="form-group col-md-3" style="font-size:16px;">
                             Selling Price
                         </div>
                         <div class="form-group col-md-1" style="font-size:16px;">
                             Delete
                         </div>`
                        $.each(data.records, function(key, val) {
                            let unitpriceperpiece = parseFloat(val.unitpriceperpiece)
                            let sellingprice = parseFloat(val.sellingprice)
                            organizations += `

                            <div class="form-group col-md-3" style="font-size:16px;">
                            
                            <a href="#" data-id="` + val.id + `" style="" class="btn btn-outline-default take-btn stocklistitemname"><h3 style="color:blue;">` + val.suppliername + `</h3></a>
                         </div>
                         <div class="form-group col-md-3" style="font-size:16px;">
                         
                            ` + val.totalpieces + `
                         </div>
                         <div class="form-group col-md-2" style="font-size:16px;">
                         
                            ` + unitpriceperpiece.toFixed(2) + ` Naira
                         </div>
                         <div class="form-group col-md-3" style="font-size:16px;">
                            ` + sellingprice.toFixed(2) + ` Naira
                         </div></div>
                         <div class="form-group col-md-1" style="font-size:16px;">
                            <button type="submit" class="genric-btn danger delete-stockitemprice-button" data-id="` + val.id + `" style="font-size: 14px;border-radius: 8px;">Delete</button>  
                         </div></div>


                            `
                        })

                        $(".form-edit-stockitemprice").html(organizations)
                        ////console.log("Items ", organizations)

                    } else {
                        $(".form-edit-stockitemprice").html(data)
                    }


                    $(".delete-stockitemprice-button").on("click",function(evt){
                        evt.preventDefault()
                        let id = $(this).attr("data-id")
                        let deleteStockListItem = "deleteStockListItem"
                        $.post("controllers/combo-setup.php",{id:id, deleteStockListItem:deleteStockListItem},function(data){
                            $("#item-organization-status").html(data)
                            getDeleteStockItemPrice()
                        })
                       
                    })

                    $(".stocklistitemname").on("click",function(evt){
                        evt.preventDefault()
                        let id = $(this).attr("data-id")
                        //console.log(id)
                        let getStockItemPriceById = "getStockItemPriceById"
                        $.post("controllers/combo-setup.php",{id:id, getStockItemPriceById:getStockItemPriceById},function(data){
                            console.log(data)
                            data=JSON.parse(data)
                            $("#selectsupplier").html(`<option value="` + data.suppliername + `">` + data.suppliername + `</option>` + supplierlist)
                            $("#invoicenumber").val(data.invoicenumber)
                            $("#invoiceamount").val(data.invoiceamount)
                            $("#previousquantity").val(data.previousquantity)
                            $("#itemamount").val(data.itemamountinvoice)
                            $("#stocktype").html(`<option value="` + data.stocktype + `">` + data.stocktype + `</option>` + stocktypelist)
                            $("#stockitemid").val(data.stockitemid)
                            $("#stocklistid").val(data.id)
                            $("#itemstate").val(data.itemstate)
                            $("#itemid").val(data.itemid)

                            $("#serviceunit").val(data.serviceunit)
                            $("#totalduration").html(data.totalduration)
                            $("#totaldurationdays").html(data.totaldurationdays)
                            $("#unitpriceperservice").val(data.unitpriceperservice)
                            $("#servicecostperday").html(data.unitpriceperservice + " " + data.serviceunit)
                           

                            itempackage = data.package
                            if(itempackage!=""){
                                packagingvalue = JSON.parse(itempackage)
                            } else {
                                packagingvalue = [{"package":"","quantity":"","value":"","weight":"","volume":"","length":""}]
                            }
                           

                            let packaginglist = `<div class="form-group col-md-2" style="font-size:16px;">
                                    
                                    Package
                                    </div>
                                    <div class="form-group col-md-2" style="font-size:16px;">
                                    
                                        Qty
                                    </div>
                                    <div class="form-group col-md-2" style="font-size:16px;">
                                    
                                        Pieces
                                    </div>
                                    <div class="form-group col-md-1" style="font-size:16px;">
                                        Wgt
                                    </div>
                                    <div class="form-group col-md-1" style="font-size:16px;">
                                        Vol
                                    </div>
                                    <div class="form-group col-md-1" style="font-size:16px;">
                                Len
                            </div>
                            <div class="form-group col-md-2" style="font-size:16px;">
                                Srv
                            </div>
                            <div class="form-group col-md-1" style="font-size:16px;">
                                Del
                            </div>
                            </div>`
                            let itemnumber = 0
                                    packagingvalue.forEach(element => {
                                        packaginglist += `<div class="form-group col-md-2" style="font-size:18px;">` + element.package + `
                                        
                                        </div>
                                        <div class="form-group col-md-2" style="font-size:18px;">` + element.quantity + ` qty
                                        
                                        </div>
                                        <div class="form-group col-md-2" style="font-size:18px;">` + element.value + ` pieces
                                        
                                    </div>
                                    <div class="form-group col-md-1" style="font-size:18px;">` + element.weight + `
                                        
                                    </div>
                                    <div class="form-group col-md-1" style="font-size:18px;">` + element.volume + `
                                        
                                    </div>
                                    <div class="form-group col-md-1" style="font-size:18px;">` + element.length + `
                                        
                                    </div>
                                    <div class="form-group col-md-2" style="font-size:18px;">` + element.service + `
                        
                                     </div>
                                   
                                     <div class="form-group col-md-1" style="font-size:18px;"><a href="#" data-id="` + itemnumber + `" class="del-packaging-item"><i class="fa fa-trash-o"></i></a>
                        
                                    </div>
                                        `
                                        itemnumber += 1
                                    });
                                    $("#packagingvalue").html(packaginglist)
                                
                                let sellingprice = parseFloat(zeroifnull(data.sellingprice))
                                profit = parseFloat(zeroifnull(data.profit))
                                $("#totalpieces").html(zeroifnull(data.totalpieces))
                                $("#totalstrength").html(zeroifnull(data.totalstrength))
                                $("#totalliquidstrength").html(zeroifnull(data.totalliquidstrength))
                                $("#totallength").html(zeroifnull(data.totallengthstrength))
                                $("#totalstrengthmg").html(zeroifnull(data.totalstrengthmg))
                                $("#totalliquidstrengthml").html(zeroifnull(data.totalliquidstrengthml))
                                $("#totallengthcm").html(zeroifnull(data.totallengthstrengthcm))
                                $("#unitpricepieces").html(zeroifnull(data.unitpriceperpiece))
                                $("#unitpriceperpiece").val(zeroifnull(data.unitpriceperpiece))
                                $("#unitpriceperstrength").val(zeroifnull(data.unitpriceperstrength))
                                $("#unitpricestrength").html(zeroifnull(data.unitpriceperstrength))
                                $("#unitpriceliquidstrength").html(zeroifnull(data.unitpriceperliquidstrength))
                                $("#unitpricelength").html(zeroifnull(data.unitpriceperlength))
                                $("#unitpricelength").html(zeroifnull(data.unitpriceperlength))
                                $("#unitpriceperliquidstrength").val(zeroifnull(data.unitpriceperliquidstrength))
                                $("#unitpriceperlength").val(zeroifnull(data.unitpriceperlength))
                                $("#unitpricestrength").html(zeroifnull(data.unitpriceperstrength))
                                $("#markupprice").val(data.percentagemarkup)

                                unitpieceprice = zeroifnull(data.unitpriceperpiece)
                                unitstrengthprice = zeroifnull(data.unitpriceperstrength)
                                unitpriceperliquidstrength = zeroifnull(data.unitpriceperliquidstrength)
                                unitpriceperlength = zeroifnull(data.unitpriceperlength)
                                let unititemprice = parseFloat($("#unitpricepieces").text())
                                let unititemstrengthprice = parseFloat($("#unitpriceperstrength").val())
                                let unitliquidstrengthprice = parseFloat($("#unitpriceperliquidstrength").val())
                                let unitlengthprice = parseFloat($("#unitpriceperlength").val())
                                let unitserviceprice = parseFloat($("#unitpriceperservice").val())
                                let markupprice = parseFloat($("#markupprice").val())
                                let itemamount = parseFloat($("#itemamount").val())
                                //console.log(unititemprice,unititemstrengthprice,itemamount, markupprice)
                                sellingprice = ((markupprice/100) * unititemprice) + unititemprice
                                sellingpriceperstrength = ((markupprice/100) * unititemstrengthprice) + unititemstrengthprice
                                sellingpriceperliquidstrength = ((markupprice/100) * unitliquidstrengthprice) + unitliquidstrengthprice
                                sellingpriceperlength = ((markupprice/100) * unitlengthprice) + unitlengthprice
                                sellingpriceperservice = ((markupprice/100) * unitserviceprice) + unitserviceprice
                                profit = sellingprice - unititemprice
                                percentageprofit = (profit/unititemprice) * 100
                                
                                let sellingpricedetails = `

                                Selling Price Per Piece: ` + sellingprice.toFixed(2) + ` Naira<br>
                                Selling Price Per Weight: ` + sellingpriceperstrength.toFixed(2) + ` Naira<br>
                                Selling Price Per Volume: ` + sellingpriceperliquidstrength.toFixed(2) + ` Naira<br>
                                Selling Price Per Length: ` + sellingpriceperlength.toFixed(2) + ` Naira<br>
                                Selling Price Per Service: ` + sellingpriceperservice.toFixed(2) + ` Naira<br>
                                Profit(Per Item): ` + profit.toFixed(2) + ` Naira<br>
                                Percentage Profit: ` + percentageprofit + `%
                            `
                                $("#sellingprice").html(sellingpricedetails)
                                $("#clear-package-button").show()

                                $(".del-packaging-item").on("click", function(evt){
                                    evt.preventDefault()
                                    let id = $(this).attr("data-id")
                                
                                    let value = packagingvalue[id].value
                                    let weight = packagingvalue[id].weight   
                                    let volume = packagingvalue[id].volume 
                                    let length = packagingvalue[id].length   

                                    finalpieces = finalpieces - value
                                    let itemprice = $("#itemamount").val()

                                    unitpieceprice = itemprice/finalpieces
                                    $("#unitpricepieces").html(unitpieceprice.toFixed(2) + " Naira")
                                    $("#unitpriceperpiece").val(unitpieceprice)
                                    $("#totalpieces").html(finalpieces + " pieces")

                                    itemstrength = $("#itemstrengthvalue").text()
                                    itemstrengtharray = itemstrength.split(" ")
                                
                                    let itemweight = itemstrengtharray[0]
                                    let itemstate = $("itemstate").val()
                                    let itemvolume = 0
                                    let itemlength = itemstrengtharray[0]
                                    if(itemstate=="Liquid" || itemstate=="Solution"){
                                        let itemvolumestrength = itemstrengtharray[0].split("/")
                                        let itemvolumestrength1 = itemvolumestrength[1].split(" ")
                                        itemvolume = parseFloat(itemstrengtharray[4])
                                    }
                                    let splitweight = weight.split(" ")
                                    let splitvolume = volume.split(" ")
                                    let splitlength = length.split(" ")
                                    totalweight = splitweight[0]
                                    totalvolume = splitvolume[0]
                                    totallength = splitlength[0]
                                    finalweight = finalweight - totalweight
                                    finalvolume = finalvolume - totalvolume
                                    finallength = finallength - totallength
                                    unitstrengthprice = itemprice/finalweight
                                    $("#unitpricestrength").html(unitstrengthprice.toFixed(2) + " Naira")
                                    $("#unitpriceperstrength").val(unitstrengthprice)
                                    $("#totalstrength").html(finalweight + " " + itemweightunit)
                                    $("#totalliquidstrength").html(finalvolume + " " + itemvolumeunit)
                                    $("#totallength").html(finallength + " " + itemlengthunit)
                                    let totalstrength = totalweight.toString() + " " + itemweightunit
                                    
                                    packagingvalue.splice(id, 1)
                                    //console.log(packagingvalue)
                                    
                                    packagelistitems(packagingvalue)

                                })

                                })
                    })
                    getOrganizationPrice()

                    // let combinedpricing = data.records[0].combinedpricing
                    //console.log(data)

                    if(data!="No Record Found"){
                        let combinedpricing =  data.records[0].combinedpricing
                        if(combinedpricing!="" && combinedpricing!=null){
                            let totalprice = data.records[0].unitpriceperpiece
                            let markupprice = data.records[0].sellingprice
                            let combineditemmarkup = data.records[0].percentagemarkup
                            $("#markuppricecombined").val(combineditemmarkup)
                            let combinedmarkup = `
                                Total Price: ` + totalprice + ` Naira <br>
                                Markup Price: ` + markupprice + ` Naira <br>
                                Percentage Markup(Profit): ` + combineditemmarkup + `%
                            `
                            $("#computecombinedpricing").html(combinedmarkup)

                            combinedpricingvaluearray = JSON.parse(combinedpricing)
                            // combinedpricingvalue = combinedpricing
                            combinedpricinglistitems(combinedpricingvaluearray)
                            $("#save-combinedprice-button").hide()
                            $("#update-combinedprice-button").show()
                            $("#refresh-combinedprice-button").show()
                            $("#regiment-combinedprice-button").show()
                        } else{
                            $("#computecombinedpricing").html("")
                            $("#combinedpricevalue").html("")
                            $("#combinedpricetotalvalue").html("")
                            $("#markuppricecombined").val("1")
                            combinedpricingvaluearray = []
                            combinedpricevalue = []
                            $("#save-combinedprice-button").show()
                            $("#update-combinedprice-button").hide()
                            $("#refresh-combinedprice-button").hide()
                            $("#regiment-combinedprice-button").show()
                        }
                        
                    } else {
                        $("#computecombinedpricing").html("")
                        $("#combinedpricevalue").html("")
                        $("#combinedpricetotalvalue").html("")
                        $("#markuppricecombined").val("1")
                        combinedpricingvaluearray = []
                        combinedpricevalue = []
                        $("#save-combinedprice-button").show()
                        $("#update-combinedprice-button").hide()
                        $("#refresh-combinedprice-button").hide()
                        $("#regiment-combinedprice-button").show()
                    }
                })


            }

            let itemregimentarray = []

            function getitemregiment(){
                let getItemRegiment = "getItemRegiment"
                $.post("controllers/combo-setup.php",{getItemRegiment:getItemRegiment},function(data){
                    if(data!="No Record Found"){
                        // console.log(data)
                        let formdata = JSON.parse(data)
                        itemregimentarray = formdata.records
                        let itemregimentlist = `<option value="">Select Routine</option>`
                        formdata.records.forEach(val => {
                            itemregimentlist += `<option value="` + val.regimentname + `">` + val.regimentname + `</option>`
                        });
                        $("#itemregiments").html(itemregimentlist)

                        let regimentname = $("#itemregiments").val()
                        $("#itemregimentslist").html("")
                        itemregimentarray.forEach(val => {
                            if(regimentname == val.regimentname){
                                console.log(val.regiment)
                                let regimentlist = JSON.parse(val.regiment)
                                // combinedpricingvaluearray = regimentlist
                                let regimentlistitems = ``
                                
                                let count = 0
                                regimentlist.forEach(value => {
                                    combinedpricingvaluearray.push(value)
                                    regimentlistitems += `<option value="` + count + `,` + value.itemid + `">` + value.itemname + `</option>`
                                    count++
                                });
                                $("#itemregimentslist").html(regimentlistitems)
                            }
                        });

                    }
                })
            }

            $("#itemregiments").on("change", function(evt){
                evt.preventDefault()
                let itemname =$("#itemregiments").val()
                
                itemregimentarray.forEach(val => {
                    if(itemname==val.regimentname){
                       
                        console.log(val.regiment)
                        let regimentlist = JSON.parse(val.regiment)
                        // combinedpricingvaluearray = regimentlist
                        // combinedpricingvaluearray = []
                        let regimentlistitems = ``
                        let count = 0
                        regimentlist.forEach(value => {
                            // combinedpricingvaluearray.push(value)
                            regimentlistitems += `<option value="` + count + `,` + value.itemid + `">` + value.itemname + `</option>`
                            count++
                        });
                        $("#itemregimentslist").html(regimentlistitems)
                       
                        // console.log(val.regiment)
                        // let combinedpricingvalue = JSON.parse(val.regiment)
                        // combinedpricinglistitems(combinedpricingvalue)
                    }
                    
                });
            })

            $("#add-itemregiment-button").on("click", function(evt){
                evt.preventDefault()
                let itemname =$("#itemregiments").val()
                
                itemregimentarray.forEach(val => {
                    if(itemname==val.regimentname){
                        let regimentlist = JSON.parse(val.regiment)
                        // combinedpricingvaluearray = regimentlist
                        // combinedpricingvaluearray = []
                        let regimentlistitems = ``
                        let count = 0
                        regimentlist.forEach(value => {
                            combinedpricingvaluearray.push(value)
                        })
                        
                        combinedpricinglistitems(combinedpricingvaluearray)
                        
                    }
                    
                });
            })

        //     $("#add-itemregiment-button").on("click", function(evt){
        //         evt.preventDefault()
        //         let itemname =$("#itemregiments").val()
        //         
        //         itemregimentarray.forEach(val => {
        //             if(itemname==val.regimentname){
        //                 // console.log(val.regiment)
        //                 let combinedpricingvalue = JSON.parse(val.regiment)
        //                 combinedpricinglistitems(combinedpricingvalue)
        //             }
        //             
        //         });
        //    
        //     })

            $("#itemregimentslist").on("change", function(evt){
                evt.preventDefault()
                let itemname =$("#itemregiments").val()
                
                itemregimentarray.forEach(val => {
                    if(itemname==val.regimentname){
                        let regiment = JSON.parse(val.regiment)
                        // console.log(regiment)

                        let itemid = $("#itemregimentslist").val()
                        let splititemid = itemid.split(",")
                        itemid = parseFloat(splititemid[1])
                        let count = parseFloat(splititemid[0])
                       
                        console.log(regiment[count])
                                
                                getCombinedItemsDetails(regiment[count].stockitemlistid)

                                let getStockItemDetailsByItemId = "getStockItemDetailsByItemId"
                                // let itemname = "Select Item"
                                $.post("controllers/combo-setup.php",{searchItem:itemid,getStockItemDetailsByItemId:getStockItemDetailsByItemId},function(formdata){
                                    let data = JSON.parse(formdata)
                                    console.log(data)
                                    itemname = regiment[count].itemname
                                    let pieces = $("#combinedtotalpiece").val()
                                    //itemname = $("#combineditems").text()
                                    let unitprice = regiment[count].unitprice
                                    let unittype =  regiment[count].combineditemsunittype
                                    
                                    let unitstrength = regiment[count].unitstrength
                                    let unitliquidstrength = regiment[count].unitliquidstrength
                                    let unitlengthstrength = regiment[count].unitlengthprice
                                    let unit = regiment[count].unit
                                    unit = unit.toUpperCase()
                                    let itemquantity = regiment[count].itemquantity
                                    let splititemquantity = itemquantity.split(" ")
                                    itemquantity = parseFloat(splititemquantity[0])
                                    let itemquantityprice = regiment[count].itemquantityprice
                                    // let pieces = $("#pieces").val()
                                    let totalprice = unitprice * itemquantity

                                    let combineditemsstrengthvalue = regiment[count].combineditemsstrength
                                    let splitcombineditemstrength = combineditemsstrengthvalue.split(",")

                                    let totalpieces = parseFloat(splitcombineditemstrength[1])
                                    let totalstrength = parseFloat(splitcombineditemstrength[1])
                                    let totalliquidstrength = parseFloat(splitcombineditemstrength[1])
                                    let totallengthstrength = parseFloat(splitcombineditemstrength[1])

                                    let combinedquantity = oneifnull($("#combinedquantity").val())
                                    let partcombinedquantity = oneifnull($("#partcombinedquantity").val())

                                    let computequantity = regiment[count].computequantity
                                    let combineditemsstrength = regiment[count].combineditemsstrength

                                    let splitcombineditemstrengthvalue = combineditemsstrength.split("(")
                                    combineditemsstrength = splitcombineditemstrengthvalue[0]


                                    let combineditemsunittype = regiment[count].combineditemsunittype
                                    console.log(totalpieces, totalstrength,totalliquidstrength, totallengthstrength)
                                    if(combineditemsunittype=="weight"){
                                        if(unit=="G"){
                                            //do nothing
                                        } else {
                                            totalstrength = parseFloat(totalstrength) * 1000
                                        }
                                        totalstrength = parseFloat(totalstrength)/parseFloat(pieces)
                                        itemquantity = itemquantity * totalstrength
                                    } else if(combineditemsunittype=="volume"){
                                        if(unit=="L"){
                                            //do nothing
                                        } else {
                                            totalliquidstrength = parseFloat(totalliquidstrength) * 1000
                                        }
                                        totalliquidstrength = parseFloat(totalliquidstrength)/parseFloat(pieces)
                                        itemquantity = itemquantity * totalliquidstrength
                                    } else if(combineditemsunittype=="length"){
                                        if(unit=="M"){
                                            //do nothing
                                        } else {
                                            totallengthstrength = parseFloat(totallengthstrength) * 100
                                        }
                                        totallengthstrength = parseFloat(totallengthstrength)/parseFloat(pieces)
                                        itemquantity = itemquantity * totallengthstrength
                                    } else {
                                        itemquantity = itemquantity //* totalpieces
                                    }
                                    
                                    
                                    let itemunit = unitstrength + "(WGT), " + unitliquidstrength + " (VOL), " + unitlengthstrength + " (LEN)"
                                    itemquantity = itemquantity + " " + unit
                                    let stockitemlistid = parseInt(regiment[count].stockitemlistid)
                                    let combinedpricing = {
                                        itemid: itemid,
                                        stockitemlistid:stockitemlistid,
                                        itemname: itemname,
                                        itemunit: itemunit,
                                        unit:unit,
                                        unitprice: unitprice,
                                        itemquantity: regiment[count].itemquantity,
                                        itemquantityprice:itemquantityprice,
                                        unitstrength: unitstrength,
                                        unitliquidstrength: unitliquidstrength,
                                        unitlengthstrength: unitlengthstrength,
                                        totalprice: totalprice,
                                        computequantity:computequantity,
                                        combineditemsstrength:combineditemsstrength,
                                        combineditemsunittype:combineditemsunittype,
                                        combinedquantity:regiment[count].combinedquantity,
                                        partcombinedquantity:regiment[count].partcombinedquantity,
                                        quantitycombinedquantity:regiment[count].quantitycombinedquantity
                                    }
                                    console.log(combinedpricingvaluearray)
                                    combinedpricingvaluearray.push(combinedpricing)
                                    console.log(combinedpricingvaluearray)

                                    let combinedpricinglist = `<div class="form-group col-md-2" style="font-size:14px;font-weight:bolder;">
                                            
                                            Item
                                            </div>
                                          
                                            <div class="form-group col-md-1" style="font-size:14px;font-weight:bolder;">
                                
                                                Type of Unit
                                            </div>
                                            <div class="form-group col-md-1" style="font-size:14px;font-weight:bolder;">
                                            
                                                Unit
                                            </div>
                                            <div class="form-group col-md-2" style="font-size:14px;font-weight:bolder;">
                                                Whole Qty
                                            </div>
                                            <div class="form-group col-md-2" style="font-size:14px;font-weight:bolder;">
                                                Unit Qty Used
                                            </div>
                                            <div class="form-group col-md-1" style="font-size:14px;font-weight:bolder;">
                                                Parts of Whole
                                            </div>
                                            <div class="form-group col-md-2" style="font-size:14px;font-weight:bolder;">
                                                Qty Price
                                            </div>
                                            
                                            <div class="form-group col-md-1" style="font-size:16px;font-weight:bolder;">
                                                Action
                                            </div></div>`
                                            let itemnumber = 0
                                            let totalitemsprice = 0
                                            combinedpricingvaluearray.forEach(element => {
                                                let itemid = element.itemid
                                                let getStockListByItemId = "getStockListByItemId"


                                                // totalitemsprice += parseFloat(element.totalprice)
                                                let itemstrength = element.combineditemsstrength
                                                $.post("controllers/combo-setup.php", {itemid:itemid,getStockListByItemId:getStockListByItemId}, function(formdata){

                                                        
                                                        let data = JSON.parse(formdata)
                                                        console.log(data)
                                                        let unitprice = 0

                                                        let itemstrength = element.combineditemsstrength
                                                        let quantity = element.computequantity
                                                        //Pcs
                                                        if(itemstrength=="Pcs"){
                                                            unitprice = parseFloat(data.unitpriceperpiece)
                                                        }
                                                        //Wgt
                                                        if(itemstrength=="Wgt"){
                                                            unitprice = parseFloat(data.unitpriceperstrength)
                                                        }
                                                        //Vol
                                                        if(itemstrength=="Vol"){
                                                            unitprice = parseFloat(data.unitpriceperliquidstrength)
                                                        }
                                                        //Len
                                                        if(itemstrength=="Len"){
                                                            unitprice = parseFloat(data.unitpriceperlength)
                                                        }

                                                        totalprice = parseFloat(element.totalprice)

                                                        totalitemsprice += parseFloat(totalprice)
                                                        totalcombinedprice = totalitemsprice

                                                        combinedpricinglist += `<div class="form-group col-md-2" style="font-size:18px;">` + element.itemname + `
                                                
                                                            </div>
                                                            <div class="form-group col-md-1" style="font-size:15px;">` + element.combineditemsunittype + `
                                                
                                                                </div>
                                                                <div class="form-group col-md-1" style="font-size:15px;">` + element.unit + `
                                                                
                                                            </div>
                                                            <div class="form-group col-md-2" style="font-size:15px;">` + element.combinedquantity + ` ` + element.unit + `
                                                                
                                                            </div>
                                                            <div class="form-group col-md-2" style="font-size:15px;">` + element.itemquantity + `
                                                                
                                                            </div>
                                                            <div class="form-group col-md-1" style="font-size:15px;">` + element.partcombinedquantity + ` parts
                                                                
                                                            </div>
                                                            <div class="form-group col-md-2" style="font-size:15px;">&#8358;` + element.totalprice.toFixed(2) + `
                                                                
                                                            </div>

                                                        <div class="form-group col-md-1" style="font-size:18px;"><a href="#" data-id="` + element.itemid + `" class="del-combinedpricing-item" title="Delete Item"><i class="fa fa-trash-o"></i></a>
                                                            <a href="#" data-id="` + element.itemid + `" class="addroutine-combinedpricing-item" title="Add Item to Routine"><i class="fa fa-plus"></i></a>
                                                            
                                                        </div>
                                                    
                                                            `
                                                            itemnumber += 1
                                                            $("#combinedpricevalue").html(combinedpricinglist)
                                                            $("#combinedpricetotalvalue").html(`<div class="form-group col-md-12" style="font-size:18px;">Total = ` + totalitemsprice.toFixed(2) + ` Naira</div>`)

                                                            $(".addroutine-combinedpricing-item").on("click", function(evt){
                                                                evt.preventDefault()
                                                                console.log(combinedpricingvaluearray)
                                                                console.log(itemregimentarray)

                                                                let itemid = $(this).attr("data-id")
                                                                console.log(itemid)

                                                                // combinedpricingvaluearray.splice(id, 1)
                                                                //console.log(packagingvalue)

                                                                for(i=0;i<combinedpricingvaluearray.length;i++){
                                                                    if(itemid==combinedpricingvaluearray[i].itemid){
                                                                        let itemregiment = $("#itemregiments").val()
                                                                        let regimentcount = 0
                                                                        itemregimentarray.forEach(val => {

                                                                            if(val.regimentname == itemregiment){
                                                                                let regiment = JSON.parse(val.regiment)
                                                                                regiment.push(combinedpricingvaluearray[i])

                                                                                console.log(regiment)

                                                                                let newregimentarray = JSON.stringify(regiment)
                                                                                itemregimentarray[regimentcount].regiment = newregimentarray
                                                                                let regimentid = val.id
                                                                                let editItemRegiment_Regiment = "editItemRegiment_Regiment"
                                                                                $.post("controllers/combo-setup.php",{editItemRegiment_Regiment:editItemRegiment_Regiment,regimentid:regimentid,regiment:newregimentarray},function(data){
                                                                                    $("#itemregimentinfo").html(data)

                                                                                    let regimentname = $("#itemregiments").val()
                                                                                
                                                                                    itemregimentarray.forEach(val => {
                                                                                        if(regimentname == val.regimentname){
                                                                                            console.log(val.regiment)
                                                                                            let regimentlist = JSON.parse(val.regiment)
                                                                                            // combinedpricingvaluearray = regimentlist
                                                                                            let regimentlistitems = ``
                                                                                            let count = 0
                                                                                            regimentlist.forEach(value => {
                                                                                                // combinedpricingvaluearray.push(value)
                                                                                                regimentlistitems += `<option value="` + count + `,` + value.itemid + `">` + value.itemname + `</option>`
                                                                                                count++
                                                                                            });
                                                                                            $("#itemregimentslist").html(regimentlistitems)
                                                                                        }
                                                                                    });
                                                                                })
                                                                            }
                                                                            regimentcount++
                                                                        })
                                                                        
                                                                    }
                                                                }


                                                            })
                                                            
                                                            $(".del-combinedpricing-item").on("click", function(evt){
                                                                evt.preventDefault()
                                                                let itemid = $(this).attr("data-id")
                                                                console.log(itemid)

                                                                // combinedpricingvaluearray.splice(id, 1)
                                                                //console.log(packagingvalue)

                                                                for(i=0;i<combinedpricingvaluearray.length;i++){
                                                                    if(itemid==combinedpricingvaluearray[i].itemid){
                                                                        console.log(combinedpricingvaluearray[i].itemname," found")
                                                                        combinedpricingvaluearray.splice(i, 1)
                                                                    }
                                                                }
                                                                
                                                                combinedpricinglistitems(combinedpricingvaluearray)

                                                            })

                                                            $(".edit-combinedpricing-item").on("click", function(evt){
                                                                evt.preventDefault()
                                                                let itemid = $(this).attr("data-id")
                                                                for(i=0;i<combinedpricingvaluearray.length;i++){
                                                                    if(itemid==combinedpricingvaluearray[i].itemid){
                                                                        console.log(combinedpricingvaluearray[i].itemname," found")
                                                                        $("#edit-combineditem-button").show()
                                                                        $("#add-combineditem-button").hide()
                                                                    }
                                                                }
                                                            })

                                                            
                                                        });
                                                        
                                                })

                                                // combinedpricinglist +=  `<div class="form-group col-md-12" style="font-size:18px;">Total = ` + totalitemsprice.toFixed(2) + ` Naira</div>`
                                                
                                    
                                    
                                    $(".markupitem").on('change paste', function () {
                                        let markup = $(this).val()

                                        let id = $(this).attr("data-id")
                                    
                                        console.log(id)
                                        

                                    })



                            })

                            
                    }
                })
            })

            $("#add-selectitemregiment-button").on("click", function(evt){
                evt.preventDefault()
                let itemname =$("#itemregiments").val()
                
                itemregimentarray.forEach(val => {
                    if(itemname==val.regimentname){
                        let regiment = JSON.parse(val.regiment)
                        console.log(regiment)

                        let itemid = $("#itemregimentslist").val()
                        regiment.forEach(value => {
                            if(itemid==value.itemid){

                                console.log(value)
                                getCombinedItemsDetails(value.stockitemlistid)

                                let getStockItemDetailsByItemId = "getStockItemDetailsByItemId"
                                // let itemname = "Select Item"
                                $.post("controllers/combo-setup.php",{searchItem:itemid,getStockItemDetailsByItemId:getStockItemDetailsByItemId},function(formdata){
                                    let data = JSON.parse(formdata)
                                    console.log(data)
                                    itemname = value.itemname
                                    let pieces = $("#combinedtotalpiece").val()
                                    //itemname = $("#combineditems").text()
                                    let unitprice = value.unitprice
                                    let unittype =  value.combineditemsunittype
                                    
                                    let unitstrength = value.unitstrength
                                    let unitliquidstrength = value.unitliquidstrength
                                    let unitlengthstrength = value.unitlengthprice
                                    let unit = value.unit
                                    unit = unit.toUpperCase()
                                    let itemquantity = value.itemquantity
                                    let splititemquantity = itemquantity.split(" ")
                                    itemquantity = parseFloat(splititemquantity[0])
                                    let itemquantityprice = value.itemquantityprice
                                    // let pieces = $("#pieces").val()
                                    let totalprice = unitprice * itemquantity

                                    let combineditemsstrengthvalue = value.combineditemsstrength
                                    let splitcombineditemstrength = combineditemsstrengthvalue.split(",")

                                    let totalpieces = parseFloat(splitcombineditemstrength[1])
                                    let totalstrength = parseFloat(splitcombineditemstrength[1])
                                    let totalliquidstrength = parseFloat(splitcombineditemstrength[1])
                                    let totallengthstrength = parseFloat(splitcombineditemstrength[1])

                                    let combinedquantity = oneifnull($("#combinedquantity").val())
                                    let partcombinedquantity = oneifnull($("#partcombinedquantity").val())

                                    let computequantity = value.computequantity
                                    let combineditemsstrength = value.combineditemsstrength

                                    let splitcombineditemstrengthvalue = combineditemsstrength.split("(")
                                    combineditemsstrength = splitcombineditemstrengthvalue[0]


                                    let combineditemsunittype = value.combineditemsunittype
                                    console.log(totalpieces, totalstrength,totalliquidstrength, totallengthstrength)
                                    if(combineditemsunittype=="weight"){
                                        if(unit=="G"){
                                            //do nothing
                                        } else {
                                            totalstrength = parseFloat(totalstrength) * 1000
                                        }
                                        totalstrength = parseFloat(totalstrength)/parseFloat(pieces)
                                        itemquantity = itemquantity * totalstrength
                                    } else if(combineditemsunittype=="volume"){
                                        if(unit=="L"){
                                            //do nothing
                                        } else {
                                            totalliquidstrength = parseFloat(totalliquidstrength) * 1000
                                        }
                                        totalliquidstrength = parseFloat(totalliquidstrength)/parseFloat(pieces)
                                        itemquantity = itemquantity * totalliquidstrength
                                    } else if(combineditemsunittype=="length"){
                                        if(unit=="M"){
                                            //do nothing
                                        } else {
                                            totallengthstrength = parseFloat(totallengthstrength) * 100
                                        }
                                        totallengthstrength = parseFloat(totallengthstrength)/parseFloat(pieces)
                                        itemquantity = itemquantity * totallengthstrength
                                    } else {
                                        itemquantity = itemquantity //* totalpieces
                                    }
                                    
                                    
                                    let itemunit = unitstrength + "(WGT), " + unitliquidstrength + " (VOL), " + unitlengthstrength + " (LEN)"
                                    itemquantity = itemquantity + " " + unit
                                    let stockitemlistid = parseInt(value.stockitemlistid)
                                    let combinedpricing = {
                                        itemid: itemid,
                                        stockitemlistid:stockitemlistid,
                                        itemname: itemname,
                                        itemunit: itemunit,
                                        unit:unit,
                                        unitprice: unitprice,
                                        itemquantity: itemquantity,
                                        itemquantityprice:itemquantityprice,
                                        unitstrength: unitstrength,
                                        unitliquidstrength: unitliquidstrength,
                                        unitlengthstrength: unitlengthstrength,
                                        totalprice: totalprice,
                                        computequantity:computequantity,
                                        combineditemsstrength:combineditemsstrength,
                                        combineditemsunittype:combineditemsunittype
                                    }
                                    combinedpricingvaluearray.push(combinedpricing)
                                    console.log(combinedpricingvaluearray)

                                    let combinedpricinglist = `<div class="form-group col-md-2" style="font-size:14px;font-weight:bolder;">
                                            
                                            Item
                                            </div>
                                            <div class="form-group col-md-1" style="font-size:14px;font-weight:bolder;">
                                
                                                Type of Unit
                                            </div>
                                            <div class="form-group col-md-1" style="font-size:14px;font-weight:bolder;">
                                            
                                                Unit
                                            </div>
                                            <div class="form-group col-md-2" style="font-size:14px;font-weight:bolder;">
                                                Whole Qty
                                            </div>
                                            <div class="form-group col-md-2" style="font-size:14px;font-weight:bolder;">
                                                Unit Qty Used
                                            </div>
                                            <div class="form-group col-md-1" style="font-size:14px;font-weight:bolder;">
                                                Parts of Whole
                                            </div>
                                            <div class="form-group col-md-2" style="font-size:14px;font-weight:bolder;">
                                                Qty Price
                                            </div>
                                            
                                            <div class="form-group col-md-1" style="font-size:16px;">
                                                Action
                                            </div></div>`
                                            let itemnumber = 0
                                            let totalitemsprice = 0
                                            combinedpricingvaluearray.forEach(element => {
                                                let itemid = element.itemid
                                                let getStockListByItemId = "getStockListByItemId"


                                                // totalitemsprice += parseFloat(element.totalprice)
                                                let itemstrength = element.combineditemsstrength
                                                $.post("controllers/combo-setup.php", {itemid:itemid,getStockListByItemId:getStockListByItemId}, function(formdata){

                                                        
                                                        let data = JSON.parse(formdata)
                                                        console.log(data)
                                                        let unitprice = 0

                                                        let itemstrength = element.combineditemsstrength
                                                        let quantity = element.computequantity
                                                        //Pcs
                                                        if(itemstrength=="Pcs"){
                                                            unitprice = parseFloat(data.unitpriceperpiece)
                                                        }
                                                        //Wgt
                                                        if(itemstrength=="Wgt"){
                                                            unitprice = parseFloat(data.unitpriceperstrength)
                                                        }
                                                        //Vol
                                                        if(itemstrength=="Vol"){
                                                            unitprice = parseFloat(data.unitpriceperliquidstrength)
                                                        }
                                                        //Len
                                                        if(itemstrength=="Len"){
                                                            unitprice = parseFloat(data.unitpriceperlength)
                                                        }

                                                        totalprice = parseFloat(element.totalprice)

                                                        totalitemsprice += parseFloat(totalprice)
                                                        totalcombinedprice = totalitemsprice

                                                        combinedpricinglist += `<div class="form-group col-md-2" style="font-size:18px;">` + element.itemname + `
                                                
                                                            </div>
                                                            <div class="form-group col-md-1" style="font-size:15px;">` + element.combineditemsunittype + `
                                                
                                                                </div>
                                                                <div class="form-group col-md-1" style="font-size:15px;">` + element.unit + `
                                                                
                                                            </div>
                                                            <div class="form-group col-md-2" style="font-size:15px;">` + element.combinedquantity + ` ` + element.unit + `
                                                                
                                                            </div>
                                                            <div class="form-group col-md-2" style="font-size:15px;">` + element.itemquantity + `
                                                                
                                                            </div>
                                                            <div class="form-group col-md-1" style="font-size:15px;">` + element.partcombinedquantity + ` parts
                                                                
                                                            </div>
                                                            <div class="form-group col-md-2" style="font-size:15px;">&#8358;` + element.totalprice.toFixed(2) + `
                                                                
                                                            </div>

                                                        <div class="form-group col-md-1" style="font-size:18px;"><a href="#" data-id="` + element.itemid + `" class="del-combinedpricing-item"  title="Delete Item><i class="fa fa-trash-o"></i></a>
                                                            <a href="#" data-id="` + element.itemid + `" class="addroutine-combinedpricing-item"  title="Add Item to Routine"><i class="fa fa-plus"></i></a>
                                                            
                                                        </div>
                                                    
                                                            `
                                                            itemnumber += 1
                                                            $("#combinedpricevalue").html(combinedpricinglist)
                                                            $("#combinedpricetotalvalue").html(`<div class="form-group col-md-12" style="font-size:18px;">Total = ` + totalitemsprice.toFixed(2) + ` Naira</div>`)
                                                            
                                                            $(".addroutine-combinedpricing-item").on("click", function(evt){
                                                                evt.preventDefault()
                                                                console.log(combinedpricingvaluearray)
                                                                console.log(itemregimentarray)

                                                                let itemid = $(this).attr("data-id")
                                                                console.log(itemid)

                                                                // combinedpricingvaluearray.splice(id, 1)
                                                                //console.log(packagingvalue)

                                                                for(i=0;i<combinedpricingvaluearray.length;i++){
                                                                    if(itemid==combinedpricingvaluearray[i].itemid){
                                                                        let itemregiment = $("#itemregiments").val()
                                                                        let regimentcount = 0
                                                                        itemregimentarray.forEach(val => {

                                                                            if(val.regimentname == itemregiment){
                                                                                let regiment = JSON.parse(val.regiment)
                                                                                regiment.push(combinedpricingvaluearray[i])

                                                                                console.log(regiment)

                                                                                let newregimentarray = JSON.stringify(regiment)
                                                                                itemregimentarray[regimentcount].regiment = newregimentarray
                                                                                let regimentid = val.id
                                                                                let editItemRegiment_Regiment = "editItemRegiment_Regiment"
                                                                                $.post("controllers/combo-setup.php",{editItemRegiment_Regiment:editItemRegiment_Regiment,regimentid:regimentid,regiment:newregimentarray},function(data){
                                                                                    $("#itemregimentinfo").html(data)

                                                                                    let regimentname = $("#itemregiments").val()
                                                                                
                                                                                    itemregimentarray.forEach(val => {
                                                                                        if(regimentname == val.regimentname){
                                                                                            console.log(val.regiment)
                                                                                            let regimentlist = JSON.parse(val.regiment)
                                                                                            // combinedpricingvaluearray = regimentlist
                                                                                            let regimentlistitems = ``
                                                                                            let count = 0
                                                                                            regimentlist.forEach(value => {
                                                                                                // combinedpricingvaluearray.push(value)
                                                                                                regimentlistitems += `<option value="` + count + `,` + value.itemid + `">` + value.itemname + `</option>`
                                                                                                count++
                                                                                            });
                                                                                            $("#itemregimentslist").html(regimentlistitems)
                                                                                        }
                                                                                    });
                                                                                })
                                                                            }
                                                                            regimentcount++
                                                                        })

                                                                    }
                                                                }


                                                            })

                                                            $(".del-combinedpricing-item").on("click", function(evt){
                                                                evt.preventDefault()
                                                                let itemid = $(this).attr("data-id")
                                                                console.log(itemid)

                                                                // combinedpricingvaluearray.splice(id, 1)
                                                                //console.log(packagingvalue)

                                                                for(i=0;i<combinedpricingvaluearray.length;i++){
                                                                    if(itemid==combinedpricingvaluearray[i].itemid){
                                                                        console.log(combinedpricingvaluearray[i].itemname," found")
                                                                        combinedpricingvaluearray.splice(i, 1)
                                                                    }
                                                                }
                                                                
                                                                combinedpricinglistitems(combinedpricingvaluearray)

                                                            })

                                                            $(".edit-combinedpricing-item").on("click", function(evt){
                                                                evt.preventDefault()
                                                                let itemid = $(this).attr("data-id")
                                                                for(i=0;i<combinedpricingvaluearray.length;i++){
                                                                    if(itemid==combinedpricingvaluearray[i].itemid){
                                                                        console.log(combinedpricingvaluearray[i].itemname," found")
                                                                        $("#edit-combineditem-button").show()
                                                                        $("#add-combineditem-button").hide()
                                                                    }
                                                                }
                                                            })

                                                            
                                                        });
                                                        
                                                })

                                                // combinedpricinglist +=  `<div class="form-group col-md-12" style="font-size:18px;">Total = ` + totalitemsprice.toFixed(2) + ` Naira</div>`
                                                
                                    
                                    
                                    $(".markupitem").on('change paste', function () {
                                        let markup = $(this).val()

                                        let id = $(this).attr("data-id")
                                    
                                        console.log(id)
                                        

                                    })



                            })

                            }
                        });
                    }
                })
               
                
            })

//             $("#delete-itemregiment-button").on("click", function(evt){
//                 evt.preventDefault()
//                 let itemname =$("#itemregiments").val()
//                 let deleteItemRegiment = "deleteItemRegiment"
//                 $.post("controllers/combo-setup.php",{itemname:itemname,deleteItemRegiment:deleteItemRegiment},function(data){
//                     $("#itemregimentinfo").html(data)
//                     getitemregiment()
//                 })
// 
//             })
            $("#clear-itemregiment-button").on("click", function(evt){
                evt.preventDefault()
                $("#combinedpricevalue").html("")
                $("#combinedpricetotalvalue").html("")
                combinedpricingvaluearray = []

            })


            getitemregiment()

            function getDeleteStockItemPrice(){
                getStockItemPrice()
            }

            function getDeleteOrganizationPrice(){
                getOrganizationPrice()

            }

            function getOrganizationPrice(){
                let stockitemid = $("#stockitemid").val()
                let organizationid = $("#organizationid").val()
                let stocklistid = $("#stocklistid").val()
                let getOrganizationPrice = "getOrganizationPrice"
                $.post("controllers/combo-setup.php",{
                    stockitemid:stockitemid,
                    getOrganizationPrice:getOrganizationPrice
                },function(data){
                    ////console.log(data)
                    if(data!="No Record Found"){
                        //console.log(data)
                        data = JSON.parse(data)
                        let organizations = `<div class="form-group col-md-3" style="font-size:16px;font-style:bold;">
                            
                            Organization
                         </div>
                         <div class="form-group col-md-3" style="font-size:16px;font-style:bold;">
                         
                             Item
                         </div>
                         <div class="form-group col-md-2" style="font-size:16px;font-style:bold;">
                         
                             Price
                         </div>
                         <div class="form-group col-md-3" style="font-size:16px;font-style:bold;">
                             Discount
                         </div></div>
                         <div class="form-group col-md-1" style="font-size:16px;font-style:bold;">
                             Delete
                         </div></div>`
                        $.each(data.records, function(key, val) {
                            let price = parseFloat(val.price)
                            organizations += `

                            <div class="form-group col-md-3" style="font-size:16px;">
                            
                            ` + val.organization + `
                         </div>
                         <div class="form-group col-md-3" style="font-size:16px;">
                         
                            `  + val.stockitem + `
                         </div>
                         <div class="form-group col-md-2" style="font-size:16px;">
                         
                            ` + price.toFixed(2) + ` Naira
                         </div>
                         <div class="form-group col-md-3" style="font-size:16px;">
                            ` + val.discount + `%
                         </div></div>
                         <div class="form-group col-md-1" style="font-size:16px;">
                            <button type="submit" class="genric-btn danger delete-organization-button" data-id="` + val.id + `" style="font-size: 14px;border-radius: 8px;">Delete</button>  
                         </div></div>


                            `
                        })

                        $(".form-edit-organization").html(organizations)


                        $(".delete-organization-button").on("click",function(evt){
                            evt.preventDefault()
                            let id = $(this).attr("data-id")
                            let deleteOrganizationPrice = "deleteOrganizationPrice"
                            $.post("controllers/combo-setup.php",{id:id, deleteOrganizationPrice:deleteOrganizationPrice},function(data){
                                $("#item-organization-status").html(data)
                                getDeleteOrganizationPrice()
                            })
                            
                        })
                    } else {
                        $(".form-edit-organization").html(data)
                    }


                    
                })
            }
                  
                
                $("#combinedsearchitem").on('change keyup paste', function () {
                    ApplyCombinedFilterGetItem();
                });

                $("#searchitem").on('change keyup paste', function () {
                    ApplyFilterGetItem();
                });

                function ApplyFilterGetItem() {
                    var searchitemservice = $("#searchitem").val();
                    //console.log("getItemsFunction")
                    getItemsFunction()
                }

                function ApplyCombinedFilterGetItem() {
                    var searchitemservice = $("#combinedsearchitem").val();
                    //console.log("getItemsFunction")
                    getCombinedSearchItemsFunction()
                }

                $("#searchcombineditem").on('change keyup paste', function () {
                    ApplyFilterGetCombinedItem();
                });

                function ApplyFilterGetCombinedItem() {
                    var searchitemservice = $("#searchcombineditem").val();
                    //console.log("getItemsFunction")
                    getCombinedItemsFunction()
                }

                $("#combinedselectitem").on("change", function(evt){
                    evt.preventDefault()
                    

                    let getStockItemDetailsById = "getStockItemDetailsById"
                    let searchItem = $("#combinedselectitem").val()
                    $.post("controllers/combo-setup.php",{searchItem:searchItem,getStockItemDetailsById:getStockItemDetailsById},function(data){
                        data = JSON.parse(data)
                        console.log(data)
                        $("#stocknumber").val(data.itemcode)
                        $("#stockitemnumber").val(data.stockitemnumber)
                        $("#itemstrengthvalue").html(data.itemstrength)
                        $("#selectsupplier").html("<option value='" + data.suppliername + "'>" + data.suppliername + "</option>" + supplierlist)
                        $("#stockitemid").val(data.id)
                        $("#itemamount").val(data.actualservice)
                                let itemid = data.itemid
                                $("#itemid").val(itemid)
                        let GetGenericNameDetails = "GetGenericNameDetails"
                        $.post("controllers/combo-setup.php", {id:itemid,GetGenericNameDetails:GetGenericNameDetails},function(data){
                            data = JSON.parse(data)
                            console.log(data)
                            $("#usagegrouptype").html(data.usagegrouptype)
                            $("#itemstate").val(data.itemstate)
                            $("#itemserviceunitname").val(data.itemservice)
                            $("#itemdepartmentitemgroup").html(data.departmentitemgroup)
                            $("#actualpieces").val(zeroifnull(data.actualpieces))
                            $("#actualweight").val(zeroifnull(data.actualweight))
                            $("#actualvolume").val(zeroifnull(data.actualvolume))
                            $("#actuallength").val(zeroifnull(data.actuallength))
                            $("#actualservice").val(zeroifnull(data.actualservice))
                            $("#actualmicrogram").val(zeroifnull(data.actualmicrogram))
                            $("#actualinternationalunit").val(zeroifnull(data.actualinternationalunit))
                            $("#weightunit").val(data.weightunit)
                            $("#volumeunit").val(data.volumeunit)
                            $("#serviceunit").val(data.serviceunit)
                        })
                        $("#previousquantity").val("0")
                        $("#invoicenumber").val("")
                        $("#invoiceamount").val("")
                        $("#itemamount").val("")
                        getStockItemPrice()

                    })

                })

                $("#selectitem").on("change", function(evt){
                    evt.preventDefault()
                    

                    let getStockItemDetailsById = "getStockItemDetailsById"
                    let searchItem = $("#selectitem").val()
                    $.post("controllers/combo-setup.php",{searchItem:searchItem,getStockItemDetailsById:getStockItemDetailsById},function(data){
                        console.log(data)
                        data = JSON.parse(data)
                        $("#stocknumber").val(data.itemcode)
                        $("#stockitemnumber").val(data.stockitemnumber)
                        $("#itemstrengthvalue").html(data.itemstrength)
                       
                        $("#selectsupplier").html("<option value='" + data.suppliername + "'>" + data.suppliername + "</option>" + supplierlist)
                        $("#stockitemid").val(data.id)
                        $("#itemamount").val(data.actualservice)
                                let itemid = data.itemid
                                $("#itemid").val(itemid)
                        let GetGenericNameDetails = "GetGenericNameDetails"
                        $.post("controllers/combo-setup.php", {id:itemid,GetGenericNameDetails:GetGenericNameDetails},function(data){
                            data = JSON.parse(data)
                            $("#usagegrouptype").html(data.usagegrouptype)
                            $("#itemstate").val(data.itemstate)
                            $("#itemserviceunitname").val(data.itemservice)
                            if($("#itemstate").val()=="Service"){
                                console.log(itemstrength)
                                console.log(itemstrength.indexOf("Month"))
                                if(itemstrength.indexOf("Month")!=-1||itemstrength.indexOf("MONTH")!=-1){
                                    $("#package").val("services")
                                    $("#pieces").val("30")
                                    $("#totalduration").html("MONTH")
                                    $("#totaldurationdays").html("30")
                                }
                                if(itemstrength.indexOf("Year")!=-1||itemstrength.indexOf("YEAR")!=-1){
                                    $("#package").val("services")
                                    $("#pieces").val("365")
                                    $("#totalduration").html("YEAR")
                                    $("#totaldurationdays").html("365")
                                }
                                if(itemstrength.indexOf("Week")!=-1||itemstrength.indexOf("WEEK")!=-1){
                                    $("#package").val("services")
                                    $("#pieces").val("7")
                                    $("#totalduration").html("WEEK")
                                    $("#totaldurationdays").html("7")
                                }
                                $("#bag").hide()
                                    $("#carton").hide()
                                    $("#roll").hide()
                                    $("#pack").hide()
                                    $("#sachet").hide()
                            }
                            $("#itemdepartmentitemgroup").html(data.departmentitemgroup)
                            $("#actualpieces").val(zeroifnull(data.actualpieces))
                            $("#actualweight").val(zeroifnull(data.actualweight))
                            $("#actualvolume").val(zeroifnull(data.actualvolume))
                            $("#actuallength").val(zeroifnull(data.actuallength))
                            $("#actualservice").val(zeroifnull(data.actualservice))
                            $("#actualmicrogram").val(zeroifnull(data.actualmicrogram))
                            $("#actualinternationalunit").val(zeroifnull(data.actualinternationalunit))
                            $("#weightunit").val(data.weightunit)
                            $("#volumeunit").val(data.volumeunit)
                            $("#serviceunit").val(data.serviceunit)
                        })
                        $("#previousquantity").val("0")
                        $("#invoicenumber").val("")
                        $("#invoiceamount").val("")
                        // $("#itemamount").val("")
                        getStockItemPrice()

                    })

                })
                $("#save-package-button").hide()
                $("#clear-package-button").hide()
                function getPackagingFunction(){
                
                  $("#edit-packpricing-button").hide()
                  $("#delete-packpricing-button").hide()
                  $("#cancel-packpricing-button").hide()
                  $("#add-packpricing-button").show()
  
                      //get Item Codes
                      let getStockItem = "getStockItem"
                      let searchItem = $("#searchitem").val()
                      //console.log(searchItem)
                      $.post("controllers/combo-setup.php",{searchItem:searchItem,getStockItem: getStockItem},function(formdata){
                          ////console.log(data)
                          if(formdata=="No Record Found"){
                              $("#stockitem-status").html(formdata)
                          }else{
                              //console.log(formdata)
                              //console.log(typeof(formdata))
                              let data=JSON.parse(formdata)
                              //console.log(data)
                              let count = 0
                                  
                              let genericnameoptions = ``
                              $.each(data.records, function(key, val) {
                                  count++
                                  genericnameoptions += `
                                  <option value="` + val.id + `">` + val.genericname + ` (` + val.tradename + `)</option>
                              `
                              })
                              $("#stockitem-status").html(count + " Record(s) Found")
                              $("#selectitem").html(totalrecord)
                              $("#combinedselectitem").html(totalrecord)
                          }
  
                          
                              
                              
                          })
  
                      }


                let packaginglist = ``
               
               

                let packagelistvalue = ``
                $("#add-package-button").on("click", function(evt){
                    evt.preventDefault()
                    $("#save-package-button").show()
                    
                    // let numberpackage = $("#numberpackage").val()
                   
                })


                $("#clear-package-button").on("click", function(evt){
                    evt.preventDefault()
                    $("#packagingvalue").html("")
                    $("#clear-package-button").hide()
                    packagingvalue = []
                    finalpieces = 0
                    finalweight = 0
                    finalvolume = 0
                })

               


                $("#convert-units-button").on("click", function(evt){
                    evt.preventDefault()
                    let itemstrength = $("#itemstrengthvalue").text()
                        itemstrengtharray = itemstrength.split(" ")
                    let itemstate = $("#itemstate").val()
                  
                    let itemweightunit = ""
                    let itemvolumeunit = ""
                    let itemlengthunit = ""

                    if(itemstate.includes("Liquid") || itemstrength.includes("Gas")){
                        itemvolumeunit = itemstrengtharray[itemstrengtharray.length - 2]
                    }
                    if(itemstate.includes("Solid-Liquid") || itemstrength.includes("Gas")){
                        itemvolumeunit = itemstrengtharray[5]
                        itemweightunit = itemstrengtharray[1]
                    }
                    if(itemstate.includes("Liquid-Liquid") || itemstrength.includes("Gas")){
                        itemvolumeunit = itemstrengtharray[5]
                        // itemweightunit = itemstrengtharray[1]
                    }
                    if(itemstate.includes("Gas-Liquid") || itemstrength.includes("Gas")){
                        itemvolumeunit = itemstrengtharray[5]
                        itemweightunit = itemstrengtharray[1]
                    }
                    if(itemstate=="Solid"){
                        let unit = itemstrengtharray[1]
                        let splitunit = unit.split("/")
                        itemweightunit = splitunit[0]
                    }
                    if(itemstrength.includes("length")){
                        itemlengthunit = itemstrengtharray[1]
                    }
                    
                    
                    console.log(itemstrength, itemvolumeunit, itemweightunit, itemlengthunit)
                    if(itemlengthunit.toUpperCase()=="M"){
                        let meter = parseFloat($("#totallength").text())
                        meter = meter * 100
                        $("#totallengthcm").html(meter + " cm")
                    } else {
                        let meter = parseFloat($("#totallengthcm").text())
                        $("#totallengthcm").html(meter + " cm")   
                        meter = meter / 100
                        $("#totallength").html(meter + " M")   
                    }
                    console.log(itemvolumeunit.toUpperCase())
                    if(itemvolumeunit.toUpperCase()=="L"){
                        let liter = parseFloat($("#totalliquidstrength").text())
                        liter = liter * 1000
                        $("#totalliquidstrengthml").html(liter + " ml")
                    } else {
                        let liter = parseFloat($("#totalliquidstrengthml").text())
                        $("#totalliquidstrengthml").html(liter + " ml")   
                        liter = liter / 1000
                        $("#totalliquidstrength").html(liter + " L")   
                    }

                    console.log(itemweightunit)
                    if(itemweightunit.toUpperCase()=="KG"){
                        let gram = parseFloat($("#totalstrengthmg").text())
                        gram = gram * 1000
                        $("#totalstrength").html(gram + " kg")
                        let milligram = gram * 1000
                        $("#totalstrengthmg").html(milligram + " mg")
                    } else if(itemweightunit.toUpperCase()=="G"){
                        let gram = parseFloat($("#totalstrength").text())
                        gram = gram * 1000
                        $("#totalstrengthmg").html(gram + " mg")
                    } else {
                        let gram = parseFloat($("#totalstrengthmg").text())
                        $("#totalstrengthmg").html(gram + " mg")   
                        gram = gram / 1000
                        $("#totalstrength").html(gram + " G")   
                    }


                })
                $("#save-package-button").on("click", function(evt){
                    evt.preventDefault()

                    let package = $("#package").val()
                    let bag = $("#bag").val()
                    let carton = $("#carton").val()
                    let roll = $("#roll").val()
                    let pack = $("#pack").val()
                    let sachet = $("#sachet").val()
                    let pieces = $("#pieces").val()


                    
                    let itemstrength = $("#itemstrengthvalue").text()
                        itemstrengtharray = itemstrength.split(" ")
                       
                    let itemweight = itemstrengtharray[0]
                    let itemstate = $("#itemstate").val()
                    let itemvolume = 0
                    let itemlength = 0

                    let actualpieces = parseFloat($("#actualpieces").val())
                    let actualweight = parseFloat($("#actualweight").val())
                    let actualvolume = parseFloat($("#actualvolume").val())
                    let actuallength = parseFloat($("#actuallength").val())
                    let actualservice = parseFloat($("#actualservice").val())
                    let actualmicrogram = parseFloat($("#actualmicrogram").val())
                    let actualinternationalunit = parseFloat($("#actualinternationalunit").val())
                    let piecesunit = "pieces"

                    console.log(actualpieces, actualweight, actualvolume, actuallength, actualservice,actualmicrogram,actualinternationalunit)
                    itemunitarray = itemstrengtharray[1].split("/")
                    let itemweightunit = ""
                    let itemvolumeunit = ""
                    let itemlengthunit = ""
                    let itemserviceunit = ""

                    if(itemstate.includes("Liquid") || itemstrength.includes("Gas")){
                       
                        itemvolumeunit = itemstrengtharray[itemstrengtharray.length - 2]
                        
                        
                    }
                    if(itemstate.includes("Solid-Liquid") || itemstrength.includes("Gas-Liquid")){
                       
                       itemvolumeunit = itemstrengtharray[5]
                       let splitunitarray = itemstrengtharray[1].split("/")
                       itemweightunit = splitunitarray[0]
                       let unitvalue = 1
                       
                       console.log(splitunitarray)
                       if(splitunitarray[1]!=null||splitunitarray[1]!=""){
                            unitvalue = oneifnull(splitunitarray[1])
                       }


                       
                       let unitarray = itemstrengtharray[4].split("/")
                       let containervolume = parseFloat(itemstrengtharray[4])
                       let perunitvalue = containervolume / unitvalue

                       console.log(containervolume,itemstrengtharray)
                       console.log(actualweight, parseFloat(unitvalue), containervolume)
                       console.log(actualweight,actualmicrogram,actualinternationalunit)
                       actualweight = actualweight * perunitvalue

                       if(actualmicrogram!=0){
                        actualmicrogram = actualmicrogram * perunitvalue
                       }

                       if(actualinternationalunit!=0){
                        actualinternationalunit = actualinternationalunit * perunitvalue
                       }

                       if(actualweight==0){
                           if(actualmicrogram!=0){
                            actualweight = actualmicrogram
                           }
                           if(actualinternationalunit!=0){
                            actualweight = actualinternationalunit
                           }
                       }

                       console.log(actualweight)
                   }
                   if(itemstate.includes("Liquid-Liquid")){
                       
                       itemvolumeunit = itemstrengtharray[5]

                       let splitunitarray = itemstrengtharray[1].split("/")
                    //    itemvolumeunit = splitunitarray[0]
                       let unitvalue = 1
                       
                       console.log(splitunitarray)
                       if(splitunitarray[1]!=null||splitunitarray[1]!=""){
                            unitvalue = oneifnull(splitunitarray[1])
                       }
                      
                       let unitarray = itemstrengtharray[4].split("/")
                       let containervolume = parseFloat(itemstrengtharray[4])
                       let perunitvalue = containervolume / unitvalue

                       console.log(actualweight, parseFloat(itemstrengtharray[3]), containervolume)
                    //    actualvolume = actualvolume * (parseFloat(containervolume)/parseFloat(itemstrengtharray[3]))
                        actualvolume = actualvolume * perunitvalue

                       

                       if(actualinternationalunit!=0){
                        actualinternationalunit = actualinternationalunit * perunitvalue
                       }

                       if(actualvolume==0){
                           
                           if(actualinternationalunit!=0){
                            actualvolume = actualinternationalunit
                           }
                       }
                       
                   }
                    if(itemstate=="Solid"||itemstate=="Gas"){
                        let unit = itemstrengtharray[1]
                        let splitunit = unit.split("/")
                        itemweightunit = splitunit[0]

                        if(actualweight==0){
                           if(actualmicrogram!=0){
                            actualweight = actualmicrogram
                           }
                           if(actualinternationalunit!=0){
                            actualweight = actualinternationalunit
                           }
                       }
                    }
                    if(itemstrength.includes("length")){
                        itemlengthunit = itemstrengtharray[1]
                    }
                    if(itemstate=="Service"){
                        
                        itemserviceunit = $("#itemserviceunitname").val()

                    }
                    
                    




                    let packageinput = "#" + package.toLowerCase()
                    let quantity = $(packageinput).val()
                    if(itemstate=="Service"){
                        quantity = $("#pieces").val()
                    }

                    let totalpieces = oneifnull(bag) * oneifnull(carton) * oneifnull(roll) * oneifnull(pack) * oneifnull(sachet) * oneifnull(pieces)
                    
                    
                    finalpieces = finalpieces + totalpieces
                    let itemprice = $("#itemamount").val()
                    let itemamount = $("#itemamount").val()
                        if(itemamount!=""){
                    unitpieceprice = itemprice/finalpieces
                    $("#unitpricepieces").html(unitpieceprice.toFixed(2) + " Naira")
                    $("#unitpriceperpiece").val(unitpieceprice)
                    $("#totalpieces").html(finalpieces + " pieces")
                    let totalweight = totalpieces * actualweight
                    let totalvolume = totalpieces * actualvolume
                    let totallength = totalpieces * actuallength
                    let totalservice = actualservice
                    let totalmicrogram = actualmicrogram * totalpieces
                    let totalinternationalunit = actualinternationalunit * totalpieces
                    
                    
                    finalweight = finalweight + totalweight
                    finalvolume = finalvolume + totalvolume
                    finallength = finallength + totallength
                    finalservice = finalservice + totalservice
                    finalmicrogram = finalmicrogram + totalmicrogram
                    finalinternationalunit = finalinternationalunit + totalinternationalunit
                    if(finalweight>0){
                        unitstrengthprice = itemprice/finalweight
                    } else {
                        unitstrengthprice = 0
                    }
                   
                    unitpieceprice = itemprice/finalpieces

                    if(itemweightunit!=""){
                        $("#unitpricestrength").html(unitstrengthprice.toFixed(2) + " Naira /" + itemweightunit)
                    } else {
                        $("#unitpricestrength").html(unitstrengthprice.toFixed(2) + " Naira " )
                    }
                    
                    if(finalmicrogram>0){
                        $("#totalmicrogram").html(finalmicrogram + " ug")
                        unitmicrogramprice = itemprice/finalmicrogram
                        $("#unitpriceugiu").html(unitmicrogramprice + " Naira")
                        $("#unitpriceperug").val(unitmicrogramprice)
                    } else {
                        $("#totalmicrogram").html("0 ug")
                    }
                    if(finalinternationalunit>0){

                        $("#totalinternationalunit").html(finalinternationalunit + " IU")
                        unitinternationalunitprice = itemprice/finalinternationalunit
                        $("#unitpriceugiu").html(unitinternationalunitprice + " Naira")
                        $("#unitpriceperiu").val(unitinternationalunitprice)
                    } else {
                        $("#totalinternationalunit").html("0 IU")
                    }
                    
                    
                    
                    $("#unitpriceperstrength").val(unitstrengthprice)
                    if(finalvolume>0){
                        unitliquidstrengthprice = itemprice/finalvolume
                    } else {
                        unitliquidstrengthprice = 0
                    }
                    
                    if(itemvolumeunit!=""){
                        $("#unitpriceliquidstrength").html(unitliquidstrengthprice.toFixed(2) + " Naira / " + itemvolumeunit)
                    } else {
                        $("#unitpriceliquidstrength").html(unitliquidstrengthprice.toFixed(2) + " Naira")
                    }
                    
                    $("#unitpriceperliquidstrength").val(unitliquidstrengthprice)

                    if(finallength>0){
                        unitlengthprice = itemprice/finallength
                    } else {
                        unitlengthprice = 0
                    }
                    
                    if(itemlengthunit!=""){
                        $("#unitpricelength").html(unitlengthprice.toFixed(2) + " Naira / " + itemlengthunit)
                    } else {
                        $("#unitpricelength").html(unitlengthprice.toFixed(2) + " Naira")
                    }
                    
                    $("#unitpriceperlength").val(unitlengthprice)

                    if(finalservice>0){
                        unitserviceprice = unitpieceprice
                        $("#servicecostperday").html($("#unitpricepieces").text())
                        let splitpriceperservice = $("#unitpricepieces").text().split(" ")
                        $("#unitpriceperservice").val(splitpriceperservice[0])
                    } else {
                        unitserviceprice = 0
                        $("#servicecostperday").html("0")
                    }



                   

                    $("#totalstrength").html(finalweight + " " + itemweightunit)
                    $("#totalliquidstrength").html(finalvolume + " " + itemvolumeunit)
                    $("#totallength").html(finallength + " " + itemlengthunit)


                    console.log(itemstrength, itemvolumeunit, itemweightunit, itemlengthunit,itemserviceunit)
                    itemlengthunit = itemlengthunit.trim()
                    console.log(itemlengthunit)
                    itemlengthunit = itemlengthunit.toUpperCase()
                    console.log(itemlengthunit==="M")
                    if(itemlengthunit==="M"){
                        let meter = parseFloat($("#totallength").text())
                        meter = meter * 100
                        $("#totallengthcm").html(meter + " cm")
                    } else if(itemlengthunit==="DM"){
                        let meter = parseFloat($("#totallength").text())
                        dmeter = meter * 10
                        $("#totallengthcm").html(meter + " cm")   
                        meter = meter / 10
                        $("#totallength").html(meter + " M") 
                    } else if(itemlengthunit==="MM"){
                        let meter = parseFloat($("#totallength").text())
                        dmeter = meter / 10
                        $("#totallengthcm").html(meter + " cm")   
                        meter = meter / 1000
                        $("#totallength").html(meter + " M") 
                    } else {
                        let meter = parseFloat($("#totallength").text())
                        $("#totallengthcm").html(meter + " cm")   
                        meter = meter / 100
                        $("#totallength").html(meter + " M")   
                    }

                    itemvolumeunit = itemvolumeunit.trim()
                    itemvolumeunit = itemvolumeunit.toUpperCase()
                    if(itemvolumeunit==="L"){
                        let liter = parseFloat($("#totalliquidstrength").text())
                        liter = liter * 1000
                        $("#totalliquidstrengthml").html(liter + " ml")
                    } else if(itemlengthunit==="DL"){
                        let liter = parseFloat($("#totalliquidstrength").text())
                        dliter = liter * 100
                        $("#totalliquidstrengthml").html(meter + " ml")   
                        liter = liter / 10
                        $("#totalliquidstrength").html(meter + " L") 
                    } else if(itemlengthunit==="CL"){
                        let liter = parseFloat($("#totalliquidstrength").text())
                        dliter = liter * 10
                        $("#totalliquidstrengthml").html(meter + " ml")   
                        liter = liter / 100
                        $("#totalliquidstrength").html(meter + " L") 
                    } else {
                        let liter = parseFloat($("#totalliquidstrength").text())
                        $("#totalliquidstrengthml").html(liter + " ml")   
                        liter = liter / 1000
                        $("#totalliquidstrength").html(liter + " L")   
                    }

                    itemweightunit = itemweightunit.trim()
                    itemweightunit = itemweightunit.toUpperCase()
                    console.log(itemweightunit)
                    if(itemweightunit==="KG"){
                        let gram = parseFloat($("#totalstrength").text())
                        $("#totalstrengthkg").html(gram + " kg")
                        gram = gram * 1000
                        $("#totalstrength").html(gram + " G") 
                        gram = gram * 1000
                        $("#totalstrengthmg").html(gram + " mg")
                    } else if(itemweightunit==="G"){
                        let gram = parseFloat($("#totalstrength").text())
                        let kgram = gram / 1000
                        $("#totalstrengthkg").html(kgram + " kg")
                        gram = gram * 1000
                        $("#totalstrengthmg").html(gram + " mg")
                    } else if(itemweightunit==="DG"){
                        let gram = parseFloat($("#totalstrength").text())
                        let kgram = gram / (1000 * 10)
                        $("#totalstrengthkg").html(kgram + " kg")
                        let dgram = gram * 100
                        $("#totalstrengthmg").html(dgram + " mg")   
                        gram = gram / 10
                        $("#totalstrength").html(gram + " G")
                    } else if(itemweightunit==="CG"){
                        let gram = parseFloat($("#totalstrength").text())
                        let kgram = gram / (1000 * 100)
                        $("#totalstrengthkg").html(kgram + " kg")
                        let dgram = gram * 10
                        $("#totalstrengthmg").html(dgram + " mg")   
                        gram = gram / 100
                        $("#totalstrength").html(gram + " G")
                    } else if(itemweightunit==="UG"){
                        let gram = parseFloat($("#totalstrength").text())
                        let kgram = gram / (1000 * 1000 * 1000)
                        $("#totalstrengthkg").html(kgram + " kg")
                        let dgram = gram / 1000
                        $("#totalstrengthmg").html(dgram + " mg")   
                        gram = gram / (1000 * 1000)
                        $("#totalstrength").html(gram + " G")
                    } else {
                        let gram = parseFloat($("#totalstrength").text())
                        let kgram = gram / (1000 * 1000)
                        $("#totalstrengthkg").html(kgram + " kg")
                        $("#totalstrengthmg").html(gram + " mg")   
                        gram = gram / 1000
                        $("#totalstrength").html(gram + " G")   
                    }




                    let totalstrength = totalweight.toString() + " " + itemweightunit
                    let totalliquidsthrength = totalvolume.toString() + " " + itemvolumeunit
                    let totallengthsthrength = totallength.toString() + " " + itemlengthunit
                    let totalservicevalue = totalservice.toString() + " " + itemserviceunit
                    let packaging = {
                        package: package,
                        quantity: quantity,
                        value: totalpieces,
                        weight: totalstrength,
                        volume: totalliquidsthrength,
                        length: totallengthsthrength,
                        service: totalservicevalue

                    }
                    packagingvalue.push(packaging)
                    //console.log(packagingvalue)

                    let packaginglist = `<div class="form-group col-md-2" style="font-size:16px;">
                            
                               Package
                            </div>
                            <div class="form-group col-md-2" style="font-size:16px;">
                            
                                Qty
                            </div>
                            <div class="form-group col-md-2" style="font-size:16px;">
                            
                                Pieces
                            </div>
                            <div class="form-group col-md-1" style="font-size:16px;">
                                Wgt
                            </div>
                            <div class="form-group col-md-1" style="font-size:16px;">
                                Vol
                            </div>
                            
                            <div class="form-group col-md-1" style="font-size:16px;">
                                Len
                            </div>
                            <div class="form-group col-md-2" style="font-size:16px;">
                                Srv
                            </div>
                            <div class="form-group col-md-1" style="font-size:16px;">
                                Del
                            </div></div>`
                            let itemnumber = 0
                    packagingvalue.forEach(element => {
                        
                        packaginglist += `<div class="form-group col-md-2" style="font-size:18px;">` + element.package + `
                        
                        </div>
                        <div class="form-group col-md-2" style="font-size:18px;">` + element.quantity + ` qty
                        
                        </div>
                        <div class="form-group col-md-2" style="font-size:18px;">` + element.value + ` pieces
                        
                    </div>
                    <div class="form-group col-md-1" style="font-size:18px;">` + element.weight + `
                        
                    </div>
                    <div class="form-group col-md-1" style="font-size:18px;">` + element.volume + `
                        
                    </div>
                    <div class="form-group col-md-1" style="font-size:18px;">` + element.length + `
                        
                    </div>
                    <div class="form-group col-md-2" style="font-size:18px;">` + element.service + `
                        
                    </div>
                    
                    <div class="form-group col-md-1" style="font-size:18px;"><a href="#" data-id="` + itemnumber + `" class="del-packaging-item"><i class="fa fa-trash-o"></i></a>
                        
                    </div>
                        `
                        itemnumber += 1
                    });
                    $("#packagingvalue").html(packaginglist)
                    $("#clear-package-button").show()
                    //$("#package").val("")
                    $("#bag").val("")
                    $("#carton").val("")
                    $("#roll").val("")
                    $("#pack").val("")
                    $("#sachet").val("")
                    $("#pieces").val("")
                    $(this).hide()
                        } else {
                            $("#item-packaging-status").html("Please Enter Amount For Item")
                        }
                    $(".del-packaging-item").on("click", function(evt){
                        evt.preventDefault()
                        let id = $(this).attr("data-id")
                      
                        let value = packagingvalue[id].value
                        let weight = packagingvalue[id].weight   
                        let volume = packagingvalue[id].volume 
                        let length = packagingvalue[id].length   

                        finalpieces = finalpieces - value
                        let itemprice = $("#itemamount").val()

                        unitpieceprice = itemprice/finalpieces
                        $("#unitpricepieces").html(unitpieceprice.toFixed(2) + " Naira")
                        $("#unitpriceperpiece").val(unitpieceprice)
                        $("#totalpieces").html(finalpieces + " pieces")

                        itemstrength = $("#itemstrengthvalue").text()
                        itemstrengtharray = itemstrength.split(" ")
                      
                        let itemweight = itemstrengtharray[0]
                        let itemstate = $("itemstate").val()
                        let itemvolume = 0
                        let itemlength = itemstrengtharray[0]
                        if(itemstate=="Liquid" || itemstate=="Solution"){
                            let itemvolumestrength = itemstrengtharray[0].split("/")
                            let itemvolumestrength1 = itemvolumestrength[1].split(" ")
                            itemvolume = parseFloat(itemstrengtharray[4])
                        }
                        let splitweight = weight.split(" ")
                        let splitvolume = volume.split(" ")
                        let splitlength = length.split(" ")
                        totalweight = splitweight[0]
                        totalvolume = splitvolume[0]
                        totallength = splitlength[0]
                        finalweight = finalweight - totalweight
                        finalvolume = finalvolume - totalvolume
                        finallength = finallength - totallength
                        unitstrengthprice = itemprice/finalweight
                        $("#unitpricestrength").html(unitstrengthprice.toFixed(2) + " Naira")
                        $("#unitpriceperstrength").val(unitstrengthprice)
                        $("#totalstrength").html(finalweight + " " + itemweightunit)
                        $("#totalliquidstrength").html(finalvolume + " " + itemvolumeunit)
                        $("#totallength").html(finallength + " " + itemlengthunit)
                        let totalstrength = totalweight.toString() + " " + itemweightunit
                        
                        packagingvalue.splice(id, 1)
                        //console.log(packagingvalue)
                        
                        packagelistitems(packagingvalue)

                    })
                })

            function packagelistitems(packagingvalue){
                    if(packagingvalue.length>0){
                        let packaginglist = `<div class="form-group col-md-2" style="font-size:16px;">
                                
                                    Package
                                </div>
                                <div class="form-group col-md-2" style="font-size:16px;">
                                
                                    Qty
                                </div>
                                <div class="form-group col-md-2" style="font-size:16px;">
                                
                                    Pieces
                                </div>
                                <div class="form-group col-md-1" style="font-size:16px;">
                                    Wgt
                                </div>
                                <div class="form-group col-md-1" style="font-size:16px;">
                                    Vol
                                </div>
                                <div class="form-group col-md-1" style="font-size:16px;">
                                    Len
                                </div>
                                <div class="form-group col-md-2" style="font-size:16px;">
                                Srv
                            </div>
                                <div class="form-group col-md-1" style="font-size:16px;">
                                    Del
                                </div></div>`
                                let itemnumber = 0
                        packagingvalue.forEach(element => {
                            
                            packaginglist += `<div class="form-group col-md-2" style="font-size:18px;">` + element.package + `
                            
                            </div>
                            <div class="form-group col-md-2" style="font-size:18px;">` + element.quantity + ` qty
                            
                            </div>
                            <div class="form-group col-md-2" style="font-size:18px;">` + element.value + ` pieces
                            
                        </div>
                        <div class="form-group col-md-1" style="font-size:18px;">` + element.weight + `
                            
                        </div>
                        <div class="form-group col-md-1" style="font-size:18px;">` + element.volume + `
                            
                        </div>
                        <div class="form-group col-md-1" style="font-size:18px;">` + element.length + `
                            
                        </div>
                        <div class="form-group col-md-2" style="font-size:18px;">` + element.service + `
                            
                        </div>
                        <div class="form-group col-md-1" style="font-size:18px;"><a href="#" data-id="` + itemnumber + `" class="del-packaging-item"><i class="fa fa-trash-o"></i></a>
                            
                        </div>
                            `
                            itemnumber += 1
                        });
                        $("#packagingvalue").html(packaginglist)

                        $(".del-packaging-item").on("click", function(evt){
                            evt.preventDefault()
                            let id = $(this).attr("data-id")
                      
                            let value = packagingvalue[id].value
                            let weight = packagingvalue[id].weight   
                            let volume = packagingvalue[id].volume 
                            let length = packagingvalue[id].length   

                            finalpieces = finalpieces - value
                            let itemprice = $("#itemamount").val()

                            unitpieceprice = itemprice/finalpieces
                            $("#unitpricepieces").html(unitpieceprice.toFixed(2) + " Naira")
                            $("#unitpriceperpiece").val(unitpieceprice)
                            $("#totalpieces").html(finalpieces + " pieces")

                            itemstrength = $("#itemstrengthvalue").text()
                            itemstrengtharray = itemstrength.split(" ")
                        
                            let itemweight = itemstrengtharray[0]
                            let itemstate = $("itemstate").val()
                            let itemvolume = 0
                            let itemlength = itemstrengtharray[0]
                            if(itemstate=="Liquid" || itemstate=="Solution"){
                                let itemvolumestrength = itemstrengtharray[0].split("/")
                                let itemvolumestrength1 = itemvolumestrength[1].split(" ")
                                itemvolume = parseFloat(itemstrengtharray[4])
                            }
                            let splitweight = weight.split(" ")
                            let splitvolume = volume.split(" ")
                            let splitlength = length.split(" ")
                            totalweight = splitweight[0]
                            totalvolume = splitvolume[0]
                            totallength = splitlength[0]
                            finalweight = finalweight - totalweight
                            finalvolume = finalvolume - totalvolume
                            finallength = finallength - totallength
                            unitstrengthprice = itemprice/finalweight
                            $("#unitpricestrength").html(unitstrengthprice.toFixed(2) + " Naira")
                            $("#unitpriceperstrength").val(unitstrengthprice)
                            $("#totalstrength").html(finalweight + " " + itemweightunit)
                            $("#totalliquidstrength").html(finalvolume + " " + itemvolumeunit)
                            $("#totallength").html(finallength + " " + itemlengthunit)
                            let totalstrength = totalweight.toString() + " " + itemweightunit
                            
                            packagingvalue.splice(id, 1)
                            //console.log(packagingvalue)
                            
                            packagelistitems(packagingvalue)

                        })
                    } else {
                        $("#packagingvalue").html("")
                    }
            }

            $("#combinedquantity").on('change keyup paste', function () {
                    let quantity = zeroifnull($("#combinedquantity").val())
                    let unittype = $("#combineditemsunittype").val()
                    let price = 0
                    //console.log(unittype.toUpperCase())
                    if(unittype.toUpperCase()=="VOLUME"){
                        price = $("#combinedliquidunitstrength").val()
                        // $("#combinedprice").val(price)
                        let quantityprice = quantity * price
                        quantityprice = quantityprice.toFixed(2)
                        
                        $("#combinedquantityprice").val(quantityprice)
                    } else if(unittype.toUpperCase()=="LENGTH"){
                        price = $("#combinedlengthunitstrength").val()
                        // $("#combinedprice").val(price)
                        let quantityprice = quantity * price
                        quantityprice = quantityprice.toFixed(2)
                        
                        $("#combinedquantityprice").val(quantityprice)
                    } else if(unittype.toUpperCase()=="WEIGHT"){
                        price = $("#combinedunitstrength").val()
                        // $("#combinedprice").val(price)
                        let quantityprice = quantity * price
                        quantityprice = quantityprice.toFixed(2)
                        $("#combinedquantityprice").val(quantityprice)
                    } else{
                        price = $("#combinedprice").val()
                        // $("#combinedprice").val(price)
                        let quantityprice = quantity * price
                        quantityprice = quantityprice.toFixed(2)
                        $("#combinedquantityprice").val(quantityprice)
                    }
                
                });

                $("#partcombinedquantity").on('change keyup paste', function () {
                    let quantity = oneifnull($("#combinedquantity").val())/oneifnull($("#partcombinedquantity").val())
                    $("#quantitycombinedquantity").val(quantity)
                    let unittype = $("#combineditemsunittype").val()
                    let price = 0
                    //console.log(unittype.toUpperCase())
                    if(unittype.toUpperCase()=="VOLUME"){
                        price = $("#combinedliquidunitstrength").val()
                        // $("#combinedprice").val(price)
                        let quantityprice = quantity * price
                        quantityprice = quantityprice.toFixed(2)
                        
                        $("#combinedquantityprice").val(quantityprice)
                    } else if(unittype.toUpperCase()=="LENGTH"){
                        price = $("#combinedlengthunitstrength").val()
                        // $("#combinedprice").val(price)
                        let quantityprice = quantity * price
                        quantityprice = quantityprice.toFixed(2)
                        
                        $("#combinedquantityprice").val(quantityprice)
                    } else if(unittype.toUpperCase()=="WEIGHT"){
                        price = $("#combinedunitstrength").val()
                        // $("#combinedprice").val(price)
                        let quantityprice = quantity * price
                        quantityprice = quantityprice.toFixed(2)
                        $("#combinedquantityprice").val(quantityprice)
                    } else{
                        price = $("#combinedprice").val()
                        // $("#combinedprice").val(price)
                        let quantityprice = quantity * price
                        quantityprice = quantityprice.toFixed(2)
                        $("#combinedquantityprice").val(quantityprice)
                    }
                
                });

                $("#quantitycombinedquantity").on('change keyup paste', function () {
                    let part = oneifnull($("#combinedquantity").val())/oneifnull($("#quantitycombinedquantity").val())
                    $("#partcombinedquantity").val(part)
                    let quantity = oneifnull($("#combinedquantity").val())/oneifnull($("#partcombinedquantity").val())
                    let unittype = $("#combineditemsunittype").val()
                    let price = 0
                    //console.log(unittype.toUpperCase())
                    if(unittype.toUpperCase()=="VOLUME"){
                        price = $("#combinedliquidunitstrength").val()
                        // $("#combinedprice").val(price)
                        let quantityprice = quantity * price
                        quantityprice = quantityprice.toFixed(2)
                        
                        $("#combinedquantityprice").val(quantityprice)
                    } else if(unittype.toUpperCase()=="LENGTH"){
                        price = $("#combinedlengthunitstrength").val()
                        // $("#combinedprice").val(price)
                        let quantityprice = quantity * price
                        quantityprice = quantityprice.toFixed(2)
                        
                        $("#combinedquantityprice").val(quantityprice)
                    } else if(unittype.toUpperCase()=="WEIGHT"){
                        price = $("#combinedunitstrength").val()
                        // $("#combinedprice").val(price)
                        let quantityprice = quantity * price
                        quantityprice = quantityprice.toFixed(2)
                        $("#combinedquantityprice").val(quantityprice)
                    } else{
                        price = $("#combinedprice").val()
                        // $("#combinedprice").val(price)
                        let quantityprice = quantity * price
                        quantityprice = quantityprice.toFixed(2)
                        $("#combinedquantityprice").val(quantityprice)
                    }
                
                });

            
            $("#edit-combineditem-button").on("click", function(evt){
                $("#edit-combineditem-button").hide()
                $("#add-combineditem-button").show()

            })
            $("#add-combineditem-button").on("click", function(evt){
                    evt.preventDefault()
                    let selectitem = $("#combineditems").val()
                    let splitselectitem = selectitem.split(",")
                    let itemid = splitselectitem[1]
                    let getStockItemDetailsByItemId = "getStockItemDetailsByItemId"
                    let itemname = "Select Item"
                    $.post("controllers/combo-setup.php",{searchItem:itemid,getStockItemDetailsByItemId:getStockItemDetailsByItemId},function(formdata){
                        let data = JSON.parse(formdata)
                        console.log(data)
                        itemname = data.genericname + " (" + data.tradename + ")"
                        let pieces = $("#combinedtotalpiece").val()
                        //itemname = $("#combineditems").text()
                        let unitprice = $("#combinedprice").val()
                        // let unittype =  $("#combineditemsunittype").val()
                        if($("#combineditemsunittype").val()=="weight"){
                            unitprice = $("#combinedunitstrength").val()
                        } else if($("#combineditemsunittype").val()=="volume"){
                            unitprice = $("#combinedliquidunitstrength").val()
                        } else if($("#combineditemsunittype").val()=="length"){
                            unitprice = $("#combinedlengthunitstrength").val()
                        } else {
                            unitprice = $("#combinedprice").val()
                        }
                        let unitstrength = $("#combinedunitstrength").val()
                        let unitliquidstrength = $("#combinedliquidunitstrength").val()
                        let unitlengthstrength = $("#combinedlengthunitstrength").val()
                        let unit = $("#combineditemsunit").val()
                        unit = unit.toUpperCase()
                        let itemquantity = oneifnull($("#combinedquantity").val())/oneifnull($("#partcombinedquantity").val())
                        let itemquantityprice = $("#combinedquantityprice").val()
                        // let pieces = $("#pieces").val()
                        let totalprice = unitprice * itemquantity

                        let combineditemsstrengthvalue = $("#combineditemsstrength").val()
                        let splitcombineditemstrength = combineditemsstrengthvalue.split(",")

                        let totalpieces = parseFloat(splitcombineditemstrength[1])
                        let totalstrength = parseFloat(splitcombineditemstrength[1])
                        let totalliquidstrength = parseFloat(splitcombineditemstrength[1])
                        let totallengthstrength = parseFloat(splitcombineditemstrength[1])

                        let combinedquantity = oneifnull($("#combinedquantity").val())
                        let partcombinedquantity = oneifnull($("#partcombinedquantity").val())
                        let quantitycombinedquantity = oneifnull($("#quantitycombinedquantity").val())

                        let computequantity = combinedquantity / partcombinedquantity
                        let combineditemsstrength = $("#combineditemsstrength").val()

                        let splitcombineditemstrengthvalue = combineditemsstrength.split("(")
                        combineditemsstrength = splitcombineditemstrengthvalue[0]


                        let combineditemsunittype = splitcombineditemstrength[0]
                        console.log(computequantity, totalpieces, totalstrength,totalliquidstrength, totallengthstrength)
                        if(combineditemsunittype=="weight"){
                            if(unit=="G"){
                                //do nothing
                            } else {
                                totalstrength = parseFloat(totalstrength) * 1000
                            }
                            totalstrength = parseFloat(totalstrength)/parseFloat(pieces)
                            itemquantity = itemquantity * totalstrength
                        } else if(combineditemsunittype=="volume"){
                            if(unit=="L"){
                                //do nothing
                            } else {
                                totalliquidstrength = parseFloat(totalliquidstrength) * 1000
                            }
                            totalliquidstrength = parseFloat(totalliquidstrength)/parseFloat(pieces)
                            itemquantity = itemquantity * totalliquidstrength
                        } else if(combineditemsunittype=="length"){
                            if(unit=="M"){
                                //do nothing
                            } else {
                                totallengthstrength = parseFloat(totallengthstrength) * 100
                            }
                            totallengthstrength = parseFloat(totallengthstrength)/parseFloat(pieces)
                            itemquantity = itemquantity * totallengthstrength
                        } else {
                            itemquantity = itemquantity //* totalpieces
                        }
                        
                        
                        let itemunit = unitstrength + "(WGT), " + unitliquidstrength + " (VOL), " + unitlengthstrength + " (LEN)"
                        itemquantity = computequantity + " " + unit
                        let stockitemlistid = parseInt($("#combinedstockitemid").val())
                        let combinedpricing = {
                            itemid: itemid,
                            stockitemlistid:stockitemlistid,
                            itemname: itemname,
                            itemunit: itemunit,
                            unit:unit,
                            unitprice: unitprice,
                            itemquantity: itemquantity,
                            itemquantityprice:itemquantityprice,
                            unitstrength: unitstrength,
                            unitliquidstrength: unitliquidstrength,
                            unitlengthstrength: unitlengthstrength,
                            totalprice: totalprice,
                            computequantity:computequantity,
                            combineditemsstrength:combineditemsstrength,
                            combineditemsunittype:combineditemsunittype,
                            combinedquantity:combinedquantity,
                            partcombinedquantity:partcombinedquantity,
                            quantitycombinedquantity:quantitycombinedquantity
                        }
                        combinedpricingvaluearray.push(combinedpricing)
                        console.log(combinedpricingvaluearray)

                        let combinedpricinglist = `<div class="form-group col-md-2" style="font-size:14px;font-weight:bolder;">
                                
                                Item
                                </div>
                                <div class="form-group col-md-1" style="font-size:14px;font-weight:bolder;">
                                
                                    Type of Unit
                                </div>
                                <div class="form-group col-md-1" style="font-size:14px;font-weight:bolder;">
                                
                                    Unit
                                </div>
                                <div class="form-group col-md-2" style="font-size:14px;font-weight:bolder;">
                                    Whole Qty
                                </div>
                                <div class="form-group col-md-2" style="font-size:14px;font-weight:bolder;">
                                    Unit Qty Used
                                </div>
                                <div class="form-group col-md-1" style="font-size:14px;font-weight:bolder;">
                                    Parts of Whole
                                </div>
                                <div class="form-group col-md-2" style="font-size:14px;font-weight:bolder;">
                                    Qty Price
                                </div>
                                
                                <div class="form-group col-md-1" style="font-size:16px;font-weight:bolder;">
                                    Action
                                </div></div>`
                                let itemnumber = 0
                                let totalitemsprice = 0
                                combinedpricingvaluearray.forEach(element => {
                                    let itemid = element.itemid
                                    let getStockListByItemId = "getStockListByItemId"


                                    // totalitemsprice += parseFloat(element.totalprice)
                                    let itemstrength = element.combineditemsstrength
                                    $.post("controllers/combo-setup.php", {itemid:itemid,getStockListByItemId:getStockListByItemId}, function(formdata){

                                            
                                            let data = JSON.parse(formdata)
                                            console.log(data)
                                            let unitprice = 0
                                           
                                            let itemstrength = element.combineditemsstrength
                                            let splititemunit = itemstrength.split(",")
                                            let wholequantity = splititemunit[1]
                                            let quantity = element.computequantity
                                            //Pcs
                                            if(itemstrength=="Pcs"){
                                                unitprice = parseFloat(data.unitpriceperpiece)
                                            }
                                            //Wgt
                                            if(itemstrength=="Wgt"){
                                                unitprice = parseFloat(data.unitpriceperstrength)
                                            }
                                            //Vol
                                            if(itemstrength=="Vol"){
                                                unitprice = parseFloat(data.unitpriceperliquidstrength)
                                            }
                                            //Len
                                            if(itemstrength=="Len"){
                                                unitprice = parseFloat(data.unitpriceperlength)
                                            }

                                            totalprice = parseFloat(element.totalprice)

                                            totalitemsprice += parseFloat(totalprice)
                                            totalcombinedprice = totalitemsprice

                                            combinedpricinglist += `<div class="form-group col-md-2" style="font-size:15px;">` + element.itemname + `
                                    
                                                </div>
                                                <div class="form-group col-md-1" style="font-size:15px;">` + element.combineditemsunittype + `
                                                
                                                </div>
                                                <div class="form-group col-md-1" style="font-size:15px;">` + element.unit + `
                                                
                                            </div>
                                            <div class="form-group col-md-2" style="font-size:15px;">` + element.combinedquantity + ` ` + element.unit + `
                                                
                                            </div>
                                            <div class="form-group col-md-2" style="font-size:15px;">` + element.itemquantity + `
                                                
                                            </div>
                                            <div class="form-group col-md-1" style="font-size:15px;">` + element.partcombinedquantity + ` parts
                                                
                                            </div>
                                            <div class="form-group col-md-2" style="font-size:15px;">&#8358;` + element.totalprice.toFixed(2) + `
                                                
                                            </div>

                                            <div class="form-group col-md-1" style="font-size:18px;"><a href="#" data-id="` + element.itemid + `" class="del-combinedpricing-item" title="Delete Item"><i class="fa fa-trash-o"></i></a>
                                                <a href="#" data-id="` + element.itemid + `" class="addroutine-combinedpricing-item" title="Add Item to Routine"><i class="fa fa-plus"></i></a>
                                                
                                            </div>
                                        
                                                `
                                                itemnumber += 1
                                                $("#combinedpricevalue").html(combinedpricinglist)
                                                $("#combinedpricetotalvalue").html(`<div class="form-group col-md-12" style="font-size:18px;">Total = ` + totalitemsprice.toFixed(2) + ` Naira</div>`)
                                                
                                                $(".addroutine-combinedpricing-item").on("click", function(evt){
                                                                evt.preventDefault()
                                                                console.log(combinedpricingvaluearray)
                                                                console.log(itemregimentarray)

                                                                let itemid = $(this).attr("data-id")
                                                                console.log(itemid)

                                                                // combinedpricingvaluearray.splice(id, 1)
                                                                
                                                                console.log(combinedpricingvaluearray)
                                                                for(i=0;i<combinedpricingvaluearray.length;i++){
                                                                    console.log(combinedpricingvaluearray[i])
                                                                    if(itemid==combinedpricingvaluearray[i].itemid){
                                                                        let itemregiment = $("#itemregiments").val()
                                                                        let regimentcount = 0
                                                                        itemregimentarray.forEach(val => {

                                                                            if(val.regimentname == itemregiment){
                                                                                let regiment = JSON.parse(val.regiment)
                                                                                regiment.push(combinedpricingvaluearray[i])

                                                                                console.log(regiment)

                                                                                let newregimentarray = JSON.stringify(regiment)
                                                                                itemregimentarray[regimentcount].regiment = newregimentarray
                                                                                let regimentid = val.id
                                                                                let editItemRegiment_Regiment = "editItemRegiment_Regiment"
                                                                                $.post("controllers/combo-setup.php",{editItemRegiment_Regiment:editItemRegiment_Regiment,regimentid:regimentid,regiment:newregimentarray},function(data){
                                                                                    $("#itemregimentinfo").html(data)

                                                                                    let regimentname = $("#itemregiments").val()
                                                                                
                                                                                    itemregimentarray.forEach(val => {
                                                                                        if(regimentname == val.regimentname){
                                                                                            console.log(val.regiment)
                                                                                            let regimentlist = JSON.parse(val.regiment)
                                                                                            // combinedpricingvaluearray = regimentlist
                                                                                            let regimentlistitems = ``
                                                                                            let count = 0
                                                                                            regimentlist.forEach(value => {
                                                                                                // combinedpricingvaluearray.push(value)
                                                                                                regimentlistitems += `<option value="` + count + `,` + value.itemid + `">` + value.itemname + `</option>`
                                                                                                count++
                                                                                            });
                                                                                            $("#itemregimentslist").html(regimentlistitems)
                                                                                        }
                                                                                    });
                                                                                })
                                                                            }
                                                                            regimentcount++
                                                                        })

                                                                    }
                                                                }


                                                            })

                                                $(".del-combinedpricing-item").on("click", function(evt){
                                                    evt.preventDefault()
                                                    let itemid = $(this).attr("data-id")
                                                    console.log(itemid)

                                                    // combinedpricingvaluearray.splice(id, 1)
                                                    //console.log(packagingvalue)

                                                    for(i=0;i<combinedpricingvaluearray.length;i++){
                                                        if(itemid==combinedpricingvaluearray[i].itemid){
                                                            console.log(combinedpricingvaluearray[i].itemname," found")
                                                            combinedpricingvaluearray.splice(i, 1)
                                                        }
                                                    }
                                                    
                                                    combinedpricinglistitems(combinedpricingvaluearray)

                                                })

                                                $(".edit-combinedpricing-item").on("click", function(evt){
                                                    evt.preventDefault()
                                                    let itemid = $(this).attr("data-id")
                                                    for(i=0;i<combinedpricingvaluearray.length;i++){
                                                        if(itemid==combinedpricingvaluearray[i].itemid){
                                                            console.log(combinedpricingvaluearray[i].itemname," found")
                                                            $("#edit-combineditem-button").show()
                                                            $("#add-combineditem-button").hide()
                                                        }
                                                    }
                                                })

                                                
                                            });
                                           
                                    })

                                    // combinedpricinglist +=  `<div class="form-group col-md-12" style="font-size:18px;">Total = ` + totalitemsprice.toFixed(2) + ` Naira</div>`
                                   
                        
                       
                        $(".markupitem").on('change paste', function () {
                            let markup = $(this).val()

                            let id = $(this).attr("data-id")
                        
                            console.log(id)
                            

                        })
                    })
                    
                })
                let totalcombinedprice = 0

                function combinedpricinglistitems(combinedpricingvalue){
                    console.log(combinedpricingvalue)

                    if(combinedpricingvalue.length>0){
                        let combinedpricinglist = `<div class="form-group col-md-2" style="font-size:14px;font-weight:bolder;">
                                
                                Item
                                </div>
                                <div class="form-group col-md-1" style="font-size:14px;font-weight:bolder;">
                                
                                    Type of Unit
                                </div>
                                <div class="form-group col-md-1" style="font-size:14px;font-weight:bolder;">
                                
                                    Unit
                                </div>
                                <div class="form-group col-md-2" style="font-size:14px;font-weight:bolder;">
                                    Whole Qty
                                </div>
                                <div class="form-group col-md-2" style="font-size:14px;font-weight:bolder;">
                                    Unit Qty Used
                                </div>
                                <div class="form-group col-md-1" style="font-size:14px;font-weight:bolder;">
                                    Parts of Whole
                                </div>
                                <div class="form-group col-md-2" style="font-size:14px;font-weight:bolder;">
                                    Qty Price
                                </div>
                                
                                <div class="form-group col-md-1" style="font-size:16px;font-weight:bolder;">
                                   Action
                         </div></div>`
                         let itemnumber = 0
                         let totalitemsprice = 0
                         console.log(combinedpricingvalue)
                         combinedpricingvalue.forEach(element => {
                            let itemid = element.itemid
                            let getStockListByItemId = "getStockListByItemId"


                            
                            // let itemstrength = element.combineditemsstrength
                            $.post("controllers/combo-setup.php", {itemid:itemid,getStockListByItemId:getStockListByItemId}, function(formdata){

                                    let data = JSON.parse(formdata)
                                    console.log(data)
                                    let unitprice = 0
                                    let itemstrength = ""
                                    if(element.combineditemsstrength!=null){
                                        
                                        let splititemstrength = element.combineditemsstrength.split(",")
                                        itemstrength = splititemstrength[0]
                                    } else {
                                        itemstrength="pieces"
                                    }
                                    // let itemstrength = element.combineditemsstrength
                                    let quantity = 1
                                    if(element.computequantity!=null){
                                        quantity = element.computequantity
                                    } else {
                                        quantity = parseFloat(parseFloat(element.totalprice)/parseFloat(element.unitprice))
                                    }
                                     

                                    //Pcs
                                    unitprice = data.sellingprice
                                    if(itemstrength=="pieces"){
                                        unitprice = parseFloat(data.unitpriceperpiece)
                                    }
                                    //Wgt
                                    if(itemstrength=="weight"){
                                        unitprice = parseFloat(data.unitpriceperstrength)
                                    }
                                    //Vol
                                    if(itemstrength=="volume"){
                                        unitprice = parseFloat(data.unitpriceperliquidstrength)
                                    }
                                    //Len
                                    if(itemstrength=="length"){
                                        unitprice = parseFloat(data.unitpriceperlength)
                                    }
                                    

                                    totalprice = parseFloat(unitprice * quantity)

                                    totalitemsprice += parseFloat(totalprice)
                                    totalcombinedprice = totalitemsprice

                                    console.log(itemstrength, quantity, unitprice, totalitemsprice)
                                    combinedpricinglist += `<div class="form-group col-md-2" style="font-size:15px;">` + element.itemname + `
                            
                                        </div>
                                        <div class="form-group col-md-1" style="font-size:15px;">` + element.combineditemsunittype + `
                                                
                                            </div>
                                            <div class="form-group col-md-1" style="font-size:15px;">` + element.unit + `
                                            
                                        </div>
                                        <div class="form-group col-md-2" style="font-size:15px;">` + element.combinedquantity + ` ` + element.unit + `
                                            
                                        </div>
                                        <div class="form-group col-md-2" style="font-size:15px;">` + element.itemquantity + `
                                            
                                        </div>
                                        <div class="form-group col-md-1" style="font-size:15px;">` + element.partcombinedquantity + ` parts
                                            
                                        </div>
                                    <div class="form-group col-md-2" style="font-size:15px;">&#8358;` + totalprice.toFixed(2) + ` 
                                        
                                    </div>

                                    <div class="form-group col-md-1" style="font-size:18px;"><a href="#" data-id="` + element.itemid + `" class="del-combinedpricing-item" title="Delete Item"><i class="fa fa-trash-o"></i></a>
                                        <a href="#" data-id="` + element.itemid + `" class="addroutine-combinedpricing-item" title="Add Item to Routine"><i class="fa fa-plus"></i></a>
                                        
                                    </div>
                                
                                        `
                                        itemnumber += 1
                                        
                                        // console.log(combinedpricinglist)
                                        // combinedpricinglist +=  
                                        $("#combinedpricevalue").html(combinedpricinglist)
                                        $("#combinedpricetotalvalue").html(`<div class="form-group col-md-12" style="font-size:18px;">Total = ` + totalitemsprice.toFixed(2) + ` Naira</div>`)
                                        totalcombinedprice = parseFloat(totalitemsprice)
                                        console.log(totalcombinedprice)
                                        $(".addroutine-combinedpricing-item").on("click", function(evt){
                                                                evt.preventDefault()
                                                                console.log(combinedpricingvaluearray)
                                                                console.log(itemregimentarray)

                                                                let itemid = $(this).attr("data-id")
                                                                console.log(itemid)

                                                                // combinedpricingvaluearray.splice(id, 1)
                                                                //console.log(packagingvalue)

                                                                for(i=0;i<combinedpricingvaluearray.length;i++){
                                                                    if(itemid==combinedpricingvaluearray[i].itemid){
                                                                        let itemregiment = $("#itemregiments").val()
                                                                        let regimentcount = 0
                                                                        itemregimentarray.forEach(val => {

                                                                            if(val.regimentname == itemregiment){
                                                                                let regiment = JSON.parse(val.regiment)
                                                                                regiment.push(combinedpricingvaluearray[i])

                                                                                console.log(regiment)

                                                                                let newregimentarray = JSON.stringify(regiment)
                                                                                itemregimentarray[regimentcount].regiment = newregimentarray
                                                                                let regimentid = val.id
                                                                                let editItemRegiment_Regiment = "editItemRegiment_Regiment"
                                                                                $.post("controllers/combo-setup.php",{editItemRegiment_Regiment:editItemRegiment_Regiment,regimentid:regimentid,regiment:newregimentarray},function(data){
                                                                                    $("#itemregimentinfo").html(data)

                                                                                    let regimentname = $("#itemregiments").val()
                                                                                
                                                                                    itemregimentarray.forEach(val => {
                                                                                        if(regimentname == val.regimentname){
                                                                                            console.log(val.regiment)
                                                                                            let regimentlist = JSON.parse(val.regiment)
                                                                                            // combinedpricingvaluearray = regimentlist
                                                                                            let regimentlistitems = ``
                                                                                            let count = 0
                                                                                            regimentlist.forEach(value => {
                                                                                                // combinedpricingvaluearray.push(value)
                                                                                                regimentlistitems += `<option value="` + count + `,` + value.itemid + `">` + value.itemname + `</option>`
                                                                                                count++
                                                                                            });
                                                                                            $("#itemregimentslist").html(regimentlistitems)
                                                                                        }
                                                                                    });
                                                                                })
                                                                            }
                                                                            regimentcount++
                                                                        })

                                                                    }
                                                                }


                                                            })
                                        $(".del-combinedpricing-item").on("click", function(evt){
                                            evt.preventDefault()
                                            let itemid = $(this).attr("data-id")
                                            console.log(itemid, combinedpricingvaluearray)

                                            // combinedpricingvaluearray.splice(id, 1)
                                            //console.log(packagingvalue)
                                            for(i=0;i<combinedpricingvaluearray.length;i++){
                                                if(itemid==combinedpricingvaluearray[i].itemid){
                                                    console.log(combinedpricingvaluearray[i].itemname," found")
                                                    combinedpricingvaluearray.splice(i, 1)
                                                }
                                            }
                                            
                                            
                                            combinedpricinglistitems(combinedpricingvaluearray)

                                        })

                                        $(".edit-combinedpricing-item").on("click", function(evt){
                                            evt.preventDefault()
                                            let itemid = $(this).attr("data-id")
                                            for(i=0;i<combinedpricingvaluearray.length;i++){
                                                if(itemid==combinedpricingvaluearray[i].itemid){
                                                    console.log(combinedpricingvaluearray[i].itemname," found")
                                                    $("#edit-combineditem-button").show()
                                                    $("#add-combineditem-button").hide()
                                                    $("#editcombinedpricingitemid").val(i)
                                                    $("#combinedquantityprice").val(combinedpricingvaluearray[i].totalprice)
                                                    $("#combinedquantity").val(combinedpricingvaluearray[i].combinedquantity)
                                                    $("#quantitycombinedquantity").val(combinedpricingvaluearray[i].quantitycombinedquantity)
                                                    $("#partcombinedquantity").val(combinedpricingvaluearray[i].partcombinedquantity)
                                                }
                                            }
                                        })
                                        
                                    });
                
                                })

                    

                    

                        $(".markupitem").on('change paste', function () {
                            let markup = $(this).val()

                            let id = $(this).attr("data-id")
                        
                            console.log(combinedpricingvalueid, "2")
                            

                        })


                    } else {
                        $("#combinedpricevalue").html("")
                        $("#combinedpricetotalvalue").html("")
                        $("#markuppricecombined").val("1")
                        combinedpricingvaluearray = []
                        combinedpricevalue = []
                    }
            }
            let combinedtotalprice = 0
            let combinedmarkupprice = 0
            let combinedpercentageprofit = 0
            $("#compute-combinedpricing-button").on("click", function(evt){
                evt.preventDefault()
                let combineditemmarkup = $("#markuppricecombined").val()
                combinedpercentageprofit = parseFloat(combineditemmarkup)
                //console.log(combinedpricingvaluearray)
                if(combinedpricingvaluearray.length>0){
                    let totalprice = 0
                    combinedpricingvaluearray.forEach(element => {
                        totalprice = totalprice + element.totalprice
                    })
                    combinedtotalprice = parseFloat(totalcombinedprice)
                    let markupprice = ((combineditemmarkup/100) * totalcombinedprice) + totalcombinedprice
                    combinedmarkupprice = parseFloat(markupprice)
                    let combinedmarkup = `
                        Total Price: ` + totalcombinedprice + ` Naira <br>
                        Markup Price: ` + markupprice + ` Naira <br>
                        Percentage Markup(Profit): ` + combineditemmarkup + `%
                    `
                    $("#computecombinedpricing").html(combinedmarkup)
                } else{
                    $("#computecombinedpricing").html("No Items Found")
                }

            })

            $("#markuppricecombined").on("keyup change", function(evt){
                evt.preventDefault()
                let combineditemmarkup = $("#markuppricecombined").val()
                combinedpercentageprofit = parseFloat(combineditemmarkup)
                //console.log(combinedpricingvaluearray)
                if(combinedpricingvaluearray.length>0){
                    let totalprice = 0
                    combinedpricingvaluearray.forEach(element => {
                        totalprice = totalprice + element.totalprice
                    })
                    combinedtotalprice = parseFloat(totalcombinedprice)
                    let markupprice = ((combineditemmarkup/100) * totalcombinedprice) + totalcombinedprice
                    combinedmarkupprice = parseFloat(markupprice)
                    let combinedmarkup = `
                        Total Price: ` + totalcombinedprice + ` Naira <br>
                        Markup Price: ` + markupprice + ` Naira <br>
                        Percentage Markup(Profit): ` + combineditemmarkup + `%
                    `
                    $("#computecombinedpricing").html(combinedmarkup)
                } else{
                    $("#computecombinedpricing").html("No Items Found")
                }
            })

            $("#markuppricecombinedprice").on("keyup change", function(evt){
                evt.preventDefault()
                let combineditemmarkup = $("#markuppricecombinedprice").val()
                let combinedpriceprofit = parseFloat(combineditemmarkup)
                // combinedpercentageprofit = parseFloat(combineditemmarkup)
                //console.log(combinedpricingvaluearray)
                if(combinedpricingvaluearray.length>0){
                    let totalprice = 0
                    combinedpricingvaluearray.forEach(element => {
                        totalprice = totalprice + element.totalprice
                    })
                   

                    combinedtotalprice = parseFloat(totalcombinedprice)

                    let price = combinedpriceprofit - totalcombinedprice
                    price = parseFloat(price)
                    totalprice = parseFloat(totalcombinedprice)
                    console.log(totalcombinedprice, combinedpriceprofit)
                    combinedpercentageprofit = (price/combinedtotalprice) * 100
                    let markupprice = ((combinedpercentageprofit/100) * totalprice) + totalprice
                    combinedmarkupprice = parseFloat(markupprice)
                    console.log(combinedpercentageprofit)
                    let combinedmarkup = `
                        Total Price: ` + totalcombinedprice + ` Naira <br>
                        Markup Price: ` + markupprice + ` Naira <br>
                        Percentage Markup(Profit): ` + combinedpercentageprofit + `%
                    `
                    $("#computecombinedpricing").html(combinedmarkup)
                    $("#markuppricecombined").val(combinedpercentageprofit)
                } else{
                    $("#computecombinedpricing").html("No Items Found")
                }
            })

            $("#save-combinedprice-button").on("click", function(evt){
                evt.preventDefault()
               if(combinedtotalprice!=0){
                    let combineditemprofit = combinedmarkupprice - combinedtotalprice
                    let itemid = $("#itemid").val()
                    let stockitemid = $("#stockitemid").val()
                    let genericname = $("#combinedselectitem").val()
                    let stockcode = $("#stocknumber").val()
                    let stocknumber = $("#stockitemnumber").val()
                    //let usagegrouptype = $("#usagegrouptype").val()
                    let itemstate = $("#itemstate").val()
                    let previousquantity = 0
                    let suppliername = $("#selectsupplier").val()
                    let invoicenumber = ""
                    let invoicedate = ""
                    let invoiceamount = 0.0
                    let itemamount = combinedtotalprice
                    let stocktype = $("#stocktype").val()
                    let package = ""
                    //previousquantity = parseInt(previousquantity) + parseInt(finalpieces)
                    let totalpieces = 0
                    let totalweight = 0
                    let totalweightmg = 0
                    let totalweightkg = 0
                    let totalvolumeml = 0
                    let totallengthcm = 0
                    let unitpriceperpiece = combinedtotalprice
                    let unitpriceperstrength = 0.0
                    
                    let percentagemarkup = $("#markuppricecombined").val()
                    let itemsellingprice = combinedmarkupprice
                    let itemprofit = combineditemprofit
                    let itempercentageprofit = combinedpercentageprofit
                    //console.log(combinedpricevalue)
                    combinedpricingvalue = JSON.stringify(combinedpricingvaluearray)
                    let insertStockListItem = "insertStockListItem"

                    let totalvolume = 0
                    let totallength = 0
                    let itemsellingpriceperstrength = 0
                    let itemsellingpriceperliquidstrength = 0
                    let itemsellingpriceperlength = 0
                    let itemsellingpriceperservice = 0
                    let unitpriceperliquidstrength = 0
                    let totaldurationdays = 0
                    let totalduration = ""
                    let unitpriceperlength = 0
                    let unitpriceperservice = 0
                    let weightunit = ''
                    let lengthunit = ''
                    let volumeunit = ''
                    let serviceunit = ''
                    $.post("controllers/combo-setup.php",{
                        itemid:itemid,
                        stockitemid:stockitemid,
                        genericname:genericname,
                        weightunit:weightunit,
                        lengthunit:lengthunit,
                        volumeunit:volumeunit,
                        serviceunit:serviceunit,
                        stockcode:stockcode,
                        stocknumber:stocknumber,
                        itemstate:itemstate,
                        previousquantity:previousquantity,
                        suppliername:suppliername,
                        invoicenumber:invoicenumber,
                        invoicedate:invoicedate,
                        invoiceamount:invoiceamount,
                        itemamount:itemamount,
                        stocktype:stocktype,
                        totalvolume:totalvolume,
                        itemsellingpriceperstrength:itemsellingpriceperstrength,
                        itemsellingpriceperliquidstrength:itemsellingpriceperliquidstrength,
                        itemsellingpriceperlength:itemsellingpriceperlength,
                        itemsellingpriceperservice:itemsellingpriceperservice,
                        unitpriceperservice:unitpriceperservice,
                        totaldurationdays:totaldurationdays,
                        totalduration:totalduration,
                        unitpriceperliquidstrength:unitpriceperliquidstrength,
                        unitpriceperlength:unitpriceperlength,
                        unitpriceperservice:unitpriceperservice,
                        package:package,
                        totalpieces:totalpieces,
                        totalweight:totalweight,
                        totallength:totallength,
                        totalweightmg:totalweightmg,
                        totalweightkg:totalweightkg,
                        totalvolumeml:totalvolumeml,
                        totallengthcm:totallengthcm,
                        unitpriceperpiece:unitpriceperpiece,
                        unitpriceperstrength:unitpriceperstrength,
                        percentagemarkup:percentagemarkup,
                        itemsellingprice:itemsellingprice,
                        itemprofit:itemprofit,
                        combinedpricingvalue:combinedpricingvalue,
                        itempercentageprofit:itempercentageprofit,
                        insertStockListItem:insertStockListItem
                    },function(data){
                        $("#item-combinineditems-status").html(data)
                        let splitstocklistid = data.split("- ")
                        let stockitemlistid = splitstocklistid[1]
                        $("#stocklistid").val(stockitemlistid)
                        
                        getStockItemPrice()
                    })

               }


            })

            $("#regiment-combinedprice-button").on("click", function(evt){
                evt.preventDefault()
                let genericname = $("#selectitem").val()
                let regimentname = $("#regimentname").val()
                if(regimentname=="" || regimentname==null){
                    $("#itemregimentinfo").html("Please enter Regiment Name for this list")
                } else {
                    combinedpricingvalue = JSON.stringify(combinedpricingvaluearray)
                    let getStockItemDetailsById = "getStockItemDetailsById"
                    $.post("controllers/combo-setup.php",{searchItem:genericname,getStockItemDetailsById:getStockItemDetailsById},function(data){
                        let formdata = JSON.parse(data)
                        let insertItemRegiment = "insertItemRegiment"
                        let itemname = formdata.genericname + " (" + formdata.tradename + ")"
                        
                        $.post("controllers/combo-setup.php",{itemname:itemname,regimentname:regimentname,combinedpricingvalue:combinedpricingvalue,insertItemRegiment:insertItemRegiment},function(data){
                            $("#itemregimentinfo").html(data)
                            getitemregiment()
                        })
                    })
                }
                
                

            })

            $("#delete-itemregiment-button").on("click", function(evt){
                // console.log("test")
                evt.preventDefault()
                let routinename = $("#itemregiments").val()
                console.log(routinename)
                let deleteItemRegimentByName = "deleteItemRegimentByName"
                $.post("controllers/combo-setup.php",{routinename:routinename,deleteItemRegimentByName:deleteItemRegimentByName},function(data){
                    console.log(data)
                    $("#itemregimentinfo").html(data)
                    $("#combinedpricevalue").html("")
                    $("#combinedpricetotalvalue").html("")
                    combinedpricingvaluearray = []
                    getitemregiment()
                })
            })

            $("#removeitem-itemregiment-button").on("click", function(evt){
                evt.preventDefault()
                let itemregiment = $("#itemregiments").val()
                console.log(itemregimentarray)
                let i = 0
                let regimentcount = 0
                itemregimentarray.forEach(val => {
                    if(val.regimentname == itemregiment){
                         let itemname = $("#itemregimentslist").val()
                         let splititemname = itemname.split(",")
                         itemname = splititemname[1]
                         let regimentarray = JSON.parse(val.regiment)
                        regimentarray.forEach(element => {
                            console.log(itemname,element.itemname)
                            if(itemname==element.itemid){
                                regimentarray.splice(i, 1)
                                console.log(i)
                            }
                            i++
                        });
                       
                       
                        

                        let count = 0
                        let regimentlistitems = ``
                        regimentarray.forEach(value => {
                            regimentlistitems += `<option value="` + count + `,` + value.itemid + `">` + value.itemname + `</option>`
                            count++
                        });
                        $("#itemregimentslist").html(regimentlistitems)

                        let newregimentarray = JSON.stringify(regimentarray)
                        itemregimentarray[regimentcount].regiment = newregimentarray
                        let regimentid = val.id
                        let editItemRegiment_Regiment = "editItemRegiment_Regiment"
                        $.post("controllers/combo-setup.php",{editItemRegiment_Regiment:editItemRegiment_Regiment,regimentid:regimentid,regiment:newregimentarray},function(data){
                            $("#itemregimentinfo").html(data)

                            let regimentname = $("#itemregiments").val()
                        
                            itemregimentarray.forEach(val => {
                                if(regimentname == val.regimentname){
                                    console.log(val.regiment)
                                    let regimentlist = JSON.parse(val.regiment)
                                    // combinedpricingvaluearray = regimentlist
                                    let regimentlistitems = ``
                                    let count = 0
                                    regimentlist.forEach(value => {
                                        // combinedpricingvaluearray.push(value)
                                        regimentlistitems += `<option value="` + count + `,` + value.itemid + `">` + value.itemname + `</option>`
                                        count++
                                    });
                                    $("#itemregimentslist").html(regimentlistitems)
                                }
                            });
                            // $("#combinedpricevalue").html("")
                            // $("#combinedpricetotalvalue").html("")
                            // combinedpricingvaluearray = []
                        })
                    }
                    regimentcount++
                });
            })


            $("#addfromtable-itemregiment-button").on("click", function(evt){
                evt.preventDefault()
                console.log(combinedpricingvaluearray)
                console.log(itemregimentarray)
                let itemregiment = $("#itemregiments").val()
                let regimentcount = 0
                itemregimentarray.forEach(val => {

                    if(val.regimentname == itemregiment){
                        let regiment = JSON.parse(val.regiment)
                        combinedpricingvaluearray.forEach(element => {
                            regiment.push(element)
                        });
                        

                        console.log(regiment)

                        let newregimentarray = JSON.stringify(regiment)
                        itemregimentarray[regimentcount].regiment = newregimentarray
                        let regimentid = val.id
                        let editItemRegiment_Regiment = "editItemRegiment_Regiment"
                        $.post("controllers/combo-setup.php",{editItemRegiment_Regiment:editItemRegiment_Regiment,regimentid:regimentid,regiment:newregimentarray},function(data){
                            $("#itemregimentinfo").html(data)

                            let regimentname = $("#itemregiments").val()
                        
                            itemregimentarray.forEach(val => {
                                if(regimentname == val.regimentname){
                                    console.log(val.regiment)
                                    let regimentlist = JSON.parse(val.regiment)
                                    // combinedpricingvaluearray = regimentlist
                                    let regimentlistitems = ``
                                    let count = 0
                                    regimentlist.forEach(value => {
                                        combinedpricingvaluearray.push(value)
                                        regimentlistitems += `<option value="` + count + `,` + value.itemid + `">` + value.itemname + `</option>`
                                        count++
                                    });
                                    $("#itemregimentslist").html(regimentlistitems)
                                }
                            });
                        })
                    }
                    regimentcount++

                })
            })

            $("#clearlist-itemregiment-button").on("click", function(evt){
                evt.preventDefault()
                // $("#combinedpricevalue").html("")
                // $("#combinedpricetotalvalue").html("")
                // combinedpricingvaluearray = []
                getitemregiment()
            })
            

            $("#refresh-combinedprice-button").on("click", function(evt){
                evt.preventDefault()
                let getStockItemDetailsById = "getStockItemDetailsById"
                    let searchItem = $("#combinedselectitem").val()
                    $.post("controllers/combo-setup.php",{searchItem:searchItem,getStockItemDetailsById:getStockItemDetailsById},function(data){
                        data = JSON.parse(data)
                        $("#stocknumber").val(data.itemcode)
                        $("#stockitemnumber").val(data.stockitemnumber)
                        $("#itemstrengthvalue").html(data.itemstrength)
                        $("#selectsupplier").html("<option value='" + data.suppliername + "'>" + data.suppliername + "</option>" + supplierlist)
                        $("#stockitemid").val(data.id)
                                let itemid = data.itemid
                                $("#itemid").val(itemid)
                        let getGenericNameDetails = "getGenericNameDetails"
                        $.post("controllers/combo-setup.php", {searchItem:itemid,getGenericNameDetails:getGenericNameDetails},function(data){
                            data = JSON.parse(data)
                            $("#usagegrouptype").html(data.usagegrouptype)
                            $("#itemstate").val(data.itemstate)
                            $("#itemserviceunitname").val(data.itemservice)
                            $("#itemdepartmentitemgroup").html(data.departmentitemgroup)
                        })

                        getStockItemPrice()

                    })
            })

            $("#update-combinedprice-button").on("click", function(evt){
                evt.preventDefault()
                let stockitemid = $("#stockitemid").val()
                //console.log(combinedtotalprice)
                if(combinedtotalprice!=0){
                    let combineditemprofit = combinedmarkupprice - combinedtotalprice
                    let itemid = $("#itemid").val()
                    let stocklistitemid = $("#stocklistid").val()
                    // $("#stocklistid").val(data.records[0].id)
                    let stockitemid = $("#stockitemid").val()
                    let genericname = $("#combinedselectitem").val()
                    let stockcode = $("#stocknumber").val()
                    let stocknumber = $("#stockitemnumber").val()
                    //let usagegrouptype = $("#usagegrouptype").val()
                    let itemstate = $("#itemstate").val()
                    let previousquantity = 0
                    let suppliername = $("#selectsupplier").val()
                    let invoicenumber = ""
                    let invoicedate = ""
                    let invoiceamount = 0.0
                    let itemamount = combinedtotalprice
                    let stocktype = $("#stocktype").val()
                    let package = ""
                    //previousquantity = parseInt(previousquantity) + parseInt(finalpieces)
                    let totalpieces = 0
                    let totalweight = 0
                    let unitpriceperpiece = combinedtotalprice
                    let unitpriceperstrength = 0.0
                    let percentagemarkup = $("#markuppricecombined").val()
                    let itemsellingprice = combinedmarkupprice
                    let itemprofit = combineditemprofit
                    let itempercentageprofit = combinedpercentageprofit
                    console.log(stocklistitemid, itemamount, unitpriceperpiece, itemsellingprice)
                    combinedpricingvalue = JSON.stringify(combinedpricingvaluearray)
                    let updateStockListItem = "updateStockListItem"

                    $.post("controllers/combo-setup.php",{
                        itemid:itemid,
                        stocklistitemid:stocklistitemid,
                        stockitemid:stockitemid,
                        genericname:genericname,
                        stockcode:stockcode,
                        stocknumber:stocknumber,
                        itemstate:itemstate,
                        previousquantity:previousquantity,
                        suppliername:suppliername,
                        invoicenumber:invoicenumber,
                        invoicedate:invoicedate,
                        invoiceamount:invoiceamount,
                        itemamount:itemamount,
                        stocktype:stocktype,
                        package:package,
                        totalpieces:totalpieces,
                        totalweight:totalweight,
                        unitpriceperpiece:unitpriceperpiece,
                        unitpriceperstrength:unitpriceperstrength,
                        percentagemarkup:percentagemarkup,
                        itemsellingprice:itemsellingprice,
                        itemprofit:itemprofit,
                        combinedpricingvalue:combinedpricingvalue,
                        itempercentageprofit:itempercentageprofit,
                        updateStockListItem:updateStockListItem
                    },function(data){
                        $("#item-combinineditems-status").html(data)
                        let splitstocklistid = data.split("- ")
                        let stockitemlistid = splitstocklistid[1]
                        $("#stocklistid").val(stockitemlistid)
                        
                        getStockItemPrice()
                    })

               }
            })

            $("#delete-packageprice-button").on("click", function(evt){
                evt.preventDefault()
                let stocklistitemid = $("#stockitemlistid").val()
                let deleteStockItemList = "deleteStockItemList"
                $.post("", {stocklistitemid:stocklistitemid, deleteStockItemList:deleteStockItemList}, function(data){
                    $("#item-packaging-status").html(data)
                       
                        getStockItemPrice()
                })
            })
            
            let combinedpricevalue = []
            $("#add-laboratoryitem-button").on("click", function(evt){
                evt.preventDefault()
            
                let genericname = $("#itemid").val()
                let getGenericNameDetails = "getGenericNameDetails"
                $.post("controllers/combo-setup.php",{searchItem:genericname,getGenericNameDetails:getGenericNameDetails},function(formdata){
                    //console.log(formdata)
                    let data = JSON.parse(formdata)
                    let itemname = data.genericname

                    let unitprice = $("#combinedprice").val()
                let unitstrength = $("#combinedunitstrength").val()
                let unit = $("#combineditemsunit").val()
                let quantity = $("#combinedquantity").val()


                let combinedpricing = {
                        genericname: itemname,
                        unitprice: unitprice,
                        unitstrength: unitstrength,
                        unit: unit,
                        quantity: quantity
                    }
                    combinedpricevalue.push(combinedpricing)
                    //console.log(packagingvalue)

                    let pricinglist = `<div class="form-group col-md-3" style="font-size:16px;">
                            
                               Item
                            </div>
                            <div class="form-group col-md-3" style="font-size:16px;">
                            
                                Unit Price
                            </div>
                            <div class="form-group col-md-2" style="font-size:16px;">
                            
                                Unit Strength
                            </div>
                            <div class="form-group col-md-2" style="font-size:16px;">
                                Unit
                            </div>
                            <div class="form-group col-md-2" style="font-size:16px;">
                                Quantity
                            </div>`
                            combinedpricevalue.forEach(element => {
                                pricinglist += `<div class="form-group col-md-3" style="font-size:18px;">` + element.genericname + `
                        
                        </div>
                        <div class="form-group col-md-3" style="font-size:18px;">` + element.unitprice + ` 
                        
                        </div>
                        <div class="form-group col-md-2" style="font-size:18px;">` + element.unitstrength + `
                        
                    </div>
                    <div class="form-group col-md-2" style="font-size:18px;">` + element.unit + `
                        
                    </div>
                    <div class="form-group col-md-2" style="font-size:18px;">` + element.quantity + `
                        
                    </div>
                        `
                    });
                    $("#combinedpricevalue").html(pricinglist)
                })
                
            })
                function oneifnull(value){
                    if(value==null){
                        return 1
                    } else if(value==""){
                        return 1
                    } else {
                        return value
                    }
                }
                function zeroifnull(value){
                    if(value==null){
                        return 0
                    } else if(value==""){
                        return 0
                    } else {
                        return parseFloat(value)
                    }
                }

                let sellingprice = 0
                let sellingpriceperstrength = 0
                let sellingpriceperliquidstrength = 0
                let sellingpriceperlength = 0
                let sellingpriceperservice = 0
                let profit = 0
                let  = 0
                let percentageprofit = 0
                $("#compute-pricing-button").on("click", function(evt){
                    evt.preventDefault()

                    
                        
                       
                        let unititemprice = unitpieceprice
                        let unititemstrengthprice = unitstrengthprice
                        let itemamount = $("#itemamount").val()
                        //console.log(unititemprice,unititemstrengthprice,itemamount)
                        if(itemamount!=""){
                            itemamount = parseInt(itemamount)
                            // unititemprice = itemamount/totalsum
                            // unitstrengthprice = itemamount / totalstrength

                            let markupprice = parseInt($("#markupprice").val())
                            //console.log(unititemprice,unititemstrengthprice,itemamount, markupprice)
                            sellingprice = ((markupprice/100) * unititemprice) + parseFloat(unititemprice)
                            sellingpriceperstrength = ((markupprice/100) * unitstrengthprice) + parseFloat(unitstrengthprice)
                            sellingpriceperliquidstrength = ((markupprice/100) * unitliquidstrengthprice) + parseFloat(unitliquidstrengthprice)
                            sellingpriceperlength = ((markupprice/100) * unitlengthprice) + parseFloat(unitlengthprice)
                            sellingpriceperservice = ((markupprice/100) * unitserviceprice) + parseFloat(unitserviceprice)
                            profit = sellingprice - unititemprice
                            percentageprofit = (profit/unititemprice) * 100
                            //console.log(sellingprice)
                            let sellingpricedetails = `

                                Selling Price Per Piece: ` + sellingprice.toFixed(2) + ` Naira<br>
                                Selling Price Per Weight: ` + sellingpriceperstrength.toFixed(2) + ` Naira<br>
                                Selling Price Per Volume: ` + sellingpriceperliquidstrength.toFixed(2) + ` Naira<br>
                                Selling Price Per Length: ` + sellingpriceperlength.toFixed(2) + ` Naira<br>
                                Selling Price Per Service: ` + sellingpriceperservice.toFixed(2) + ` Naira<br>
                                Profit(Per Item): ` + profit.toFixed(2) + ` Naira<br>
                                Percentage Profit: ` + percentageprofit + `%
                            `
                            $("#sellingprice").html(sellingpricedetails)
                        } else {
                            $("#item-packaging-status").html("Please Enter Amount For Item")
                        }



                    });

                    $("#markupprice").on("keyup change", function(evt){
                        evt.preventDefault()

                    
                        
                       
                        let unititemprice = unitpieceprice
                        let unititemstrengthprice = unitstrengthprice
                        let itemamount = $("#itemamount").val()
                        //console.log(unititemprice,unititemstrengthprice,itemamount)
                        if(itemamount!=""){
                            itemamount = parseInt(itemamount)
                            // unititemprice = itemamount/totalsum
                            // unitstrengthprice = itemamount / totalstrength

                            let markupprice = parseInt($("#markupprice").val())
                            //console.log(unititemprice,unititemstrengthprice,itemamount, markupprice)
                            
                            sellingprice = ((markupprice/100) * unititemprice) + parseFloat(unititemprice)
                            sellingpriceperstrength = ((markupprice/100) * unitstrengthprice) + parseFloat(unitstrengthprice)
                            sellingpriceperliquidstrength = ((markupprice/100) * unitliquidstrengthprice) + parseFloat(unitliquidstrengthprice)
                            sellingpriceperlength = ((markupprice/100) * unitlengthprice) + parseFloat(unitlengthprice)
                            sellingpriceperservice = ((markupprice/100) * unitserviceprice) + parseFloat(unitserviceprice)
                            profit = sellingprice - unititemprice
                            percentageprofit = (profit/unititemprice) * 100
                            //console.log(sellingprice)
                            let sellingpricedetails = `

                                Selling Price Per Piece: ` + sellingprice.toFixed(2) + ` Naira<br>
                                Selling Price Per Weight: ` + sellingpriceperstrength.toFixed(2) + ` Naira<br>
                                Selling Price Per Volume: ` + sellingpriceperliquidstrength.toFixed(2) + ` Naira<br>
                                Selling Price Per Length: ` + sellingpriceperlength.toFixed(2) + ` Naira<br>
                                Selling Price Per Service: ` + sellingpriceperservice.toFixed(2) + ` Naira<br>
                                Profit(Per Item): ` + profit.toFixed(2) + ` Naira<br>
                                Percentage Profit: ` + percentageprofit + `%
                            `
                            $("#sellingprice").html(sellingpricedetails)
                        } else {
                            $("#item-packaging-status").html("Please Enter Amount For Item")
                        }

                      

                    })

                    $("#markuppricetext").on("keyup change", function(evt){
                        evt.preventDefault()

                    
                        
                       console.log(unitpieceprice)
                        let unititemprice = unitpieceprice
                        let unititemstrengthprice = unitstrengthprice
                        let itemamount = $("#itemamount").val()
                        //console.log(unititemprice,unititemstrengthprice,itemamount)
                        if(itemamount!=""){
                            itemamount = parseFloat(itemamount)
                            // unititemprice = itemamount/totalsum
                            // unitstrengthprice = itemamount / totalstrength

                            let markupprice = parseFloat($("#markuppricetext").val())
                            //console.log(unititemprice,unititemstrengthprice,itemamount, markupprice)
                            sellingprice = markupprice
                            let markupdifference = sellingprice - unititemprice
                            let percentagemarkup = (markupdifference / unititemprice) * 100
                            $("#markupprice").val(percentagemarkup)
                            // sellingprice = ((markupprice/100) * unititemprice) + parseFloat(unititemprice)
                            sellingpriceperstrength = ((percentagemarkup/100) * unitstrengthprice) + parseFloat(unitstrengthprice)
                            sellingpriceperliquidstrength = ((percentagemarkup/100) * unitliquidstrengthprice) + parseFloat(unitliquidstrengthprice)
                            sellingpriceperlength = ((percentagemarkup/100) * unitlengthprice) + parseFloat(unitlengthprice)
                            sellingpriceperservice = ((percentagemarkup/100) * unitserviceprice) + parseFloat(unitserviceprice)
                            profit = sellingprice - unititemprice
                            percentageprofit = (profit/unititemprice) * 100
                            //console.log(sellingprice)
                            let sellingpricedetails = `

                                Selling Price Per Piece: ` + sellingprice.toFixed(2) + ` Naira<br>
                                Selling Price Per Weight: ` + sellingpriceperstrength.toFixed(2) + ` Naira<br>
                                Selling Price Per Volume: ` + sellingpriceperliquidstrength.toFixed(2) + ` Naira<br>
                                Selling Price Per Length: ` + sellingpriceperlength.toFixed(2) + ` Naira<br>
                                Selling Price Per Service: ` + sellingpriceperservice.toFixed(2) + ` Naira<br>
                                Profit(Per Item): ` + profit.toFixed(2) + ` Naira<br>
                                Percentage Profit: ` + percentageprofit + `%
                            `
                            $("#sellingprice").html(sellingpricedetails)
                        } else {
                            $("#item-packaging-status").html("Please Enter Amount For Item")
                        }

                      

                    })

                    $("#markupstrengthpricetext").on("keyup change", function(evt){
                        evt.preventDefault()

                    
                        
                       
                        let unititemprice = unitpieceprice
                        let unititemstrengthprice = unitstrengthprice
                        let itemamount = $("#itemamount").val()
                        // console.log(unititemprice,unititemstrengthprice,itemamount)
                        if(itemamount!=""&&unititemstrengthprice!=0){
                            itemamount = parseFloat(itemamount)
                            // unititemprice = itemamount/totalsum
                            // unitstrengthprice = itemamount / totalstrength

                            let markupprice = parseFloat($("#markupstrengthpricetext").val())
                            //console.log(unititemprice,unititemstrengthprice,itemamount, markupprice)
                            sellingpriceperstrength = markupprice
                            let markupdifference = sellingpriceperstrength - unititemstrengthprice
                            let percentagemarkup = (markupdifference / unititemstrengthprice) * 100
                            $("#markupprice").val(percentagemarkup)
                            sellingprice = ((percentagemarkup/100) * unititemprice) + parseFloat(unititemprice)
                            // sellingpriceperstrength = ((percentagemarkup/100) * unitstrengthprice) + parseFloat(unitstrengthprice)
                            sellingpriceperliquidstrength = ((percentagemarkup/100) * unitliquidstrengthprice) + parseFloat(unitliquidstrengthprice)
                            sellingpriceperlength = ((percentagemarkup/100) * unitlengthprice) + parseFloat(unitlengthprice)
                            sellingpriceperservice = ((percentagemarkup/100) * unitserviceprice) + parseFloat(unitserviceprice)
                            profit = sellingprice - unititemprice
                            percentageprofit = (profit/unititemprice) * 100
                            //console.log(sellingprice)
                            let sellingpricedetails = `

                                Selling Price Per Piece: ` + sellingprice.toFixed(2) + ` Naira<br>
                                Selling Price Per Weight: ` + sellingpriceperstrength.toFixed(2) + ` Naira<br>
                                Selling Price Per Volume: ` + sellingpriceperliquidstrength.toFixed(2) + ` Naira<br>
                                Selling Price Per Length: ` + sellingpriceperlength.toFixed(2) + ` Naira<br>
                                Selling Price Per Service: ` + sellingpriceperservice.toFixed(2) + ` Naira<br>
                                Profit(Per Item): ` + profit.toFixed(2) + ` Naira<br>
                                Percentage Profit: ` + percentageprofit + `%
                            `
                            $("#sellingprice").html(sellingpricedetails)
                        } else {
                            $("#item-packaging-status").html("Please Enter Amount For Item")
                        }

                      

                    })

                    $("#markupliquidstrengthpricetext").on("keyup change", function(evt){
                        evt.preventDefault()

                    
                        
                       
                        let unititemprice = unitpieceprice
                        let unititemstrengthprice = unitstrengthprice
                        let itemamount = $("#itemamount").val()
                        //console.log(unititemprice,unititemstrengthprice,itemamount)
                        if(itemamount!=""&&unitliquidstrengthprice!=0){
                            itemamount = parseFloat(itemamount)
                            // unititemprice = itemamount/totalsum
                            // unitstrengthprice = itemamount / totalstrength

                            let markupprice = parseFloat($("#markupliquidstrengthpricetext").val())
                            //console.log(unititemprice,unititemstrengthprice,itemamount, markupprice)
                            sellingpriceperliquidstrength = markupprice
                            let markupdifference = sellingpriceperliquidstrength - unitliquidstrengthprice
                            let percentagemarkup = (markupdifference / unitliquidstrengthprice) * 100
                            $("#markupprice").val(percentagemarkup)
                            sellingprice = ((percentagemarkup/100) * unititemprice) + parseFloat(unititemprice)
                            sellingpriceperstrength = ((percentagemarkup/100) * unitstrengthprice) + parseFloat(unitstrengthprice)
                            // sellingpriceperliquidstrength = ((percentagemarkup/100) * unitliquidstrengthprice) + parseFloat(unitliquidstrengthprice)
                            sellingpriceperlength = ((percentagemarkup/100) * unitlengthprice) + parseFloat(unitlengthprice)
                            sellingpriceperservice = ((percentagemarkup/100) * unitserviceprice) + parseFloat(unitserviceprice)
                            profit = sellingprice - unititemprice
                            percentageprofit = (profit/unititemprice) * 100
                            //console.log(sellingprice)
                            let sellingpricedetails = `

                                Selling Price Per Piece: ` + sellingprice.toFixed(2) + ` Naira<br>
                                Selling Price Per Weight: ` + sellingpriceperstrength.toFixed(2) + ` Naira<br>
                                Selling Price Per Volume: ` + sellingpriceperliquidstrength.toFixed(2) + ` Naira<br>
                                Selling Price Per Length: ` + sellingpriceperlength.toFixed(2) + ` Naira<br>
                                Selling Price Per Service: ` + sellingpriceperservice.toFixed(2) + ` Naira<br>
                                Profit(Per Item): ` + profit.toFixed(2) + ` Naira<br>
                                Percentage Profit: ` + percentageprofit + `%
                            `
                            $("#sellingprice").html(sellingpricedetails)
                        } else {
                            $("#item-packaging-status").html("Please Enter Amount For Item")
                        }

                      

                    })

                    $("#markuplengthstrengthpricetext").on("keyup change", function(evt){
                        evt.preventDefault()

                    
                        
                       
                        let unititemprice = unitpieceprice
                        let unititemstrengthprice = unitstrengthprice
                        let itemamount = $("#itemamount").val()
                        //console.log(unititemprice,unititemstrengthprice,itemamount)
                        if(itemamount!=""&&unitlengthprice!=0){
                            itemamount = parseFloat(itemamount)
                            // unititemprice = itemamount/totalsum
                            // unitstrengthprice = itemamount / totalstrength

                            let markupprice = parseFloat($("#markuplengthstrengthpricetext").val())
                            //console.log(unititemprice,unititemstrengthprice,itemamount, markupprice)
                            sellingpriceperlength = markupprice
                            let markupdifference = sellingpriceperlength - unitlengthprice
                            let percentagemarkup = (markupdifference / unitlengthprice) * 100
                            $("#markupprice").val(percentagemarkup)
                            sellingprice = ((percentagemarkup/100) * unititemprice) + parseFloat(unititemprice)
                            sellingpriceperstrength = ((percentagemarkup/100) * unitstrengthprice) + parseFloat(unitstrengthprice)
                            sellingpriceperliquidstrength = ((percentagemarkup/100) * unitliquidstrengthprice) + parseFloat(unitliquidstrengthprice)
                            // sellingpriceperlength = ((percentagemarkup/100) * unitlengthprice) + parseFloat(unitlengthprice)
                            sellingpriceperservice = ((percentagemarkup/100) * unitserviceprice) + parseFloat(unitserviceprice)
                            profit = sellingprice - unititemprice
                            percentageprofit = (profit/unititemprice) * 100
                            //console.log(sellingprice)
                            let sellingpricedetails = `

                                Selling Price Per Piece: ` + sellingprice.toFixed(2) + ` Naira<br>
                                Selling Price Per Weight: ` + sellingpriceperstrength.toFixed(2) + ` Naira<br>
                                Selling Price Per Volume: ` + sellingpriceperliquidstrength.toFixed(2) + ` Naira<br>
                                Selling Price Per Length: ` + sellingpriceperlength.toFixed(2) + ` Naira<br>
                                Selling Price Per Service: ` + sellingpriceperservice.toFixed(2) + ` Naira<br>
                                Profit(Per Item): ` + profit.toFixed(2) + ` Naira<br>
                                Percentage Profit: ` + percentageprofit + `%
                            `
                            $("#sellingprice").html(sellingpricedetails)
                        } else {
                            $("#item-packaging-status").html("Please Enter Amount For Item")
                        }

                      

                    })

                    $("#markupservicestrengthpricetext").on("keyup change", function(evt){
                        evt.preventDefault()

                    
                        
                       
                        let unititemprice = unitpieceprice
                        let unititemstrengthprice = unitstrengthprice
                        let itemamount = $("#itemamount").val()
                        //console.log(unititemprice,unititemstrengthprice,itemamount)
                        if(itemamount!=""&&unitserviceprice!=0){
                            itemamount = parseFloat(itemamount)
                            // unititemprice = itemamount/totalsum
                            // unitstrengthprice = itemamount / totalstrength

                            let markupprice = parseFloat($("#markupservicestrengthpricetext").val())
                            //console.log(unititemprice,unititemstrengthprice,itemamount, markupprice)
                            sellingpriceperservice = markupprice
                            let markupdifference = sellingpriceperservice - unitserviceprice
                            let percentagemarkup = (markupdifference / unitserviceprice) * 100
                            $("#markupprice").val(percentagemarkup)
                            sellingprice = ((percentagemarkup/100) * unititemprice) + parseFloat(unititemprice)
                            sellingpriceperstrength = ((percentagemarkup/100) * unitstrengthprice) + parseFloat(unitstrengthprice)
                            sellingpriceperliquidstrength = ((percentagemarkup/100) * unitliquidstrengthprice) + parseFloat(unitliquidstrengthprice)
                            sellingpriceperlength = ((percentagemarkup/100) * unitlengthprice) + parseFloat(unitlengthprice)
                            profit = sellingprice - unititemprice
                            percentageprofit = (profit/unititemprice) * 100
                            //console.log(sellingprice)
                            let sellingpricedetails = `

                                Selling Price Per Piece: ` + sellingprice.toFixed(2) + ` Naira<br>
                                Selling Price Per Weight: ` + sellingpriceperstrength.toFixed(2) + ` Naira<br>
                                Selling Price Per Volume: ` + sellingpriceperliquidstrength.toFixed(2) + ` Naira<br>
                                Selling Price Per Length: ` + sellingpriceperlength.toFixed(2) + ` Naira<br>
                                Selling Price Per Service: ` + sellingpriceperservice.toFixed(2) + ` Naira<br>
                                Profit(Per Item): ` + profit.toFixed(2) + ` Naira<br>
                                Percentage Profit: ` + percentageprofit + `%
                            `
                            $("#sellingprice").html(sellingpricedetails)
                        } else {
                            $("#item-packaging-status").html("Please Enter Amount For Item")
                        }

                      

                    })

                    $("#save-packageprice-button").on("click", function(evt){
                        evt.preventDefault()
                        let itemid = $("#itemid").val()
                        let stockitemid = $("#stockitemid").val()
                        let genericname = $("#selectitem").val()
                        let stockcode = $("#stocknumber").val()
                        let stocknumber = $("#stockitemnumber").val()
                        //let usagegrouptype = $("#usagegrouptype").val()
                        let itemstate = $("#itemstate").val()
                        let previousquantity = $("#previousquantity").val()
                        let suppliername = $("#selectsupplier").val()
                        let invoicenumber = $("#invoicenumber").val()
                        let invoicedate = $("#invoicedate").val()
                        let invoiceamount = $("#invoiceamount").val()
                        let itemamount = zeroifnull($("#itemamount").val())
                        let stocktype = $("#stocktype").val()
                        let package = JSON.stringify(packagingvalue)

                        let totalug = $("#totalmicrogram").text()
                        if(totalug!=""||totalug!=null){
                            let splittotalug = totalug.split(" ")
                            totalug = splittotalug[0]
                        } else {
                            totalug=0
                        }
                        let totaliu = $("#totalinternationalunit").text()
                        if(totaliu!=""||totaliu!=null){
                            let splittotaliu = totaliu.split(" ")
                            totaliu = splittotaliu[0]
                        } else {
                            totaliu=0
                        }
                        if(totalug==""||totalug==" "){
                            totalug=0
                        }
                        if(totaliu==""||totaliu==" "){
                            totaliu=0
                        }
                        console.log(totalug,totaliu)
                        //previousquantity = parseInt(previousquantity) + parseInt(finalpieces)
                        let totalpieces = finalpieces
                        let totalweight = $("#totalstrength").text()
                        let splittotalweight = totalweight.split(" ")
                        totalweight = splittotalweight[0]
                        let totalvolume = $("#totalliquidstrength").text()
                        let splittotalvolume = totalvolume.split(" ")
                        totalvolume = splittotalvolume[0]
                        let totallength = $("#totallength").text()
                        let splittotallength = totallength.split(" ")
                        totallength = splittotallength[0]
                        let totalweightmg = $("#totalstrengthmg").text()
                        let splittotalaweightmg = totalweightmg.split(" ")
                        totalweightmg = splittotalaweightmg[0]
                        let totalweightkg = $("#totalstrengthkg").text()
                        let splittotalaweightkg = totalweightkg.split(" ")
                        totalweightkg = splittotalaweightkg[0]
                        let totalduration = $("#totalduration").text()
                        let totalvolumeml = $("#totalliquidstrengthml").text()
                        let splittotalvolumeml = totalvolumeml.split(" ")
                        totalvolumeml = splittotalvolumeml[0]
                        let totallengthcm = $("#totallengthcm").text()
                        let totaldurationdays = $("#totaldurationdays").text()
                        let splittotallengthcm = totallengthcm.split(" ")
                        totallengthcm = splittotallengthcm[0]
                        previousquantity = parseFloat(previousquantity) + parseFloat(totalpieces)
                        let unitpriceperpiece = $("#unitpriceperpiece").val()
                        let unitpriceperstrength = $("#unitpriceperstrength").val()
                        let unitpriceperliquidstrength = $("#unitpriceperliquidstrength").val()
                        let unitpriceperlength= $("#unitpriceperlength").val()
                        let unitpriceperservice= $("#unitpriceperservice").val()
                        let unitpriceperug= $("#unitpriceperug").val()
                        let unitpriceperiu= $("#unitpriceperiu").val()
                       
                        let percentagemarkup = $("#markupprice").val()
                        let itemsellingprice = sellingprice
                        let itemsellingpriceperstrength = sellingpriceperstrength
                        let itemsellingpriceperliquidstrength = sellingpriceperliquidstrength
                        let itemsellingpriceperlength = sellingpriceperlength
                        let itemsellingpriceperservice = sellingpriceperservice
                        //console.log(unitpriceperpiece,unitpriceperstrength,unitpriceperliquidstrength)
                        //console.log(itemsellingprice,itemsellingpriceperstrength,itemsellingpriceperliquidstrength)
                        let itemprofit = profit
                        let combinedpricingvalue = ""
                        let itempercentageprofit = percentageprofit
                        let weightunit = $("#weightunit").val()
                        let volumeunit = $("#volumeunit").val()
                        let lengthunit = $("#lengthunit").val()
                        let serviceunit = $("#serviceunit").val()
                        let insertStockListItem = "insertStockListItem"

                        $.post("controllers/combo-setup.php",{
                            itemid:itemid,
                            stockitemid:stockitemid,
                            genericname:genericname,
                            weightunit:weightunit,
                            lengthunit:lengthunit,
                            volumeunit:volumeunit,
                            serviceunit:serviceunit,
                            stockcode:stockcode,
                            stocknumber:stocknumber,
                            itemstate:itemstate,
                            previousquantity:previousquantity,
                            suppliername:suppliername,
                            invoicenumber:invoicenumber,
                            invoicedate:invoicedate,
                            invoiceamount:invoiceamount,
                            itemamount:itemamount,
                            stocktype:stocktype,
                            package:package,
                            totalpieces:totalpieces,
                            totalweight:totalweight,
                            totaliu:totaliu,
                            totalug:totalug,
                            totalvolume: totalvolume,
                            totallength: totallength,
                            totalweightmg: totalweightmg,
                            totalweightkg:totalweightkg,
                            totalvolumeml: totalvolumeml,
                            totallengthcm: totallengthcm,
                            unitpriceperpiece:unitpriceperpiece,
                            unitpriceperstrength:unitpriceperstrength,
                            unitpriceperliquidstrength:unitpriceperliquidstrength,
                            unitpriceperlength:unitpriceperlength,
                            unitpriceperservice:unitpriceperservice,
                            unitpriceperug:unitpriceperug,
                            unitpriceperiu:unitpriceperiu,
                            percentagemarkup:percentagemarkup,
                            combinedpricingvalue:combinedpricingvalue,
                            itemsellingprice:itemsellingprice,
                            itemsellingpriceperstrength:itemsellingpriceperstrength,
                            itemsellingpriceperliquidstrength:itemsellingpriceperliquidstrength,
                            itemsellingpriceperlength:itemsellingpriceperlength,
                            itemsellingpriceperservice:itemsellingpriceperservice,
                            totaldurationdays:totaldurationdays,
                            totalduration:totalduration,
                            itemprofit:itemprofit,
                            itempercentageprofit:itempercentageprofit,
                            insertStockListItem:insertStockListItem
                        },function(data){
                            $("#item-packaging-status").html(data)
                            let splitstocklistid = data.split("- ")
                            let stockitemlistid = splitstocklistid[1]
                            $("#stocklistid").val(stockitemlistid)
                           
                            getStockItemPrice()
                        })




                    })

                    $("#add-organizationdiscount-button").on("click", function(evt){
                        evt.preventDefault()
                        let itemid = $("#itemid").val()
                        let stockitemid = $("#stockitemid").val()
                        let item = $("#selectitem").val()
                        let stockitem = $("#stocknumber").val()
                        let stockitemlistid = $("#stocklistid").val()
                        let organizationid = $("#organizationid").val()
                        let organization = $("#organization").val()
                        let discount = parseFloat($("#organizationdiscount").val())
                        let unitpriceperpiece = $("#unitpriceperpiece").val()
                        
                        if(discount>100){
                            discount = 100
                        }
                        let itemprofit = parseFloat(profit)

                        let organizationprofit = parseFloat((discount/100)*itemprofit)
                        organizationprofit = itemprofit - organizationprofit
                        let organizationsellingprice = parseFloat(organizationprofit) + parseFloat(unitpriceperpiece)
                        //console.log(organizationsellingprice,organizationprofit,unitpriceperpiece,discount)
                        let insertOrganizationSellingPrice = "insertOrganizationSellingPrice" 

                        $.post("controllers/combo-setup.php",{
                            itemid:itemid,
                            stockitemid:stockitemid,
                            item:item,
                            stockitem:stockitem,
                            stockitemlistid:stockitemlistid,
                            organizationid:organizationid,
                            organization:organization,
                            discount:discount,
                            cost:unitpriceperpiece,
                            profit:organizationprofit,
                            price:organizationsellingprice,
                            insertOrganizationSellingPrice:insertOrganizationSellingPrice
                        },function(data){
                            $("#item-organization-status").html(data)
                            // let splitstocklistid = splitstocklistid.split("- ")
                            // let stockitemlistid = splitstocklistid[1]
                            // $("#stocklistid").val(stockitemlistid)
                            getOrganizationPrice()
                        })

                    })

                    


                //Advanced Search for pricing
                $("#form, #deptitemgroup, #group,#class,#subclass,#prescriptionnumber,#routinename,#add-regiment-button,#recall-itemorder-button").hide()
                 $("#advancesearch").on("change", function(evt){
                     evt.preventDefault()
                     $("#searchitems").val("")
                     if($("#advancesearch").val()=="itemgrouping"){
                         searchAllItem = ""
                         $("#itemgrouping").show()
                         $("#add-allitem-button").show()
                         $("#form, #deptitemgroup, #group,#class,#subclass,#prescriptionnumber,#routinename,#add-regiment-button,#recall-itemorder-button").hide()
                     } else if($("#advancesearch").val()=="group"){
                         $("#group").show()
                         $("#add-allitem-button").show()
                         $("#form, #deptitemgroup, #itemgrouping,#class,#subclass,#prescriptionnumber,#routinename,#add-regiment-button,#recall-itemorder-button").hide()
                     } else if($("#advancesearch").val()=="class"){
                         $("#class").show()
                         $("#add-allitem-button").show()
                         $("#form, #deptitemgroup, #itemgrouping,#group,#subclass,#prescriptionnumber,#routinename,#add-regiment-button,#recall-itemorder-button").hide()
 
                         // get all classes
                         let selectgroup = ""
                             let getItemClassByDeptItemGroup = "getItemClassByDeptItemGroup"
                             $.post("controllers/combo-setup.php",{searchItem:selectgroup,getItemClassByDeptItemGroup:getItemClassByDeptItemGroup},function(formdata){
                                 //console.log(formdata)
                                 let data = JSON.parse(formdata)
                                 let genericnameclassoptions = ``
                                 $.each(data.records, function(key, val) {
                                 
                                     genericnameclassoptions += `
                                     <option value="` + val.itemclass + `">` + val.itemclass + `</option>
                                     `
                                 })
                                 genericnameusageclasslist = genericnameclassoptions
                                 $("#selectusageclassclass").html(genericnameclassoptions)
                                 let selectsubclassclass = $("#selectusageclassclass").val()
                                 let getItemSubClassByClass = "getItemSubClassByClass"
                                 $.post("controllers/combo-setup.php",{selectsubclassclass:selectsubclassclass,getItemSubClassByClass:getItemSubClassByClass},function(formdata){
                                     //console.log(formdata)
                                     let data = JSON.parse(formdata)
                                     let genericnamesubclassoptions = `<option value="">Select Sub Class</option>`
                                     $.each(data.records, function(key, val) {
                                     
                                         genericnamesubclassoptions += `
                                         <option value="` + val.itemsubclass + `">` + val.itemsubclass + `</option>
                                         `
                                     })
                                     genericnameusagesubclasslist = genericnamesubclassoptions
                                     $("#selectusagesubclassclass").html(genericnamesubclassoptions)
                                     let searchItem = $("#searchitems").val()
                                     let selectsubclass = $("#selectusagesubclassclass").val()
                                     let GetGenericNameByUsageDeptItemGrpSubClassPricing = "GetGenericNameByUsageDeptItemGrpSubClassPricing"
                                     $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectsubclass,GetGenericNameByUsageDeptItemGrpSubClassPricing:GetGenericNameByUsageDeptItemGrpSubClassPricing},function(formdata){
                                         //console.log(formdata)
                                         if(formdata!="No Record Found"){
                                             let data = JSON.parse(formdata)
                                             let count = 0
                                                
                                                let genericnameoptions = ``
                                                $.each(data.records, function(key, val) {
                                                    count++
                                                    genericnameoptions += `
                                                    <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                                `
                                             })
                                           
                                             //console.log(deptitemgrpitems)
                                             genericnamelist = genericnameoptions
                                             itemlist = data.records
                                             $("#combineditems").html(genericnameoptions)
                                            
                                             
                                             let searchItem = $("#combineditems").val()
                                                let splitsearchItem = searchItem.split(",")
                                                searchItem = splitsearchItem[2]
                                                getCombinedItemsDetails(searchItem)
                                         } else {
                                            $("#combineditems").html("<option value='None'>No Items</option>")
                                         }
                                     
                                     })
                                 })
                             })
                     } else if($("#advancesearch").val()=="subclass"){
                         $("#subclass").show()
                         $("#add-allitem-button").show()
                         $("#form, #deptitemgroup, #itemgrouping,#group,#class,#prescriptionnumber,#routinename,#add-regiment-button,#recall-itemorder-button").hide()
 
                         // get all sub-classes
                         let selectgroup = ""
                            
                                 let getItemSubClassByDeptItemGroup = "getItemSubClassByDeptItemGroup"
                                 $.post("controllers/combo-setup.php",{selectsubclassclass:selectgroup,getItemSubClassByDeptItemGroup:getItemSubClassByDeptItemGroup},function(formdata){
                                     //console.log(formdata)
                                     let data = JSON.parse(formdata)
                                     let genericnamesubclassoptions = ``
                                     $.each(data.records, function(key, val) {
                                     
                                         genericnamesubclassoptions += `
                                         <option value="` + val.itemsubclass + `">` + val.itemsubclass + `</option>
                                         `
                                     })
                                     genericnameusagesubclasslist = genericnamesubclassoptions
                                     $("#selectusagesubclasssubclass").html(genericnamesubclassoptions)
                                     let searchItem = $("#searchitems").val()
                                     let selectsubclass = $("#selectusagesubclasssubclass").val()
                                     let GetGenericNameByUsageDeptItemGrpSubClassPricing = "GetGenericNameByUsageDeptItemGrpSubClassPricing"
                                     $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectsubclass,GetGenericNameByUsageDeptItemGrpSubClassPricing:GetGenericNameByUsageDeptItemGrpSubClassPricing},function(formdata){
                                         //console.log(formdata)
                                         if(formdata!="No Record Found"){
                                             let data = JSON.parse(formdata)
                                             let count = 0
                                                            
                                            let genericnameoptions = ``
                                            $.each(data.records, function(key, val) {
                                                count++
                                                genericnameoptions += `
                                                <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                            `
                                            })
                                             //console.log(deptitemgrpitems)
                                             genericnamelist = genericnameoptions
                                             itemlist = data.records
                                             $("#combineditems").html(genericnameoptions)
                                            
                                             let searchItem = $("#combineditems").val()
                                            let splitsearchItem = searchItem.split(",")
                                            searchItem = splitsearchItem[2]
                                            getCombinedItemsDetails(searchItem)
                                         } else {
                                            $("#combineditems").html("<option value='None'>No Items</option>")
                                         }
                                     
                                     })
                                 })
                         
                     } else if($("#advancesearch").val()=="form"){
                         $("#form").show()
                         $("#add-allitem-button").show()
                         $("#subclass, #deptitemgroup, #itemgrouping,#group,#class,#prescriptionnumber,#routinename,#add-regiment-button,#recall-itemorder-button").hide()
 
                         // get all sub-classes
                         let selectgroup = ""
                            
                                 let getFormByDeptItemGroup = "getFormByDeptItemGroup"
                                 $.post("controllers/combo-setup.php",{selectsubclassclass:selectgroup,getFormByDeptItemGroup:getFormByDeptItemGroup},function(formdata){
                                     //console.log(formdata)
                                     let data = JSON.parse(formdata)
                                     let genericnamesubclassoptions = ``
                                     $.each(data.records, function(key, val) {
                                     
                                         genericnamesubclassoptions += `
                                         <option value="` + val.itemform + `">` + val.itemform + `</option>
                                         `
                                     })
                                     // genericnameusagesubclasslist = genericnamesubclassoptions
                                     $("#selectform").html(genericnamesubclassoptions)
                                     let searchItem = $("#searchitems").val()
                                     let selectsubclass = $("#selectform").val()
                                     let GetGenericNameByFormDeptItemGrpPricing = "GetGenericNameByFormDeptItemGrpPricing"
                                     $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectsubclass,GetGenericNameByFormDeptItemGrpPricing:GetGenericNameByFormDeptItemGrpPricing},function(formdata){
                                         //console.log(formdata)
                                         if(formdata!="No Record Found"){
                                             let data = JSON.parse(formdata)
                                             let count = 0
                                                
                                            let genericnameoptions = ``
                                            $.each(data.records, function(key, val) {
                                                count++
                                                genericnameoptions += `
                                                <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                            `
                                            })
                                             //console.log(deptitemgrpitems)
                                             genericnamelist = genericnameoptions
                                             itemlist = data.records
                                             $("#combineditems").html(genericnameoptions)
                                             let searchItem = $("#combineditems").val()
                                            let splitsearchItem = searchItem.split(",")
                                            searchItem = splitsearchItem[2]
                                            getCombinedItemsDetails(searchItem)
                                         } else {
                                             $("#combineditems").html("<option value='None'>No Items</option>")
                                         }
                                     
                                     })
                                 })
                         
                     } else if($("#advancesearch").val()=="prescriptionnumber"){
                         $("#prescriptionnumber").show()
                         $("#recall-itemorder-button").show()
                         $("#form, #deptitemgroup, #itemgrouping,#group,#subclass,#class,#routinename,#add-regiment-button,#add-allitem-button").hide()
 
                         let revenueorderid = $("#selectitemlist").val()
                     
                         patientrevenueorderlist.forEach(val => {
                         
                             if(revenueorderid==val.id){
                                 let itemorder = val.itemorder
                                 //console.log(itemorder)
                                 recallitems = JSON.parse(itemorder)
                                 orderitemlist = recallitems
                                //  let itemlist = ``
                                 let genericnameoptions = ``
                                 deptitemgrpitems = `<select id="selectdptitemgrpitem" name="selectdptitemgrpitem" class="form-control">`
 
                                 recallitems.forEach(val => {
                                    //  itemlist += `<option value="` + val.itemid + `">` + val.genericname + ` (` + val.sellingprice + `)</option>`
 
                                     genericnameoptions += `
                                     <option value="` + val.itemid + `,` + val.genericname + `">` + value.genericname + `</option>
                                     `
                                     deptitemgrpitems += `
                                     <option value="` + val.itemid + `,` + val.genericname+ `">` + value.genericname + `</option>
                                     `
                                 })
                                 // $("#selectitemlist").html(itemlist)
                                 deptitemgrpitems += `</select>`
                                 genericnamelist = genericnameoptions
                                 itemlist = recallitems
                                 $("#combineditems").html(genericnameoptions)
 
                                 let pricinglist = displayselectedlistitems + `<tr>
                                             <td></td>
                                             <td></td>
                                             <td></td>
                                             <td>
                                                     </td>
                                             <td></td>
                                             <td></td>
                                             <td></td>
                                             <td></td>
                                         </tr>`
                                 $("#view-revenue-order-list").html(pricinglist)
                                 $("#view-revenue-order-list-item").html(pricinglist)
                                 $("#view-revenue-order-list-lab").html(pricinglist)
                                 $("#selectdptitemgrpitem").on("change", function(evt){
                                     evt.preventDefault()
                                     let selecteditem = $("#selectdptitemgrpitem").val()
                                     selectitemanddisplay(selecteditem)
                                 })
                                 $(".additemtolist").on("click", function(evt){
 
                                     evt.preventDefault()
                                     let selecteditem = $("#selectdptitemgrpitem").val()
                                     selectitemanddisplay(selecteditem)
                                 })
                             }
                         
                         });
                     } else if($("#advancesearch").val()=="routinename"){
                         $("#routinename").show()
                         $("#add-regiment-button").show()
                         $("#form, #deptitemgroup, #itemgrouping,#group,#subclass,#prescriptionnumber,#class,#add-allitem-button,#recall-itemorder-button").hide()
 
                         let getItemRegiment = "getItemRegiment"
                         $.post("controllers/combo-setup.php",{getItemRegiment:getItemRegiment},function(data){
                             if(data!="No Record Found"){
                                 // //console.log(data)
                                 let formdata = JSON.parse(data)
                                 itemregimentarray = formdata.records
                                 let itemregimentlist = ``
                                 formdata.records.forEach(val => {
                                     itemregimentlist += `<option value="` + val.id + `,` + val.regimentname + `">` + val.regimentname + `</option>`
                                 });
                                 $("#selectregiment").html(itemregimentlist)
 
                                 let regimentname = $("#selectregiment").val()
                                 let splitregimentname = regimentname.split(",")
                                 regimentname = splitregimentname[1]
                                 itemregimentarray.forEach(val => {
                                     if(regimentname == val.regimentname){
                                         //console.log(val.regiment)
                                         let regimentlist = JSON.parse(val.regiment)
                                        //  combinedpricingvaluearray = regimentlist
 
                                         let genericnameoptions = ``
                                         deptitemgrpitems = `<select id="selectdptitemgrpitem" name="selectdptitemgrpitem" class="form-control">`
 
                                         let regimentlistitems = ``
                                         let count = 0
                                         regimentlist.forEach(value => {
                                            // combinedpricingvaluearray.push(value)
                                             regimentlistitems += `<option value="` + count + `,` + value.itemid + `">` + value.itemname + `</option>`
 
                                             genericnameoptions += `
                                             <option value="` + value.itemid + `,` + value.itemname + `">` + value.itemname + `</option>
                                             `
                                             deptitemgrpitems += `
                                             <option value="` + value.itemid + `,` + value.itemname+ `">` + value.itemname + `</option>
                                             `
                                              count++
                                         });
                                         // $("#itemregimentslist").html(regimentlistitems)
                                         deptitemgrpitems += `</select>`
 
                                         genericnamelist = genericnameoptions
                                         itemlist = regimentlist
                                         $("#combineditems").html(genericnameoptions)
 
                                         let pricinglist = displayselectedlistitems + `<tr>
                                                     <td></td>
                                                     <td></td>
                                                     <td></td>
                                                     <td>
                                                             </td>
                                                     <td></td>
                                                     <td></td>
                                                     <td></td>
                                                     <td></td>
                                                 </tr>`
                                         $("#view-revenue-order-list").html(pricinglist)
                                         $("#view-revenue-order-list-item").html(pricinglist)
                                         $("#view-revenue-order-list-lab").html(pricinglist)
                                         $("#selectdptitemgrpitem").on("change", function(evt){
                                             evt.preventDefault()
                                             let selecteditem = $("#selectdptitemgrpitem").val()
                                             selectitemanddisplay(selecteditem)
                                         })
                                         $(".additemtolist").on("click", function(evt){
 
                                             evt.preventDefault()
                                             let selecteditem = $("#selectdptitemgrpitem").val()
                                             selectitemanddisplay(selecteditem)
                                         })
 
                                        //  combinedpricingvaluearray = []
                                     }
                                 });
 
                             }
                         })
                     } else if($("#advancesearch").val()=="deptitemgroup"){
                         $("#deptitemgroup").show()
                         $("#add-allitem-button").show()
                         $("#form, #routinename, #itemgrouping,#group,#subclass,#prescriptionnumber,#class,#add-regiment-button,#recall-itemorder-button").hide()
                     }
                 })
 
                 $("#selectform").on("change", function(evt){
                     let searchItem = $("#searchitems").val()
                     let selectsubclass = $("#selectform").val()
                     let GetGenericNameByFormDeptItemGrpPricing = "GetGenericNameByFormDeptItemGrpPricing"
                     $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectsubclass,GetGenericNameByFormDeptItemGrpPricing:GetGenericNameByFormDeptItemGrpPricing},function(formdata){
                         //console.log(formdata)
                         if(formdata!="No Record Found"){
                             let data = JSON.parse(formdata)
                             let count = 0
                                                            
                                let genericnameoptions = ``
                                $.each(data.records, function(key, val) {
                                    count++
                                    genericnameoptions += `
                                    <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                `
                                })
                             //console.log(deptitemgrpitems)
                             genericnamelist = genericnameoptions
                             itemlist = data
                             $("#combineditems").html(genericnameoptions)
                             // let selectclass = $("#selectgenericnameitemgroupclass").val()
                             let searchItem = $("#combineditems").val()
                            let splitsearchItem = searchItem.split(",")
                            searchItem = splitsearchItem[2]
                            getCombinedItemsDetails(searchItem)
                         } else {
                            $("#combineditems").html("<option value='None'>No Items</option>")
                         }
                     
                     })
                 })
 
                 $("#selectregiment").on("change", function(evt){
                     evt.preventDefault()
                     let regimentname = $("#selectregiment").val()
                     let splitregimentname = regimentname.split(",")
                     regimentname = splitregimentname[1]
                     itemregimentarray.forEach(val => {
                         if(regimentname == val.regimentname){
                             //console.log(val.regiment)
                             let regimentlist = JSON.parse(val.regiment)
                            //  combinedpricingvaluearray = regimentlist
 
                             let genericnameoptions = ``
                             deptitemgrpitems = `<select id="selectdptitemgrpitem" name="selectdptitemgrpitem" class="form-control">`
 
                             let regimentlistitems = ``
                             let count = 0
                             regimentlist.forEach(value => {
                                // combinedpricingvaluearray.push(value)
                                 regimentlistitems += `<option value="` + count + `,` + value.itemid + `">` + value.itemname + `</option>`
 
                                 genericnameoptions += `
                                 <option value="` + value.itemid + `,` + value.itemname + `">` + value.itemname + `</option>
                                 `
                                 deptitemgrpitems += `
                                 <option value="` + value.itemid + `,` + value.itemname+ `">` + value.itemname + `</option>
                                 `
                                     count++
                             });
                             // $("#itemregimentslist").html(regimentlistitems)
                             deptitemgrpitems += `</select>`
 
                             genericnamelist = genericnameoptions
                             itemlist = data
                             $("#combineditems").html(genericnameoptions)
 
                             let pricinglist = displayselectedlistitems + `<tr>
                                         <td></td>
                                         <td></td>
                                         <td></td>
                                         <td>
                                                 </td>
                                         <td></td>
                                         <td></td>
                                         <td></td>
                                         <td></td>
                                     </tr>`
                             $("#view-revenue-order-list").html(pricinglist)
                             $("#view-revenue-order-list-item").html(pricinglist)
                             $("#view-revenue-order-list-lab").html(pricinglist)
                             $("#selectdptitemgrpitem").on("change", function(evt){
                                 evt.preventDefault()
                                 let selecteditem = $("#selectdptitemgrpitem").val()
                                 selectitemanddisplay(selecteditem)
                             })
                             $(".additemtolist").on("click", function(evt){
 
                                 evt.preventDefault()
                                 let selecteditem = $("#selectdptitemgrpitem").val()
                                 selectitemanddisplay(selecteditem)
                             })
 
                            //  combinedpricingvaluearray = []
                         }
                     });
                 })
 
                 $("#searchregiment").on('change keyup paste', function () {
                     let getItemRegimentBySearch = "getItemRegimentBySearch"
                     let searchregiment = $("#searchregiment").val()
                     $.post("controllers/combo-setup.php",{searchregiment:searchregiment,getItemRegimentBySearch:getItemRegimentBySearch},function(data){
                         if(data!="No Record Found"){
                             // //console.log(data)
                             let formdata = JSON.parse(data)
                             itemregimentarray = formdata.records
                             let itemregimentlist = ``
                             formdata.records.forEach(val => {
                                 itemregimentlist += `<option value="` + val.id + `,` + val.regimentname + `">` + val.regimentname + `</option>`
                             });
                             $("#selectregiment").html(itemregimentlist)
 
                             let regimentname = $("#selectregiment").val()
                             let splitregimentname = regimentname.split(",")
                             regimentname = splitregimentname[1]
                             itemregimentarray.forEach(val => {
                                 if(regimentname == val.regimentname){
                                     //console.log(val.regiment)
                                     let regimentlist = JSON.parse(val.regiment)
                                    //  combinedpricingvaluearray = regimentlist
 
                                     let genericnameoptions = ``
                                     deptitemgrpitems = `<select id="selectdptitemgrpitem" name="selectdptitemgrpitem" class="form-control">`
 
                                     let regimentlistitems = ``
                                     let count = 0
                                     regimentlist.forEach(value => {
                                        // combinedpricingvaluearray.push(value)
                                         regimentlistitems += `<option value="` + count + `,` + value.itemid + `">` + value.itemname + `</option>`
 
                                         genericnameoptions += `
                                         <option value="` + value.itemid + `,` + value.itemname + `">` + value.itemname + `</option>
                                         `
                                         deptitemgrpitems += `
                                         <option value="` + value.itemid + `,` + value.itemname+ `">` + value.itemname + `</option>
                                         `
                                             count++
                                     });
                                     // $("#itemregimentslist").html(regimentlistitems)
                                     deptitemgrpitems += `</select>`
 
                                     genericnamelist = genericnameoptions
                                     itemlist = data
                                     $("#combineditems").html(genericnameoptions)
 
                                     let pricinglist = displayselectedlistitems + `<tr>
                                                 <td></td>
                                                 <td></td>
                                                 <td></td>
                                                 <td>
                                                         </td>
                                                 <td></td>
                                                 <td></td>
                                                 <td></td>
                                                 <td></td>
                                             </tr>`
                                     $("#view-revenue-order-list").html(pricinglist)
                                     $("#view-revenue-order-list-item").html(pricinglist)
                                     $("#view-revenue-order-list-lab").html(pricinglist)
                                     $("#selectdptitemgrpitem").on("change", function(evt){
                                         evt.preventDefault()
                                         let selecteditem = $("#selectdptitemgrpitem").val()
                                         selectitemanddisplay(selecteditem)
                                     })
                                     $(".additemtolist").on("click", function(evt){
 
                                         evt.preventDefault()
                                         let selecteditem = $("#selectdptitemgrpitem").val()
                                         selectitemanddisplay(selecteditem)
                                     })
 
                                    //  combinedpricingvaluearray = []
                                 }
                             });
 
                         }
                     })
                     
                 });

                 $("#searchitems").on('change keyup paste', function () {
                     ApplyFilterGenericName();
                 });
 
                 function ApplyFilterGenericName() {
                     var searchString = $("#searchitems").val();
                     //console.log("GetSubDepartmentsFunction")
                     GetGenericNameFunction()
                 }
 
                
                 let searchAllItem = ""
                 function GetGenericNameFunction(){
                     let searchItem = $("#searchitems").val()
                     let selectsubclass = $("#selectusagesubclass").val()
                     let GetGenericNameByUsageDeptItemGrpSearchPricing = "GetGenericNameByUsageDeptItemGrpSearchPricing"
                     $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectsubclass,GetGenericNameByUsageDeptItemGrpSearchPricing:GetGenericNameByUsageDeptItemGrpSearchPricing},function(formdata){
                         //console.log(formdata)
                         if(formdata!="No Record Found"){
                             let data = JSON.parse(formdata)
                             let count = 0
                                                            
                            let genericnameoptions = ``
                            $.each(data.records, function(key, val) {
                                count++
                                genericnameoptions += `
                                <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                            `
                            })
                             genericnamelist = genericnameoptions
                             itemlist = data
                             $("#combineditems").html(genericnameoptions)
                             // let selectclass = $("#selectgenericnameitemgroupclass").val()
                             let searchItem = $("#combineditems").val()
                            let splitsearchItem = searchItem.split(",")
                            searchItem = splitsearchItem[2]
                            getCombinedItemsDetails(searchItem)
                         } else {
                            $("#combineditems").html("<option value='None'>No Items</option>")
                         }
                         
                     })
                 }
                 $("#selectusagesubclass").on("change", function(evt){
                     evt.preventDefault()
                     let searchItem = $("#searchitems").val()
                     let selectsubclass = $("#selectusagesubclass").val()
                     let GetGenericNameByUsageDeptItemGrpSubClassPricing = "GetGenericNameByUsageDeptItemGrpSubClassPricing"
                     $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectsubclass,GetGenericNameByUsageDeptItemGrpSubClassPricing:GetGenericNameByUsageDeptItemGrpSubClassPricing},function(formdata){
                         //console.log(formdata)
                         if(formdata!="No Record Found"){
                             let data = JSON.parse(formdata)
                             let count = 0
                                                            
                            let genericnameoptions = ``
                            $.each(data.records, function(key, val) {
                                count++
                                genericnameoptions += `
                                <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                            `
                            })
                             genericnamelist = genericnameoptions
                             itemlist = data
                             $("#combineditems").html(genericnameoptions)
                             // let selectclass = $("#selectgenericnameitemgroupclass").val()
                             let searchItem = $("#combineditems").val()
                            let splitsearchItem = searchItem.split(",")
                            searchItem = splitsearchItem[2]
                            getCombinedItemsDetails(searchItem)
                         } else {
                            $("#combineditems").html("<option value='None'>No Items</option>")
                         }
                         
                     })
                 })
 
                 $("#selectusagesubclassgroup").on("change", function(evt){
                     evt.preventDefault()
                     let searchItem = $("#searchitems").val()
                     let selectsubclass = $("#selectusagesubclassgroup").val()
                     let GetGenericNameByUsageDeptItemGrpSubClassPricing = "GetGenericNameByUsageDeptItemGrpSubClassPricing"
                     $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectsubclass,GetGenericNameByUsageDeptItemGrpSubClassPricing:GetGenericNameByUsageDeptItemGrpSubClassPricing},function(formdata){
                         //console.log(formdata)
                         if(formdata!="No Record Found"){
                             let data = JSON.parse(formdata)
                             let count = 0
                                                            
                            let genericnameoptions = ``
                            $.each(data.records, function(key, val) {
                                count++
                                genericnameoptions += `
                                <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                            `
                            })
                             genericnamelist = genericnameoptions
                             itemlist = data
                             $("#combineditems").html(genericnameoptions)
                             // let selectclass = $("#selectgenericnameitemgroupclass").val()
                             let searchItem = $("#combineditems").val()
                            let splitsearchItem = searchItem.split(",")
                            searchItem = splitsearchItem[2]
                            getCombinedItemsDetails(searchItem)
                         } else {
                            $("#combineditems").html("<option value='None'>No Items</option>")
                         }
                         
                     })
                 })
 
                 $("#selectusagesubclassclass").on("change", function(evt){
                     evt.preventDefault()
                     let searchItem = $("#searchitems").val()
                     let selectsubclass = $("#selectusagesubclassclass").val()
                     let GetGenericNameByUsageDeptItemGrpSubClassPricing = "GetGenericNameByUsageDeptItemGrpSubClassPricing"
                     $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectsubclass,GetGenericNameByUsageDeptItemGrpSubClassPricing:GetGenericNameByUsageDeptItemGrpSubClassPricing},function(formdata){
                         //console.log(formdata)
                         if(formdata!="No Record Found"){
                             let data = JSON.parse(formdata)
                             let count = 0
                                
                            let genericnameoptions = ``
                            $.each(data.records, function(key, val) {
                                count++
                                genericnameoptions += `
                                <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                            `
                            })
                             genericnamelist = genericnameoptions
                             itemlist = data
                             $("#combineditems").html(genericnameoptions)
                             // let selectclass = $("#selectgenericnameitemgroupclass").val()
                             let searchItem = $("#combineditems").val()
                            let splitsearchItem = searchItem.split(",")
                            searchItem = splitsearchItem[2]
                            getCombinedItemsDetails(searchItem)
                         } else {
                            $("#combineditems").html("<option value='None'>No Items</option>")
                         }
                         
                     })
                 })
 
 
                 $("#selectusagesubclasssubclass").on("change", function(evt){
                     evt.preventDefault()
                     let searchItem = ""
                     let selectsubclass = $("#selectusagesubclasssubclass").val()
                     let GetGenericNameByUsageDeptItemGrpSubClassPricing = "GetGenericNameByUsageDeptItemGrpSubClassPricing"
                     $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectsubclass,GetGenericNameByUsageDeptItemGrpSubClassPricing:GetGenericNameByUsageDeptItemGrpSubClassPricing},function(formdata){
                         //console.log(formdata)
                         if(formdata!="No Record Found"){
                             let data = JSON.parse(formdata)
                             let count = 0
                                                            
                                                        let genericnameoptions = ``
                                                        $.each(data.records, function(key, val) {
                                                            count++
                                                            genericnameoptions += `
                                                            <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                                        `
                                                        })
                             genericnamelist = genericnameoptions
                             itemlist = data
                             $("#combineditems").html(genericnameoptions)
                             // let selectclass = $("#selectgenericnameitemgroupclass").val()
                             let searchItem = $("#combineditems").val()
                                                        let splitsearchItem = searchItem.split(",")
                                                        searchItem = splitsearchItem[2]
                                                        getCombinedItemsDetails(searchItem)
                         } else {
                            $("#combineditems").html("<option value='None'>No Items</option>")
                         }
                         
                     })
                 })
 
 
                 $("#selectusagegroup").on("change", function(evt){
                     evt.preventDefault()
                     //$("#selectformdepartmentitemgroup").html(departmentitemgroupoptions)
                     let selectgroup = $("#selectusagegroup").val()
                     let getItemClassByItemGroup = "getItemClassByItemGroup"
                     //console.log(selectgroup)
                     $.post("controllers/combo-setup.php",{searchItem:selectgroup,getItemClassByItemGroup:getItemClassByItemGroup},function(formdata){
                         //console.log(formdata)
                         let data = JSON.parse(formdata)
                         let genericnameclassoptions = ``
                         $.each(data.records, function(key, val) {
                         
                             genericnameclassoptions += `
                             <option value="` + val.itemclass + `">` + val.itemclass + `</option>
                             `
                         })
                         genericnameusageclasslist = genericnameclassoptions
                         $("#selectusageclass").html(genericnameclassoptions)
                         let selectsubclassclass = $("#selectusageclass").val()
                         let getItemSubClassByClass = "getItemSubClassByClass"
                         $.post("controllers/combo-setup.php",{selectsubclassclass:selectsubclassclass,getItemSubClassByClass:getItemSubClassByClass},function(formdata){
                             //console.log(formdata)
                             let data = JSON.parse(formdata)
                             let genericnamesubclassoptions = `<option value="">Select Sub Class</option>`
                             $.each(data.records, function(key, val) {
                             
                                 genericnamesubclassoptions += `
                                 <option value="` + val.itemsubclass + `">` + val.itemsubclass + `</option>
                                 `
                             })
                             genericnameusagesubclasslist = genericnamesubclassoptions
                             $("#selectusagesubclass").html(genericnamesubclassoptions)
                             let searchItem = $("#searchitems").val()
                             let selectsubclass = $("#selectusagesubclass").val()
                             let GetGenericNameByUsageDeptItemGrpGroupPricing = "GetGenericNameByUsageDeptItemGrpGroupPricing"
                             $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectgroup,GetGenericNameByUsageDeptItemGrpGroupPricing:GetGenericNameByUsageDeptItemGrpGroupPricing},function(formdata){
                                 //console.log(formdata)
                                 if(formdata!="No Record Found"){
                                     let data = JSON.parse(formdata)
                                     let count = 0
                                                            
                                                        let genericnameoptions = ``
                                                        $.each(data.records, function(key, val) {
                                                            count++
                                                            genericnameoptions += `
                                                            <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                                        `
                                                        })
                                     genericnamelist = genericnameoptions
                                     itemlist = data
                                     $("#combineditems").html(genericnameoptions)
                                     // let selectclass = $("#selectgenericnameitemgroupclass").val()
                                     let searchItem = $("#combineditems").val()
                                                        let splitsearchItem = searchItem.split(",")
                                                        searchItem = splitsearchItem[2]
                                                        getCombinedItemsDetails(searchItem)
                                 }
                                 
                             })
                         })
                     })
                 })
 
                 $("#selectusagegroupgroup").on("change", function(evt){
                     evt.preventDefault()
                     //$("#selectformdepartmentitemgroup").html(departmentitemgroupoptions)
                     let selectgroup = $("#selectusagegroupgroup").val()
                     let getItemClassByItemGroup = "getItemClassByItemGroup"
                     //console.log(selectgroup)
                     $.post("controllers/combo-setup.php",{searchItem:selectgroup,getItemClassByItemGroup:getItemClassByItemGroup},function(formdata){
                         //console.log(formdata)
                         let data = JSON.parse(formdata)
                         let genericnameclassoptions = ``
                         $.each(data.records, function(key, val) {
                         
                             genericnameclassoptions += `
                             <option value="` + val.itemclass + `">` + val.itemclass + `</option>
                             `
                         })
                         genericnameusageclasslist = genericnameclassoptions
                         $("#selectusageclassgroup").html(genericnameclassoptions)
                         let selectsubclassclass = $("#selectusageclassgroup").val()
                         let getItemSubClassByClass = "getItemSubClassByClass"
                         $.post("controllers/combo-setup.php",{selectsubclassclass:selectsubclassclass,getItemSubClassByClass:getItemSubClassByClass},function(formdata){
                             //console.log(formdata)
                             let data = JSON.parse(formdata)
                             let genericnamesubclassoptions = `<option value="">Select Sub Class</option>`
                             $.each(data.records, function(key, val) {
                             
                                 genericnamesubclassoptions += `
                                 <option value="` + val.itemsubclass + `">` + val.itemsubclass + `</option>
                                 `
                             })
                             genericnameusagesubclasslist = genericnamesubclassoptions
                             $("#selectusagesubclassgroup").html(genericnamesubclassoptions)
                             let searchItem = ""
                             let selectsubclass = $("#selectusagesubclassgroup").val()
                             let GetGenericNameByUsageDeptItemGrpGroupPricing = "GetGenericNameByUsageDeptItemGrpGroupPricing"
                             $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectgroup,GetGenericNameByUsageDeptItemGrpGroupPricing:GetGenericNameByUsageDeptItemGrpGroupPricing},function(formdata){
                                 console.log(formdata)
                                 if(formdata!="No Record Found"){
                                     let data = JSON.parse(formdata)
                                     let count = 0
                                                            
                                                        let genericnameoptions = ``
                                                        $.each(data.records, function(key, val) {
                                                            count++
                                                            genericnameoptions += `
                                                            <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                                        `
                                                        })
                                     deptitemgrpitems += `</select>`
                                     genericnamelist = genericnameoptions
                                     itemlist = data
                                     $("#combineditems").html(genericnameoptions)
                                     // let selectclass = $("#selectgenericnameitemgroupclass").val()
                                     let searchItem = $("#combineditems").val()
                                                        let splitsearchItem = searchItem.split(",")
                                                        searchItem = splitsearchItem[2]
                                                        getCombinedItemsDetails(searchItem)
                                 }
                                 
                             })
                         })
                     })
                 })
 
 
                 $("#selectusageclass").on("change", function(evt){
                     evt.preventDefault()
                     let selectsubclassclass = $("#selectusageclass").val()
                     let getItemSubClassByClass = "getItemSubClassByClass"
                     $.post("controllers/combo-setup.php",{selectsubclassclass:selectsubclassclass,getItemSubClassByClass:getItemSubClassByClass},function(formdata){
                         //console.log(formdata)
                         let data = JSON.parse(formdata)
                         let genericnamesubclassoptions = `<option value="">Select Sub Class</option>`
                         $.each(data.records, function(key, val) {
                         
                             genericnamesubclassoptions += `
                             <option value="` + val.itemsubclass + `">` + val.itemsubclass + `</option>
                             `
                         })
                         genericnameusagesubclasslist = genericnamesubclassoptions
                         $("#selectusagesubclass").html(genericnamesubclassoptions)
                         let searchItem = $("#searchitems").val()
                         let selectsubclass = $("#selectusagesubclass").val()
                         let GetGenericNameByUsageDeptItemGrpClassPricing = "GetGenericNameByUsageDeptItemGrpClassPricing"
                         $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectsubclassclass,GetGenericNameByUsageDeptItemGrpClassPricing:GetGenericNameByUsageDeptItemGrpClassPricing},function(formdata){
                             //console.log(formdata)
                             if(formdata!="No Record Found"){
                                 let data = JSON.parse(formdata)
                                 let count = 0
                                                            
                                                        let genericnameoptions = ``
                                                        $.each(data.records, function(key, val) {
                                                            count++
                                                            genericnameoptions += `
                                                            <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                                        `
                                                        })
                                 genericnamelist = genericnameoptions
                                 itemlist = data
                                 $("#combineditems").html(genericnameoptions)
                                 // let selectclass = $("#selectgenericnameitemgroupclass").val()
                                 let searchItem = $("#combineditems").val()
                                                        let splitsearchItem = searchItem.split(",")
                                                        searchItem = splitsearchItem[2]
                                                        getCombinedItemsDetails(searchItem)
                             }
                             
                         })
                     })
                 })
 
                 $("#selectusageclassgroup").on("change", function(evt){
                     evt.preventDefault()
                     let selectsubclassclass = $("#selectusageclassgroup").val()
                     let getItemSubClassByClass = "getItemSubClassByClass"
                     $.post("controllers/combo-setup.php",{selectsubclassclass:selectsubclassclass,getItemSubClassByClass:getItemSubClassByClass},function(formdata){
                         //console.log(formdata)
                         let data = JSON.parse(formdata)
                         let genericnamesubclassoptions = `<option value="">Select Sub Class</option>`
                         $.each(data.records, function(key, val) {
                         
                             genericnamesubclassoptions += `
                             <option value="` + val.itemsubclass + `">` + val.itemsubclass + `</option>
                             `
                         })
                         genericnameusagesubclasslist = genericnamesubclassoptions
                         $("#selectusagesubclassgroup").html(genericnamesubclassoptions)
                         let searchItem = $("#searchitems").val()
                         let selectsubclass = $("#selectusagesubclassgroup").val()
                         let GetGenericNameByUsageDeptItemGrpClassPricing = "GetGenericNameByUsageDeptItemGrpClassPricing"
                         $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectsubclassclass,GetGenericNameByUsageDeptItemGrpClassPricing:GetGenericNameByUsageDeptItemGrpClassPricing},function(formdata){
                             //console.log(formdata)
                             if(formdata!="No Record Found"){
                                 let data = JSON.parse(formdata)
                                 let count = 0
                                                            
                                                            let genericnameoptions = ``
                                                            $.each(data.records, function(key, val) {
                                                                count++
                                                                genericnameoptions += `
                                                                <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                                            `
                                                            })
                                 genericnamelist = genericnameoptions
                                 itemlist = data
                                 $("#combineditems").html(genericnameoptions)
                                 // let selectclass = $("#selectgenericnameitemgroupclass").val()
                                 let searchItem = $("#combineditems").val()
                                                        let splitsearchItem = searchItem.split(",")
                                                        searchItem = splitsearchItem[2]
                                                        getCombinedItemsDetails(searchItem)
                             }
                             
                         })
                     })
                 })
 
                 $("#selectusageclassclass").on("change", function(evt){
                     evt.preventDefault()
                     let selectsubclassclass = $("#selectusageclassclass").val()
                     let getItemSubClassByClass = "getItemSubClassByClass"
                     $.post("controllers/combo-setup.php",{selectsubclassclass:selectsubclassclass,getItemSubClassByClass:getItemSubClassByClass},function(formdata){
                         //console.log(formdata)
                         let data = JSON.parse(formdata)
                         let genericnamesubclassoptions = `<option value="">Select Sub Class</option>`
                         $.each(data.records, function(key, val) {
                         
                             genericnamesubclassoptions += `
                             <option value="` + val.itemsubclass + `">` + val.itemsubclass + `</option>
                             `
                         })
                         genericnameusagesubclasslist = genericnamesubclassoptions
                         $("#selectusagesubclassclass").html(genericnamesubclassoptions)
                         let searchItem = $("#searchitems").val()
                         let selectsubclass = $("#selectusagesubclassclass").val()
                         let GetGenericNameByUsageDeptItemGrpClassPricing = "GetGenericNameByUsageDeptItemGrpClassPricing"
                         $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectsubclassclass,GetGenericNameByUsageDeptItemGrpClassPricing:GetGenericNameByUsageDeptItemGrpClassPricing},function(formdata){
                             //console.log(formdata)
                             if(formdata!="No Record Found"){
                                 let data = JSON.parse(formdata)
                                 let count = 0
                                                            
                                                        let genericnameoptions = ``
                                                        $.each(data.records, function(key, val) {
                                                            count++
                                                            genericnameoptions += `
                                                            <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                                        `
                                                        })
                                 genericnamelist = genericnameoptions
                                 itemlist = data
                                 $("#combineditems").html(genericnameoptions)
                                 // let selectclass = $("#selectgenericnameitemgroupclass").val()
                                 let searchItem = $("#combineditems").val()
                                                        let splitsearchItem = searchItem.split(",")
                                                        searchItem = splitsearchItem[2]
                                                        getCombinedItemsDetails(searchItem)
                             }
                             
                         })
                     })
                 })


                 //get departmentitemgroups
                 let getDepartmentItemGroup = "getDepartmentItemGroup"
                 searchItem = ""
                 $.post("controllers/combo-setup.php",{searchItem:searchItem,getDepartmentItemGroup: getDepartmentItemGroup},function(formdata){
                      //console.log(formdata)
                     if(formdata!="No Record Found"){
                         
                         let data=JSON.parse(formdata)
                         let usagegroupoptions = `<option value="">Select Item Group</option>`
                         $.each(data.records, function(key, val) {
                         
                             usagegroupoptions += `
                             <option value="` + val.departmentitemgroup + `">` + val.departmentitemgroup + `</option>
                         `
                         })
                         genericnamedepartmentitemgrouplist = usagegroupoptions
                         $("#selectdepartmentitemgrouping").html(usagegroupoptions)
                         //$("#selectformdepartmentitemgroup").html(departmentitemgroupoptions)
                        
                     }
                 })
                 let displayselectedlistitems = ``
                 $("#selectdepartmentitemgrouping").on("change", function(evt){
                     let departmentitemgroup = $("#selectdepartmentitemgrouping").val()
                     let GetGenericNameByDepartmentItemGrouping = "GetGenericNameByDepartmentItemGrouping"
                     $.post("controllers/combo-setup.php",{searchItem:departmentitemgroup,GetGenericNameByDepartmentItemGrouping:GetGenericNameByDepartmentItemGrouping}, function(formdata){
                         if(formdata!="No Record Found"){
                             console.log(formdata)
                             let data = JSON.parse(formdata)
                             let itemoptions = ``
                             deptitemgrpitems = `<select id="selectdptitemgrpitem" name="selectdptitemgrpitem" class="form-control">`
                             $.each(data.records, function(key, val){
                                 itemoptions += `
                                 <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                 
                                 `
                                 deptitemgrpitems += `
                                 <option value="` + val.id + `,` + val.itemgenericname + `">` + val.itemgenericname + `</option>
                                 `
                             })
                             deptitemgrpitems += `</select>`
                             // departmentitemgrouplist = departmentitemgroupoptions
                             $("#combineditems").html(itemoptions)
 
                             let searchItem = $("#combineditems").val()
                            let splitsearchItem = searchItem.split(",")
                            searchItem = splitsearchItem[2]
                            getCombinedItemsDetails(searchItem)
                             
                         } else {
                            $("#combineditems").html("<option value='None'>No Items</option>")
                         }
 
 
 
                     })
 
                     // let deptItemgroup = $("#selectdepartmentitemgrouping").val()
                     let getDeptItemGrpUsageGroup = "getDeptItemGrpUsageGroup"
                     $.post("controllers/combo-setup.php",{searchItem:departmentitemgroup,getDeptItemGrpUsageGroup:getDeptItemGrpUsageGroup}, function(formdata){
                         if(formdata!="No Record Found"){
                             let data = JSON.parse(formdata)
                             let itemoptions = ``
                             $.each(data.records, function(key, val){
                                 itemoptions += `
                                 <option value="` + val.itemgroup + `">` + val.itemgroup + `</option>
                                 `
                             })
                             genericnameusagegrouplist = itemoptions
                             $("#selectusagegroup").html(itemoptions)
                             
                             //$("#selectformdepartmentitemgroup").html(departmentitemgroupoptions)
                             let selectgroup = $("#selectusagegroup").val()
                             let getItemClassByItemGroup = "getItemClassByItemGroup"
                             $.post("controllers/combo-setup.php",{searchItem:selectgroup,getItemClassByItemGroup:getItemClassByItemGroup},function(formdata){
                                 //console.log(formdata)
                                 let data = JSON.parse(formdata)
                                 let genericnameclassoptions = ``
                                 $.each(data.records, function(key, val) {
                                 
                                     genericnameclassoptions += `
                                     <option value="` + val.itemclass + `">` + val.itemclass + `</option>
                                     `
                                 })
                                 genericnameusageclasslist = genericnameclassoptions
                                 $("#selectusageclass").html(genericnameclassoptions)
                                 let selectsubclassclass = $("#selectusageclass").val()
                                 let getItemSubClassByClass = "getItemSubClassByClass"
                                 $.post("controllers/combo-setup.php",{selectsubclassclass:selectsubclassclass,getItemSubClassByClass:getItemSubClassByClass},function(formdata){
                                     //console.log(formdata)
                                     let data = JSON.parse(formdata)
                                     let genericnamesubclassoptions = `<option value="">Select Sub Class</option>`
                                     $.each(data.records, function(key, val) {
                                     
                                         genericnamesubclassoptions += `
                                         <option value="` + val.itemsubclass + `">` + val.itemsubclass + `</option>
                                         `
                                     })
                                     genericnameusagesubclasslist = genericnamesubclassoptions
                                     $("#selectusagesubclass").html(genericnamesubclassoptions)
                                     let searchItem = $("#searchitems").val()
                                     let selectsubclass = $("#selectusagesubclass").val()
                                     let GetGenericNameByUsageDRUGSSubClass = "GetGenericNameByUsageDRUGSSubClass"
                                     $.post("controllers/combo-setup.php",{searchItem:searchItem,itemsubclass:selectsubclass,GetGenericNameByUsageDRUGSSubClass:GetGenericNameByUsageDRUGSSubClass},function(formdata){
                                         //console.log(formdata)
                                         if(formdata!="No Record Found"){
                                             let data = JSON.parse(formdata)
                                             let genericnameoptions = ``
                                             deptitemgrpitems = `<select id="selectdptitemgrpitem" name="selectdptitemgrpitem" class="form-control">`
                                             $.each(data.records, function(key, val) {
                                             
                                                 genericnameoptions += `
                                                 <option value="` + val.id + `,` + val.itemgenericname + `">` + val.itemgenericname + `(` + val.tradename + `)</option>
                                                 `
                                                 deptitemgrpitems += `
                                                 <option value="` + val.id + `,` + val.itemgenericname + `">` + val.itemgenericname + `</option>
                                                 `
                                             })
                                             deptitemgrpitems += `</select>`
                                             genericnamelist = genericnameoptions
                                             itemlist = data.records
                                            //  $("#combineditems").html(genericnameoptions)
                                             // let selectclass = $("#selectgenericnameitemgroupclass").val()
                                             let pricinglist = displayselectedlistitems + `<tr>
                                                     <td></td>
                                                     <td></td>
                                                     <td></td>
                                                     <td>
                                                             </td>
                                                     <td></td>
                                                     <td></td>
                                                     <td></td>
                                                     <td></td>
                                                 </tr>`
                                             $("#view-revenue-order-list").html(pricinglist)
                                             $("#view-revenue-order-list-item").html(pricinglist)
                                             $("#view-revenue-order-list-lab").html(pricinglist)
                                             $("#selectdptitemgrpitem").on("change", function(evt){
                                                 evt.preventDefault()
                                                 let selecteditem = $("#selectdptitemgrpitem").val()
                                                 selectitemanddisplay(selecteditem)
                                             })
                                             $(".additemtolist").on("click", function(evt){
 
                                                 evt.preventDefault()
                                                 let selecteditem = $("#selectdptitemgrpitem").val()
                                                 selectitemanddisplay(selecteditem)
                                             })
 
                                         }
                                     
                                     })
                                 })
                             })
                         }
 
                     })
                  })


                  $("#searchgroups").on("change keyup paste", function(){
                     getItemGroupByLikeDeptItemGroupSearchGroup = "getItemGroupByLikeDeptItemGroupSearchGroup"
                     
 
                     searchAllItem = ""
                     // splitsearch = searchItem.split(",")
                     searchItem = $("#searchgroups").val()
                     // //console.log(searchItem)
                     //get departmentitemgroups
                     // let getDepartmentItemGroup = "getDepartmentItemGroup"
                     // searchItem = "DRUGS"
                     
                     $.post("controllers/combo-setup.php",{searchItem:searchItem,departmentitemgroup:searchAllItem,getItemGroupByLikeDeptItemGroupSearchGroup: getItemGroupByLikeDeptItemGroupSearchGroup},function(formdata){
                         //console.log(formdata)
                         if(formdata!="No Record Found"){
                             
                             let data=JSON.parse(formdata)
                             let usagegroupoptions = ``
                             $.each(data.records, function(key, val) {
                             
                                 usagegroupoptions += `
                                 <option value="` + val.itemgroup + `">` + val.itemgroup + `</option>
                             `
                             })
                             genericnameusagegrouplist = usagegroupoptions
                             // $("#selectusagegroup").html(usagegroupoptions)
                             $("#selectusagegroupgroup").html(usagegroupoptions)
                             //$("#selectformdepartmentitemgroup").html(departmentitemgroupoptions)
                             let selectgroup = $("#selectusagegroupgroup").val()
                             let getItemClassByItemGroup = "getItemClassByItemGroup"
                             $.post("controllers/combo-setup.php",{searchItem:selectgroup,getItemClassByItemGroup:getItemClassByItemGroup},function(formdata){
                                 //console.log(formdata)
                                 let data = JSON.parse(formdata)
                                 let genericnameclassoptions = ``
                                 $.each(data.records, function(key, val) {
                                 
                                     genericnameclassoptions += `
                                     <option value="` + val.itemclass + `">` + val.itemclass + `</option>
                                     `
                                 })
                                 genericnameusageclasslist = genericnameclassoptions
                                 $("#selectusageclassgroup").html(genericnameclassoptions)
                                 let selectsubclassclass = $("#selectusageclassgroup").val()
                                 let getItemSubClassByClass = "getItemSubClassByClass"
                                 $.post("controllers/combo-setup.php",{selectsubclassclass:selectsubclassclass,getItemSubClassByClass:getItemSubClassByClass},function(formdata){
                                     //console.log(formdata)
                                     let data = JSON.parse(formdata)
                                     let genericnamesubclassoptions = `<option value="">Select Sub Class</option>`
                                     $.each(data.records, function(key, val) {
                                     
                                         genericnamesubclassoptions += `
                                         <option value="` + val.itemsubclass + `">` + val.itemsubclass + `</option>
                                         `
                                     })
                                     genericnameusagesubclasslist = genericnamesubclassoptions
                                     $("#selectusagesubclassgroup").html(genericnamesubclassoptions)
                                     let searchItem = $("#searchitems").val()
                                     let selectsubclass = $("#selectusagesubclassgroup").val()
                                     let GetGenericNameByUsageDeptItemGrpGroupPricing = "GetGenericNameByUsageDeptItemGrpGroupPricing"
                                     $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectgroup,GetGenericNameByUsageDeptItemGrpGroupPricing:GetGenericNameByUsageDeptItemGrpGroupPricing},function(formdata){
                                         //console.log(formdata)
                                         if(formdata!="No Record Found"){
                                             let data = JSON.parse(formdata)
                                             let count = 0
                                                            
                                                        let genericnameoptions = ``
                                                        $.each(data.records, function(key, val) {
                                                            count++
                                                            genericnameoptions += `
                                                            <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                                        `
                                                        })
                                             //console.log(deptitemgrpitems)
                                             genericnamelist = genericnameoptions
                                             itemlist = data
                                             $("#combineditems").html(genericnameoptions)
                                             // let selectclass = $("#selectgenericnameitemgroupclass").val()
                                             let searchItem = $("#combineditems").val()
                                                        let splitsearchItem = searchItem.split(",")
                                                        searchItem = splitsearchItem[2]
                                                        getCombinedItemsDetails(searchItem)
                                         }
                                     
                                     })
                                 })
                             })
                         }
                     })
 
                 })
 
 
                 $("#searchclass").on('change keyup paste', function () {
                     let searchclass = $("#searchclass").val()
                     let selectgroup = ""
                     let getItemClassByDeptItemGroupSearchClass = "getItemClassByDeptItemGroupSearchClass"
                     $.post("controllers/combo-setup.php",{searchclass:searchclass,searchItem:selectgroup,getItemClassByDeptItemGroupSearchClass:getItemClassByDeptItemGroupSearchClass},function(formdata){
                         //console.log(formdata)
                         let data = JSON.parse(formdata)
                         let genericnameclassoptions = ``
                         $.each(data.records, function(key, val) {
                         
                             genericnameclassoptions += `
                             <option value="` + val.itemclass + `">` + val.itemclass + `</option>
                             `
                         })
                         genericnameusageclasslist = genericnameclassoptions
                         $("#selectusageclassclass").html(genericnameclassoptions)
                         let selectsubclassclass = $("#selectusageclassclass").val()
                         let getItemSubClassByClass = "getItemSubClassByClass"
                         $.post("controllers/combo-setup.php",{selectsubclassclass:selectsubclassclass,getItemSubClassByClass:getItemSubClassByClass},function(formdata){
                             //console.log(formdata)
                             let data = JSON.parse(formdata)
                             let genericnamesubclassoptions = `<option value="">Select Sub Class</option>`
                             $.each(data.records, function(key, val) {
                             
                                 genericnamesubclassoptions += `
                                 <option value="` + val.itemsubclass + `">` + val.itemsubclass + `</option>
                                 `
                             })
                             genericnameusagesubclasslist = genericnamesubclassoptions
                             $("#selectusagesubclassclass").html(genericnamesubclassoptions)
                             let searchItem = $("#searchitems").val()
                             let selectsubclass = $("#selectusagesubclassclass").val()
                             let GetGenericNameByUsageDeptItemGrpClassPricing = "GetGenericNameByUsageDeptItemGrpClassPricing"
                             $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectsubclassclass,GetGenericNameByUsageDeptItemGrpClassPricing:GetGenericNameByUsageDeptItemGrpClassPricing},function(formdata){
                                 console.log(formdata)
                                 if(formdata!="No Record Found"){
                                     let data = JSON.parse(formdata)
                                     let count = 0
                                                            
                                                            let genericnameoptions = ``
                                                            $.each(data.records, function(key, val) {
                                                                count++
                                                                genericnameoptions += `
                                                                <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                                            `
                                                            })
                                     //console.log(deptitemgrpitems)
                                     genericnamelist = genericnameoptions
                                     itemlist = data
                                     $("#combineditems").html(genericnameoptions)
                                     // let selectclass = $("#selectgenericnameitemgroupclass").val()
                                     let searchItem = $("#combineditems").val()
                                                        let splitsearchItem = searchItem.split(",")
                                                        searchItem = splitsearchItem[2]
                                                        getCombinedItemsDetails(searchItem)
                                 }
                             
                             })
                         })
                     })
                 });

                 $("#searchsubclass").on('change keyup paste', function () {
                     let searchclass = $("#searchsubclass").val()
                     let selectgroup = ""
                     
                         let getItemSubClassByDeptItemGroupSearchClass = "getItemSubClassByDeptItemGroupSearchClass"
                         $.post("controllers/combo-setup.php",{searchclass:searchclass,searchItem:selectgroup,getItemSubClassByDeptItemGroupSearchClass:getItemSubClassgetItemSubClassByDeptItemGroupSearchClassByClass},function(formdata){
                             //console.log(formdata)
                             let data = JSON.parse(formdata)
                             let genericnamesubclassoptions = `<option value="">Select Sub Class</option>`
                             $.each(data.records, function(key, val) {
                             
                                 genericnamesubclassoptions += `
                                 <option value="` + val.itemsubclass + `">` + val.itemsubclass + `</option>
                                 `
                             })
                             genericnameusagesubclasslist = genericnamesubclassoptions
                             $("#selectusagesubclassclass").html(genericnamesubclassoptions)
                             let searchItem = ""
                             let selectsubclass = $("#selectusagesubclassclass").val()
                             let GetGenericNameByUsageDeptItemGrpSubClassPricing = "GetGenericNameByUsageDeptItemGrpSubClassPricing"
                             $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,searchItem:searchItem,itemsubclass:selectsubclass,GetGenericNameByUsageDeptItemGrpSubClassPricing:GetGenericNameByUsageDeptItemGrpSubClassPricing},function(formdata){
                                 console.log(formdata)
                                 if(formdata!="No Record Found"){
                                     let data = JSON.parse(formdata)
                                     let count = 0
                                                            
                                                            let genericnameoptions = ``
                                                            $.each(data.records, function(key, val) {
                                                                count++
                                                                genericnameoptions += `
                                                                <option value="` + val.stockitemid + `,` + val.itemid + `,` + val.id + `">` + val.itemgenericname + ` (` + val.tradename + `)</option>
                                                            `
                                                            })
                                     //console.log(deptitemgrpitems)
                                     genericnamelist = genericnameoptions
                                     itemlist = data
                                     $("#combineditems").html(genericnameoptions)
                                     // let selectclass = $("#selectgenericnameitemgroupclass").val()
                                     let searchItem = $("#combineditems").val()
                                                        let splitsearchItem = searchItem.split(",")
                                                        searchItem = splitsearchItem[2]
                                                        getCombinedItemsDetails(searchItem)
                                 }
                             
                             })
                         })
                     
                 });

                 // splitsearch = searchItem.split(",")
                 // searchItem = splitsearch[0]
                 // //console.log(searchItem)
                 let getItemGroupByLikeDeptItemGroup  = "getItemGroupByLikeDeptItemGroup "
                 $.post("controllers/combo-setup.php",{departmentitemgroup:searchAllItem,getItemGroupByLikeDeptItemGroup: getItemGroupByLikeDeptItemGroup},function(formdata){
                      //console.log(formdata)
                     if(formdata!="No Record Found"){
                         
                         let data=JSON.parse(formdata)
                         let usagegroupoptions = ``
                         $.each(data.records, function(key, val) {
                         
                             usagegroupoptions += `
                             <option value="` + val.itemgroup + `">` + val.itemgroup + `</option>
                         `
                         })
                         genericnameusagegrouplist = usagegroupoptions
                         $("#selectusagegroup").html(usagegroupoptions)
                         $("#selectusagegroupgroup").html(usagegroupoptions)
                         //$("#selectformdepartmentitemgroup").html(departmentitemgroupoptions)
                         let selectgroup = $("#selectusagegroup").val()
                         let getItemClassByItemGroup = "getItemClassByItemGroup"
                         $.post("controllers/combo-setup.php",{searchItem:selectgroup,getItemClassByItemGroup:getItemClassByItemGroup},function(formdata){
                             //console.log(formdata)
                             let data = JSON.parse(formdata)
                             let genericnameclassoptions = ``
                             $.each(data.records, function(key, val) {
                             
                                 genericnameclassoptions += `
                                 <option value="` + val.itemclass + `">` + val.itemclass + `</option>
                                 `
                             })
                             genericnameusageclasslist = genericnameclassoptions
                             $("#selectusageclass").html(genericnameclassoptions)
                             $("#selectusageclassgroup").html(genericnameclassoptions)
                             let selectsubclassclass = $("#selectusageclass").val()
                             let getItemSubClassByClass = "getItemSubClassByClass"
                             $.post("controllers/combo-setup.php",{selectsubclassclass:selectsubclassclass,getItemSubClassByClass:getItemSubClassByClass},function(formdata){
                                 //console.log(formdata)
                                 let data = JSON.parse(formdata)
                                 let genericnamesubclassoptions = `<option value="">Select Sub Class</option>`
                                 $.each(data.records, function(key, val) {
                                 
                                     genericnamesubclassoptions += `
                                     <option value="` + val.itemsubclass + `">` + val.itemsubclass + `</option>
                                     `
                                 })
                                 genericnameusagesubclasslist = genericnamesubclassoptions
                                 $("#selectusagesubclass").html(genericnamesubclassoptions)
                                 $("#selectusagesubclassgroup").html(genericnamesubclassoptions)
                                 let searchItem = $("#searchitems").val()
                                 let selectsubclass = $("#selectusagesubclass").val()
                                 let GetGenericNameByUsageDRUGSSubClass = "GetGenericNameByUsageDRUGSSubClass"
                                 $.post("controllers/combo-setup.php",{searchItem:searchItem,itemsubclass:selectsubclass,GetGenericNameByUsageDRUGSSubClass:GetGenericNameByUsageDRUGSSubClass},function(formdata){
                                     //console.log(formdata)
                                     if(formdata!="No Record Found"){
                                          let data = JSON.parse(formdata)
                                         let genericnameoptions = ``
                                         deptitemgrpitems = `<select id="selectdptitemgrpitem" name="selectdptitemgrpitem" class="form-control">`
                                         $.each(data.records, function(key, val) {
                                         
                                             genericnameoptions += `
                                             <option value="` + val.id + `,` + val.itemgenericname + `">` + val.itemgenericname + `(` + val.tradename + `)</option>
                                             `
                                             deptitemgrpitems += `
                                             <option value="` + val.id + `,` + val.itemgenericname + `">` + val.itemgenericname + `</option>
                                             `
                                         })
                                         deptitemgrpitems += `</select>`
                                         //console.log(deptitemgrpitems)
                                         genericnamelist = genericnameoptions
                                         itemlist = data
                                         $("#combineditems").html(genericnameoptions)
                                         // let selectclass = $("#selectgenericnameitemgroupclass").val()
                                         let pricinglist = displayselectedlistitems + `<tr>
                                                     <td></td>
                                                     <td></td>
                                                     <td></td>
                                                     <td>
                                                             </td>
                                                     <td></td>
                                                     <td></td>
                                                     <td></td>
                                                     <td></td>
                                                 </tr>`
                                         $("#view-revenue-order-list").html(pricinglist)
                                         $("#view-revenue-order-list-item").html(pricinglist)
                                         $("#view-revenue-order-list-lab").html(pricinglist)
                                         $("#selectdptitemgrpitem").on("change", function(evt){
                                             evt.preventDefault()
                                             let selecteditem = $("#selectdptitemgrpitem").val()
                                             selectitemanddisplay(selecteditem)
                                         })
                                         $(".additemtolist").on("click", function(evt){
 
                                             evt.preventDefault()
                                             let selecteditem = $("#selectdptitemgrpitem").val()
                                             selectitemanddisplay(selecteditem)
                                         })
                                     }
                                    
                                 })
                             })
                         })
                     }
                 })

                })


                

        
    </script>
</body>

</html>